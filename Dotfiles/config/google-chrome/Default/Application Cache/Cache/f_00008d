Jh.prototype.O7=PR(52,function(){return Me(this,3)});qC.prototype.O7=PR(51,function(){return Me(this,5)});Jh.prototype.r5=PR(50,function(){return M(this,3)});qC.prototype.r5=PR(49,function(){return M(this,5)});Jh.prototype.R7=PR(48,function(){return Me(this,2)});qC.prototype.R7=PR(47,function(){return Me(this,4)});Jh.prototype.K5=PR(46,function(){return M(this,2)});qC.prototype.K5=PR(45,function(){return M(this,4)});function GYc(a,b){var c=sm(a,b);return u(c)?String(sm(a,b)):null}
function HYc(a,b){Yc(a,11).push(b)}function IYc(a,b){return rb(eba(a.zk,a.Bm),function(a){return b(a)})}function JYc(a){return(new uI(a.J)).jc("title")}function KYc(a,b){a.D=b}function LYc(a){return null!=a?a:Number.MIN_VALUE}function MYc(a){return null!=a?a:Number.MAX_VALUE}function NYc(a,b){return Jrc(b)?Jrc(a)&&M(a,1)==M(b,1):Jrc(a)?LYc(M(a,1))>LYc(M(b,1))&&LYc(M(a,1))<MYc(uf(b)):LYc(M(a,1))>=LYc(M(b,1))&&MYc(uf(a))<=MYc(uf(b))}var OYc=/['()]/g;
function PYc(a){return"%"+a.charCodeAt(0).toString(16)}function QYc(a){a=Ua(String(a));OYc.lastIndex=0;return OYc.test(a)?a.replace(OYc,PYc):a}function RYc(a){return a.Ll()+fb(a.C)}function SYc(a){return U("<li class='nfd-format-pill'><div class='nfd-format-display'>"+T(a.Jdb)+"</div><div class='nfd-format-sample'>"+T(a.rQb)+"</div></li>")};function TYc(a,b,c){R.call(this);this.ud(a);this.D=b;this.C=c}y(TYc,R);p=TYc.prototype;p.Ha=function(){var a=this.hb(),b=this.C?Oaa(aS(a),30):aS(a);a=this.C?A7b(a,this.D):"";this.La=S(SYc,{Jdb:b,rQb:a})};p.Ra=function(){TYc.qa.Ra.call(this);Co(this.getElement(),!0);var a=new dt(this.getElement());this.Fa(a);this.getHandler().V(a,"key",this.n0b).V(this.getElement(),"mousedown",this.m0b).V(this.getElement(),"dblclick",this.Gob)};
p.n0b=function(a){function b(a,b){for(;b=a(b);)if(Lr(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(vo,this.getElement());break;case 38:b(gva,this.getElement())}};p.m0b=function(a){a.preventDefault();this.dispatchEvent("change")};p.Gob=function(){this.dispatchEvent("action")};function UYc(a,b,c){R.call(this);this.D=b;this.C=c;VYc(this,a)}y(UYc,R);UYc.prototype.Ha=function(){this.La=this.Aa().Ha("UL","nfd-pill-container")};function VYc(a,b){A(b,function(b){a.Qa(new TYc(b,a.D,a.C),!0)})}UYc.prototype.filter=function(a){a=a.toLowerCase();this.Ff(function(b){var c=Qa(fb(a)),d=aS(b.hb()).toLowerCase();c=c||$a(d,a);Q(b.getElement(),c)})};function m_(a){Ms.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.Afa();this.Qa(this.input,!0);this.J=new R;this.Qa(this.J,!0);a=this.R5();Mb(a,void 0,RYc);this.C=new UYc(a,this.FX(),this.GSa());this.J.Qa(this.C,!0);Ys(this,null);this.pj=!0}y(m_,Ms);p=m_.prototype;p.tVa=Rh;p.GSa=Qh;p.isEmpty=function(){return Qa(this.input.bb())};p.mf=function(){return this.input.hb().mf()};p.Ha=function(){m_.qa.Ha.call(this);var a=ao("DIV","dialog-separator");qo(a,Qs(this))};
p.Ra=function(){m_.qa.Ra.call(this);ss(this.J.getElement(),"nfd-dialog-content");this.getHandler().V(this.C,"change",this.Qqb).V(this.C,"action",this.Sra).V(this.input.O,"action",this.Sra).V(this.input,"afterhide",this.mjb);this.input.R&&this.getHandler().V(this.input.R,"input",this.f0b);var a=this.input.Ba;a&&this.getHandler().V(a,"key",this.g0b);a=this.R5()[0];this.input.iM(a)};p.mjb=function(a){a.stopPropagation()};p.Qqb=function(a){this.input.iM(a.target.hb());WYc(this.input,!1)};
p.f0b=function(){this.C.filter(this.input.bb());WYc(this.input,!this.input.hb().mf())};p.g0b=function(a){13==a.keyCode&&this.Sra()};p.Sra=function(){this.mf()&&!this.isEmpty()?(yNa.mc(new $R(this.i1(),void 0,this.tVa())),this.setVisible(!1)):(WYc(this.input,!0),this.input.dEa())};function n_(a,b,c,d,e){yt.call(this,b,c,d,e);this.C=a}y(n_,yt);n_.prototype.Kk=function(){var a=n_.qa.Kk.call(this),b=this.getParent();return b&&b instanceof nv&&!b.isVisible()?this.C(a,this.hb()):a};function o_(a){R.call(this);this.J=new R;this.Fa(this.J);this.D=new zS("");this.Fa(this.D);this.O=new gv("");this.Fa(this.O);this.$=a;this.Ba=null}y(o_,R);p=o_.prototype;
p.Ra=function(){o_.qa.Ra.call(this);var a=Wr(this,"nfd-icwr");this.J.kb(a);this.Qa(this.J);if(a=Wr(this,"nfd-i"))this.D.kb(a),this.D.Ad(this.J),us(this.D.getElement(),"jfk-textinput"),a=new Jt,a.kb(this.D.getElement()),this.Fa(a),this.R=a=new It(this.D.getElement()),this.Fa(a),this.Ba=a=new dt(this.D.getElement()),this.Fa(a),a=new zs(this.D.getElement()),this.getHandler().V(a,"focusout",Fa(this.rVa,!1)).V(a,"focusin",Fa(this.rVa,!0)).V(this.R,"input",this.e0b);a=Wr(this,"nfd-a");this.O.kb(a);this.Qa(this.O)};
p.bb=function(){return this.D.bb()};p.e0b=function(){var a=this.hb(),b=this.bb();N(a.$G,2,b);this.sVa()};p.sVa=Rh;p.rVa=function(a){ws(this.J.getElement(),"nfd-input-focus",a)};p.iM=function(a){this.ud(a.clone());this.D.fb(aS(a));try{this.D.getElement().focus()}catch(b){}};p.dEa=function(){this.D.getElement().focus()};function WYc(a,b){a=a.J.getElement();ws(a,"nfd-invalid",b)};function XYc(a){var b;a=a||{};return U('<input class="'+V("jfk-textinput")+(a.xd?" "+V(a.xd):"")+'"'+(a.id?' id="'+V(a.id)+'"':"")+(a.maxLength?' maxlength="'+V(a.maxLength)+'"':"")+(a.b$&&a.FVb?' label="'+V(a.b$)+'"':"")+(a.name?' name="'+V(a.name)+'"':"")+(a.b$?' placeholder="'+V(a.b$)+'"':"")+' type="'+V(null==(b=a.type)?"text":b)+'"'+(a.pattern?' pattern="'+V(a.pattern)+'"':"")+(a.value?' value="'+V(a.value)+'"':"")+(a.dir?' dir="'+V(a.dir)+'"':"")+(a.attributes?" "+du(a.attributes):"")+">")}
;function YYc(a){return U("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+V(a.qZ)+"'>"+ZYc(a)+"</div>"+$Yc(a)+"</div>")}function aZc(a){return U("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+V(a.qZ)+"'></div>"+$Yc(a)+"</div>")}
function bZc(a){return U("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+V(a.qZ)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+ZYc(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+V(a.lGb)+"'></div></div></div></div>"+$Yc(a)+"</div>")}
function cZc(){var a=""+("<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+dZc({label:""})+dZc({label:$t("Negative:")})+dZc({label:$t("Zero:")})+dZc({label:$t("Text:")})+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>");return U(a)}function dZc(a){return U("<tr><td class='nfd-sample-label'>"+T(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function $Yc(a){a=""+T(ev({id:a.vV,style:2,xd:"nfd-apply",content:Zt("Apply")}));return U(a)}function ZYc(a){return U(T(XYc({id:a.NLa,b$:a.OLa,FVb:!0})))};function eZc(a){o_.call(this,a);this.F=new R;this.C=new yM("")}y(eZc,o_);p=eZc.prototype;p.Ha=function(){this.La=S(bZc,{qZ:Ur(this,"nfd-icwr"),NLa:Ur(this,"nfd-i"),OLa:this.$,lGb:Ur(this,"nfd-ic"),vV:Ur(this,"nfd-a")})};p.Ra=function(){eZc.qa.Ra.call(this);var a=Wr(this,"nfd-ic");this.F.kb(a);this.F.Ad(this.J);this.F.Qa(this.C,!0);this.getHandler().V(this.C,"aftershow",this.h0b).V(this.C,"action",this.RIa).V(this.R,"input",Fa(this.vUa,null))};
p.iM=function(a){eZc.qa.iM.call(this,a);a.C&&this.D.fb(xp[a.C][1]);this.vUa(a)};
p.vUa=function(a){a=a?a.C:void 0;var b=this.C;b.Nf(null);if(a){var c=this.hb(),d=c.C;fZc(this,c);c=Ejc(d,xp[d][2]);c=new $R(gZc(c),Cjc[d],d);fZc(this,c);c=Ejc(d,d+" "+xp[d][1]);d=new $R(gZc(c),Cjc[d],d);fZc(this,d)}else this.hb().C=null;var e="[$"+this.bb()+"]";d=a?Cjc[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new $R(gZc(c[e]),d,a);fZc(this,f)}b.Bf(0);this.RIa();ss(b.wc().getElement(),"number-format-menu")};function fZc(a,b){var c=new n_(function(a){return Oaa(a,25)},A7b(b,1E3),b);a.Fa(c);a.Fa(b);c.Bp(!0);a=a.C;for(b=0;b<a.mj();b++)if(a.Te(b).Kk()==c.Kk())return;a.Fd(c)}p.RIa=function(){for(var a=this.C,b=0;b<a.mj();b++)a.Te(b).yc(!1);a.IH()};p.h0b=function(){this.C.hf().yc(!0)};function gZc(a){var b=new We;N(b,2,a);b.setType(4);return b};function hZc(a){m_.call(this,a);Ns(this,"Custom currencies")}y(hZc,m_);p=hZc.prototype;p.FX=n(1000.12);p.Afa=function(){return new eZc("Custom currency")};p.R5=function(){var a=this;N8b();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=Cjc[e]:KYc(d,Gjc(d.Ll()))}var f=[];Zb(xp,function(b,c){b=Fjc(c);a.Fa(b);f.push(b)});var h=Bzc();Pb(f,function(a,b){return h(aS(a),aS(b))});return b.concat(f)};
p.i1=function(){var a=new We;a.setType(4);N(a,3,1);var b=this.input.C.hf().bb().Ll();N(a,2,b);return a};p.tVa=function(){return this.input.hb().C};function iZc(a){R.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}y(iZc,R);iZc.prototype.Ha=function(){var a=S(cZc);this.F=Wn("nfd-sample-label",a);this.D=Xua("nfd-rendered-sample",a);this.La=a};function p_(a,b){o_.call(this,a);this.C=new iZc(b);this.ud(new $R(""))}y(p_,o_);p_.prototype.Ha=function(){this.La=S(YYc,{NLa:Ur(this,"nfd-i"),OLa:this.$,qZ:Ur(this,"nfd-icwr"),vV:Ur(this,"nfd-a")})};p_.prototype.Ra=function(){p_.qa.Ra.call(this);this.Qa(this.C,!0);jZc(this)};p_.prototype.sVa=function(){jZc(this)};p_.prototype.iM=function(a){p_.qa.iM.call(this,a);jZc(this)};
function jZc(a){var b=a.hb();if(b){var c=a.C;a=b.Ll().split(";").length-1;Ao(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=A7b(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.Ll()),k=d<=a;Q(xo(e),k);Ao(e,f);qr(e,"color",h||"")}d=b.mf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.Ll()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.Ll());c=c.D[3];Q(xo(c),3<=a);Ao(c,d);qr(c,"color",b||"")}};function kZc(a){m_.call(this,a);Ns(this,"Custom number formats")}y(kZc,m_);kZc.prototype.FX=n(1234.56);kZc.prototype.Afa=function(){return new p_("Custom number format",1234.56)};
kZc.prototype.R5=function(){var a=this.F;a.push(new $R("0"));a.push(new $R("0.00"));a.push(new $R("#,##0"));a.push(new $R("#,##0.00"));a.push(new $R("#,##0_);(#,##0)"));a.push(new $R("#,##0_);[Red](#,##0)"));a.push(new $R("#,##0.00_);(#,##0.00)"));a.push(new $R("#,##0.00_);[Red](#,##0.00)"));a.push(new $R("$#,##0_);($#,##0)"));a.push(new $R("$#,##0_);[Red]($#,##0)"));a.push(new $R("$#,##0.00_);($#,##0.00)"));a.push(new $R("$#,##0.00_);[Red]($#,##0.00)"));a.push(new $R("@"));a.push(new $R("0%"));a.push(new $R("0.00%"));
a.push(new $R("0.00E+00"));a.push(new $R("##0.0E+0"));a.push(new $R("# ?/?"));a.push(new $R("# ??/??"));a.push(new $R('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new $R('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new $R('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new $R('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};kZc.prototype.i1=function(){var a=new We;a.setType(2);N(a,3,1);var b=this.input.bb();N(a,2,b);return a};function q_(a,b){Bv.call(this,b,new lZc(a))}y(q_,Bv);p=q_.prototype;p.vh=function(a,b,c){q_.qa.vh.call(this,a,b,c);a.Wb()&&this.Wb()&&a.getParent()==this&&mZc(this)};p.Ra=function(){q_.qa.Ra.call(this);mZc(this)};p.hd=function(a){q_.qa.hd.call(this,a);mZc(this)};p.removeChild=function(a,b){a=q_.qa.removeChild.call(this,a,b);mZc(this);return a};p.Dn=function(a,b){a=q_.qa.Dn.call(this,a,b);mZc(this);return a};
p.Ij=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=tv(this);if(c){b=39==b;this.zf()&&(b=!b);c=c.getElement();c=ob(c.parentNode.childNodes,c);var d=(d=(d=tv(this))?vva(d.getElement(),nZc):null)?ob(d.parentNode.childNodes,d):-1;var e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=oZc(this,e);b?b=oZc(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.X$(this.Tj+b);b=!0}else b=!1}b=!b}return b?q_.qa.Ij.call(this,a):!0};
p.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function oZc(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function mZc(a){var b,c=a.Ed(),d=a.Wc(),e=Jb(Vn("div",nZc,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.Aa().Ha("DIV",nZc),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.Wc();k++)a.ad(k)instanceof Av?(d.push(new pZc(b,k,!0)),b=k+1):a.ad(k)instanceof wv&&(0==k?h=!0:(a.ad(k-1),d.push(new pZc(b,k-1,!1)),b=k));k=a.Wc();0<d.length&&nb(d).end!=k-1&&d.push(new pZc(b,k-1,!1));b=h;h=a.Wc();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.Wc()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else qZc(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.Wc();f++){for(;f>c[d];)++d;b=a.ad(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof Av?Q(h,!1):Q(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function qZc(a,b,c){function d(a){return a.end-a.start-(a.cFb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;Eb(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,Eb(a,l,1))}}function pZc(a,b,c){this.start=a;this.end=b;this.cFb=c}function lZc(a){zv.call(this);this.D=a}y(lZc,zv);var nZc="docs-multi-menu-col";function rZc(a){this.C=a}y(rZc,G);rZc.prototype.create=function(){return new q_(this.C)};function sZc(a,b){o_.call(this,a);this.va=new R;this.H=new tZc;this.F=new R;a=(new rZc(3)).create();a.Qa(new wv("Date"),!0);a.Qa(new yt("Day","DAY_TOKEN"),!0);a.Qa(new yt("Month","MONTH_TOKEN"),!0);a.Qa(new yt("Year","YEAR_TOKEN"),!0);a.Qa(new wv("Time"),!0);a.Qa(new yt("Hours","HOURS_TOKEN"),!0);a.Qa(new yt("Minutes","MINUTES_TOKEN"),!0);a.Qa(new yt("Seconds","SECONDS_TOKEN"),!0);a.Qa(new yt("Milliseconds","MILLIS_TOKEN"),!0);a.Qa(new yt("AM/PM","AM_PM_TOKEN"),!0);a.Qa(new wv("Duration"),!0);a.Qa(new yt("Elapsed hours",
"ELAPSED_HOURS_TOKEN"),!0);a.Qa(new yt("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Qa(new yt("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new fsb(a);this.C=b}y(sZc,o_);p=sZc.prototype;p.Ha=function(){this.La=S(aZc,{qZ:Ur(this,"nfd-icwr"),vV:Ur(this,"nfd-a")})};
p.Ra=function(){sZc.qa.Ra.call(this);ss(this.getElement(),"nfd-date-time-input");var a=Wr(this,"nfd-icwr"),b=this.va;b.kb(a);b.Ad(this);b.Qa(this.L,!0);ss(this.L.getElement(),"nfd-date-time-menu-button");ss(this.L.wc().getElement(),"nfd-date-time-menu");ps(this.L.La,"Add a date or time format");b.Qa(this.H,!0);Bc||ss(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Qa(a,!0);qr(a.getElement(),"display","inline");this.getHandler().V(this,"ee",Fa(this.uVa,"left")).V(this,"ie",Fa(this.OJa,"left")).V(this,
"je",Fa(this.OJa,"right")).V(this,"ke",Fa(this.wKa,"left")).V(this,"le",Fa(this.wKa,"right")).V(this,"he",Fa(this.uVa,"right")).V(this.L,"action",this.znb)};p.dEa=function(){this.va.getElement().focus()};
p.iM=function(a){this.ud(a.clone());var b=this.F;b.Cd(!0);Ao(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.Ll());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?Ao(this.H.getElement(),d[2]):(e=b.ad(b.Wc()-1),d=d[2],Ao(e.Xz.getElement(),Eo(e.Xz.getElement())+d)):uZc(this,e).fb(d[1])}0<b.Wc()&&b.ad(b.Wc()-1).by.getElement().focus()};
p.bb=function(){for(var a=this.H.toString(),b=0;b<this.F.Wc();b++)a+=this.F.ad(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=bb(e,"["),e=bb(e,"]")):c=!0}b+=e}return b};p.znb=function(a){a=a.target.bb();uZc(this,a).by.getElement().focus()};
function uZc(a,b){WYc(a,!1);switch(b){case "DAY_TOKEN":var c=vZc(a);break;case "MONTH_TOKEN":c=wZc(a);break;case "YEAR_TOKEN":c=xZc(a);break;case "HOURS_TOKEN":c=yZc();break;case "MINUTES_TOKEN":c=zZc();break;case "SECONDS_TOKEN":c=AZc();break;case "MILLIS_TOKEN":c=BZc();break;case "AM_PM_TOKEN":c=CZc(a);break;case "ELAPSED_HOURS_TOKEN":c=DZc();break;case "ELAPSED_MINUTES_TOKEN":c=EZc();break;case "ELAPSED_SECONDS_TOKEN":c=FZc()}b=c;b.Qa(new Av,!0);b.Qa(new yt("Delete"),!0);c=new GZc(c,"");a.F.Qa(c,
!0);return c}p.uVa=function(a,b){b=b.target;if(b instanceof tZc){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.ad(Xr(this.F,b)+1),!b))return}a=Eo(b.Xz.getElement());var c=b.getParent(),d=Xr(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=Eo(b),Ao(b,c+a),HZc(this.H,c.length)):(d--,b=c.ad(d),c=Eo(b.Xz.getElement()),Ao(b.Xz.getElement(),Eo(b.Xz.getElement())+a),HZc(b.Xz,c.length))};
p.wKa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.ad(Xr(this.F,b)+a))&&a.by.getElement().focus()};p.OJa=function(a,b){var c="left"==a?-1:0;(b=this.F.ad(Xr(this.F,b.target)+c))||"left"!=a?b&&(b=b.Xz):b=this.H;c=Eo(b.getElement()).length;HZc(b,"left"==a?c:0)};function GZc(a,b){R.call(this);this.by=new yM("",a);this.Qa(this.by,!0);this.Xz=new tZc(b);this.Qa(this.Xz,!0)}y(GZc,R);p=GZc.prototype;
p.Ra=function(){GZc.qa.Ra.call(this);qr(this.getElement(),"display","inline-block");this.by.Bf(0);this.C=new dt(this.by.getElement());this.Fa(this.C);this.getHandler().V(this.by,"action",this.i0b).V(this.C,"key",this.j0b)};p.i0b=function(){this.by.IH();this.by.hf().hb()||this.dispatchEvent("he")};p.j0b=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("he"));break;case 37:a.preventDefault();this.dispatchEvent("ie");break;case 39:a.preventDefault(),this.dispatchEvent("je")}};
p.toString=function(){return this.by.hf().hb()+this.Xz.toString()};p.fb=function(a){this.by.fb(a)};function tZc(a){R.call(this);this.C=a||""}y(tZc,R);p=tZc.prototype;p.Ha=function(){var a=ao("SPAN");Xn(a,{contentEditable:!0});Ao(a,this.C);var b=a.style;yc&&!Hc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Bc?"-moz-pre-wrap":"pre-wrap";this.La=a};
p.Ra=function(){tZc.qa.Ra.call(this);var a=new dt(this.getElement());this.Fa(a);this.getHandler().V(a,"key",this.k0b).V(this.getElement(),"paste",this.l0b)};function HZc(a,b){if(0==Eo(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=sO(c,b);a.getElement().focus();b.select()}}
p.k0b=function(a){var b=Do(this.getElement()),c=iO(),d=Eo(this.getElement()).length,e=c?0==c.Lh()&&0==c.Qn():Qa(fb(b));b=c?c.Lh()==d&&c.Qn()==d:Qa(fb(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("ee"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("he"));break;case 40:this.dispatchEvent("fe");break;case 38:this.dispatchEvent("ge");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("ke"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("le"));break;
case 13:a.preventDefault()}};p.toString=function(){var a=xaa(Eo(this.getElement())).replace(/"/g,'"\\""');return 0==fb(a).length?"":'"'+a+'"'};p.l0b=function(){var a=v(function(){Ao(this.getElement(),Eo(this.getElement()))},this);ii(a)};
function vZc(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new n_(Fa(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new n_(Fa(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new n_(Fa(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new n_(Fa(b,e),a,d));d=new Bv;for(e=0;e<c.length;e++)d.Qa(c[e],!0);return d}
function wZc(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new n_(Fa(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new n_(Fa(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new n_(Fa(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new n_(Fa(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new n_(Fa(b,e),a,d));d=new Bv;for(e=0;e<c.length;e++)d.Qa(c[e],!0);return d}
function xZc(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two digit year ("+(e+")");c.push(new n_(Fa(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new n_(Fa(b,e),a,d));d=new Bv;for(e=0;e<c.length;e++)d.Qa(c[e],!0);return d}
function yZc(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c=new Bv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function zZc(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c=new Bv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function AZc(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c=new Bv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function BZc(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new n_(Fa(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new n_(Fa(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new n_(Fa(a,d),e,c));c=new Bv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function CZc(a){function b(a){return"AM/PM ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new n_(Fa(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new n_(Fa(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new n_(Fa(b,e),a,d));d=new Bv;for(e=0;e<c.length;e++)d.Qa(c[e],!0);return d}
function DZc(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c=new Bv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function EZc(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c=new Bv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function FZc(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new n_(Fa(a,d),e,c));c=new Bv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c};function IZc(a){m_.call(this,a);Ns(this,"Custom date and time formats")}y(IZc,m_);p=IZc.prototype;p.GSa=Ph;p.FX=n(11175.5628472222);p.isEmpty=function(){return Qa(Se(this.i1(),2))};p.mf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(Se(this.i1(),2))};p.Afa=function(){return new sZc("Custom date time format",11175.5628472222)};p.i1=function(){return JZc(this.input.bb())};
p.R5=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.FX(),c.Ll());c.D=d}b=KZc(this);Mb(b);for(c=0;c<b.length;c++)a.push(new $R(JZc(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.FX(),b[c])));return a};
function KZc(a){var b=kx,c=sb(b.DATEFORMATS,function(a){return LZc(a)},a),d=sb(b.TIMEFORMATS,function(a){return LZc(a)},a),e=c.concat(d);b=b.DATETIMEFORMATS;Mb(b);a=sb(b,function(a){return LZc(a)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function LZc(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Ta(a.join(""))}function JZc(a){var b=new We;b.setType(7);N(b,3,1);N(b,2,a);return b};function MZc(a,b){this.D=a;this.C=b}MZc.prototype.getUrl=g("D");function NZc(a,b,c,d,e,f){uw.call(this,a,b,"domain",d,e,f);this.H=c}y(NZc,uw);NZc.prototype.C=function(){var a=NZc.qa.C.call(this);a.domainName=this.H;return $b(a,cKa)};tKa.set("domain",function(a){return new NZc(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new NZc("","DEFAULT","",!0);function OZc(){};function PZc(a){for(var b="",c=a.KRb,d=c.length,e=0;e<d;e++){var f=c[e],h=a.IRb[f.Mh()];f.getName();var k=f.getLabel();f=f.TFb;f=U('<div id="'+V(h)+'" tabindex="0" role="link" class="'+V("ess-button")+'" aria-label="'+V(k)+'"><div class="'+V("ess-icon")+" "+V(f)+'"></div></div>');b+=f}return U(b+"")};function QZc(a,b){R.call(this,b);this.C=a||[];this.F=[];this.D=null}y(QZc,R);p=QZc.prototype;p.pea=!0;p.Nda=!1;p.gP=null;p.wCa=!1;p.eb=function(a,b){this.pea=a;this.Nda=b;if(this.wCa){b=this.Aa();for(var c=0,d;d=this.C[c];c++){var e=b.getElement(this.gP.lpa+"-"+d.Mh()),f=a;ws(e,"ess-button",f);ws(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();dv(e,f,d)}}};
p.Ha=function(){this.La=this.pb.createElement("SPAN");var a={};a.lpa=Ur(this,"service");a.KRb=this.C;this.gP=a;for(var b={},c=0,d;d=this.C[c];c++)b[d.Mh()]=this.gP.lpa+"-"+d.Mh();a.IRb=b;this.gP=a;Ot(this.getElement(),PZc,this.gP);this.wCa=!0};
p.APb=function(a){if(this.pea){if(this.D){var b={};b.externalSharingService=a.C;this.D.C(9,b)}if(this.Nda)this.dispatchEvent(new RZc(new SZc));else{var c=this.D||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.C;c.C(10,d)}a={TEc:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=Yr(b,a))&&a.focus()}}};
p.Ra=function(){this.eb(this.pea,this.Nda);for(var a=this.Aa(),b=this.getHandler(),c=0,d;d=this.C[c];c++){var e=a.getElement(this.gP.lpa+"-"+d.Mh());b.Yg(e,He,v(this.APb,this,d))}};p.Oa=function(){QZc.qa.Oa.call(this);delete this.F;delete this.C;this.D=null};function RZc(a,b){I.call(this,"me",b);this.context=a}y(RZc,I);function SZc(){}y(SZc,OZc);function r_(a,b,c,d){this.C=a;this.F=b;this.D=c;this.TFb=d;this.H=TZc++}var TZc=0;r_.prototype.Mh=g("H");r_.prototype.getName=g("F");r_.prototype.getLabel=g("D");function UZc(){r_.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}y(UZc,r_);UZc.prototype.getUrl=function(a){var b=sb(a,function(a){return a.C});a=sb(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Ua(a.join(","))+"&t="+Ua(b.join(","))};function VZc(){r_.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}y(VZc,r_);VZc.prototype.getUrl=function(a){a=sb(a,function(a){return a.C+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Ua(a.join("\n"))};function WZc(){r_.call(this,"gp","Google+","Share via Google+","ess-gplus-icon")}y(WZc,r_);WZc.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Ua(a[0].getUrl())};function XZc(){r_.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}y(XZc,r_);XZc.prototype.getUrl=function(a){for(var b=qa(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].C;h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Ua(a)};function s_(a){R.call(this,a)}y(s_,R);function YZc(a){a.dispatchEvent(new I("ne"))}s_.prototype.IX=function(){return{}};s_.prototype.aK=Rh;s_.prototype.epa=ta;function ZZc(a){R.call(this,a)}y(ZZc,R);ZZc.prototype.F=Rh;ZZc.prototype.H=ta;ZZc.prototype.J=ta;function $Zc(a){var b="",c="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+QYc(a.locale)+'&answer=183965">Learn more</a>');b+='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">'+c+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">Embed</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+
V(a.T8a)+'" readonly="readonly" aria-label="'+cu("Link to published document.")+" "+V(a.$Pa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">Or share this link using:</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="'+
cu("HTML embed code of published document.")+" "+V(a.$Pa)+'">'+GGa(a.Jcb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+T(ev({id:"pub-dialog-publish-link-button",style:2,value:a.zPb}))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+T(xw({Bw:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"}))+'Published content & settings</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+
T(ev({id:"pub-dialog-publish-button",value:a.xPb}))+'<div class="pub-dialog-checkbox-container">';a.xGb&&(c="Require viewers to sign in with their "+(T(a.domain)+" account"),b+=T(iu({id:"pub-dialog-dom-signin-req",checked:a.Ts,disabled:a.vJ}))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.vJ?' class="pub-dialog-disabled-text"':"")+">"+c+"</label><br>");a.oP&&(b+=T(iu({id:"pub-dialog-auto-publish-checkbox"}))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">Automatically republish when changes are made</label>');
return U(b+"</div></div></div></div></div>")};function t_(a,b,c,d,e,f,h,k,l,m){lu.call(this);this.Ab=a||"";this.Qe=b;this.kd=c;this.Vc=d;this.Jc=l||"/publishsettings";this.C=new a_c(e);this.Kb=new QZc([new WZc,new VZc,new UZc,new XZc]);this.Qa(this.Kb);this.Ba=new gv(null,this.Aa());this.Qa(this.Ba);this.R=new gv(null,this.Aa());this.Qa(this.R);this.gb=new ju(void 0,this.Aa());this.Qa(this.gb);this.Ia=new ju(void 0,this.Aa());this.Qa(this.Ia);this.ib=0;this.Vb=new b_c;this.Qa(this.Vb);this.Cb=this.Lb=null;this.J=f||new s_;this.Qa(this.J);this.F=
h||new s_;this.Qa(this.F);this.cb=k||new ZZc;this.Qa(this.cb);this.O=this.L=null;this.wb=new rw(void 0,c_c,this.Aa(),2);this.Fa(this.wb);this.Me=this.yd=null;this.rf=m||new R;this.Yb=this.jb=this.Nb=null;this.pj=!0}y(t_,lu);var c_c="Press "+((Ec?"\u2318+C":"Ctrl+C")+" to copy.");p=t_.prototype;p.show=function(){d_c(this,v(function(){this.setVisible(!0)},this))};
p.setVisible=function(a){t_.qa.setVisible.call(this,a);var b=Lo(this.Aa());a?this.getHandler().V(b,"resize",this.ld):this.getHandler().Gc(b,"resize",this.ld)};
p.Ha=function(){t_.qa.Ha.call(this);var a=this.Aa(),b=S($Zc,{xGb:!!this.C.domain,oP:this.C.oP(),Ts:this.C.Ts,domain:this.C.C,vJ:this.C.vJ,xPb:e_c(this),zPb:u_(this,f_c(this))?"Published":"Publish",T8a:this.C.Pk?g_c(this,this.J.IX()):"",Jcb:this.C.Pk?h_c(this,this.F.IX()):"",locale:"en",$Pa:c_c});a.appendChild(this.Pb(),b);Ns(this,"Publish to the web");Ys(this,null);ss(this.Pb(),"pub-dialog-content")};
p.Ra=function(){var a=this.Aa(),b=a.getElement("pub-dialog-sharing-services-links");this.Kb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Nb=a.getElement("pub-dialog-links-notice");this.rf.render(this.Nb);b=a.getElement("pub-dialog-published-content");this.cb.render(b);t_.qa.Ra.call(this);b=this.getHandler();var c=a.getElement("pub-dialog-dom-signin-req");c&&(this.gb.kb(c),St(this.gb,a.getElement("pub-dialog-dom-signin-req-label")),
b.V(this.gb,"change",this.RUb));this.C.oP()&&(this.Ia.kb(a.getElement("pub-dialog-auto-publish-checkbox")),St(this.Ia,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.V(this.Ia,"change",this.NUb));this.Lb=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.Cb=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");pw(this.wb,this.L);this.Vb.kb(a.getElement("pub-dialog-links-tab-bar"));this.yd=a.getElement("pub-dialog-sharing-services");
this.Me=a.getElement("pub-dialog-status-info");this.Ba.kb(a.getElement("pub-dialog-publish-link-button"));this.R.kb(a.getElement("pub-dialog-publish-button"));this.Yb=new PO("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Pk);this.Fa(this.Yb);b.V(this.Vb,"select",this.pAb).V(this.L,"focus",this.xRa).V(this.O,"focus",this.xRa).V(this.R,"action",this.BPb).V(this.getElement(),"keyup",this.c8a).V(this.J,"ne",this.ara).V(this.F,"ne",this.ara).V(this.Ba,"action",this.uyb).V(this.cb,"oe",
this.vyb).V(this.Yb,"toggle",this.ld);i_c(this)};function i_c(a){if(a.Wb()){var b=a.Aa(),c=a.C.Pk,d=a.C.vJ;a.cb.H(a.C.Um);a.gb.eb(!d);a.R.setContent(e_c(a));a.R.eb(a.C.Pk||!a.C.Um||!a.C.Um.isEmpty());a.C.oP()&&a.Ia.yc(a.C.uw);a.ara();b=b.Oi("pub-dialog-state-publishing");A(b,function(a){Q(a,c)});Ao(a.Me,c?"This document is published to the web.":"This document is not published to the web.");a.ld()}}p.c8a=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function j_c(a,b){var c=window.location.href,d=Cj(c);c=Gj(c);var e=$a(c,"/"+a.Vc+"/")?"/"+a.Vc:"";a.C.Ts&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.F||a.Ab;b=Uta.test(b)?b:Sj("/d/"+a,b);return Bj(c,f,h,d,Sj(e,b))}
p.ara=function(){var a=this.J.aK();if(a=u_(this,a)){var b=this.J.IX();b=this.C.Pk?g_c(this,b):"";this.L.value=b;this.Kb.F=[new MZc(b,this.Qe)]}Q(this.L,a);Q(this.yd,a&&!this.C.vJ);a=this.F.aK();if(a=u_(this,a))b=this.F.IX(),this.O.value=this.C.Pk?h_c(this,b):"";Q(this.O,a);a=u_(this,f_c(this));Q(this.Nb,a);this.Ba.eb(!a);this.Ba.setContent(u_(this,f_c(this))?"Published":"Publish")};
p.pAb=function(a){a=a.target;this.Aa();qw(this.wb);"pub-dialog-link-tab"==a.getId()?(this.ib=0,Q(this.Lb,!0),Q(this.Cb,!1),pw(this.wb,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.ib=1,Q(this.Lb,!1),Q(this.Cb,!0),pw(this.wb,this.O));i_c(this)};p.xRa=function(a){ii(function(){a.target.select()},0)};p.RUb=function(){this.C.Pk?k_c(this,2,!1):this.C.Ts=!this.C.Ts};p.NUb=function(){this.C.Pk?k_c(this,0,!1):this.C.uw=!this.C.uw};function e_c(a){return a.C.Pk?"Stop publishing":"Start publishing"}
function d_c(a,b){Hm(a.kd.Ke(a.Jc).Ef("id",a.Ab),v(function(a){this.C.Pk=!!sm(a,"published");this.C.Ts=!!sm(a,"requireSignin");this.C.vJ=!!sm(a,"domainClosed");this.C.domain=GYc(a,"domain");this.C.C=GYc(a,"domainDisplay");var c=this.C;var e=Number(sm(a,"revision"));c.uw=!e;this.C.Um=this.LFa(a.Ye());this.C.F=GYc(a,"publishedDocumentId");b()},a)).ye()}p.LFa=Rh;p.rFa=Rh;function l_c(a){return{uw:a.C.uw,Pk:a.C.Pk,Ts:a.C.Ts,Um:a.C.Um}}
function k_c(a,b,c){c=u(c)?c:!0;var d=l_c(a);switch(b){case 0:d.uw=!d.uw;break;case 1:d.Pk=!d.Pk;break;case 2:d.Ts=!d.Ts;break;default:throw Error("Unknown toggle op: "+b);}d.Pk||(d.Um=a.rFa());m_c(a,d,c)}
function m_c(a,b,c){n_c(a,!1);Gm(Hm(Em(Jm(a.kd.Ke(a.Jc).Ef("id",a.Ab),o_c(a,b)),2),v(function(){this.C.uw=b.uw;this.C.Pk=b.Pk;this.C.Ts=b.Ts;this.C.Um=b.Um;this.C.Pk&&this.C.Um&&(u_(this,this.J.aK())||this.J.epa(this.C.Um),u_(this,this.F.aK())||this.F.epa(this.C.Um));n_c(this,!0);i_c(this);if(c&&this.C.Pk)switch(this.ib){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.ib);}},a)),v(function(){jHa("An error occurred while saving publishing settings.",
void 0,this.Wb()?this:void 0);n_c(this,!0);i_c(this)},a)).ye()}function o_c(a,b){var c={id:a.Ab,requireSignin:b.Ts,published:b.Pk};a.C.oP()&&!b.uw&&(c.revision=a.C.D);b.Um&&(a=p_c(b.Um),sc(c,a));return c}function n_c(a,b){for(var c=[a.Ia,a.R,a.Ba,a.gb],d=0;d<c.length;d++){var e=c[d];!b&&e.To()&&(a.jb=e);e.eb(b)}b&&a.jb&&(a.isVisible()&&a.jb.isVisible()&&(c=a.jb.getElement())&&c.focus(),a.jb=null);a.cb.J(b)}
p.BPb=function(a,b){if(b||window.confirm(this.C.Pk?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.R.setContent("Saving..."),k_c(this,1)};function f_c(a){switch(a.ib){case 0:return a.J.aK();case 1:return a.F.aK();default:throw Error("Cannot handle selected link type "+a.ib);}}
p.uyb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=f_c(this),b=l_c(this);b.Pk=!0;a&&(b.Um&&this.C.Pk?b.Um=q_c(b.Um,a):b.Um=a);this.Ba.setContent("Publishing...");m_c(this,b,!0)}};p.vyb=function(){var a=this.cb.F();if(this.C.Pk)if(a&&a.isEmpty())k_c(this,1);else{var b=l_c(this);b.Um=a;m_c(this,b)}else this.C.Um=a,i_c(this)};function u_(a,b){return a.C.Pk&&(!b||!a.C.Um||a.C.Um.TGb(b))}
function a_c(a){this.D=a;this.vJ=this.Ts=this.Pk=!1;this.uw=!0;this.F=this.C=this.domain=""}a_c.prototype.oP=function(){return!!this.D};function b_c(){mV.call(this)}y(b_c,mV);b_c.prototype.Ij=function(a){return a.keyCode&&27==a.keyCode?!1:b_c.qa.Ij.call(this,a)};function r_c(a,b,c,d){this.F=a;this.qh=b;this.C=c;this.D=d}function s_c(a,b){return new r_c(!1,null,new t_c(a,b||"interactive"),null)}function t_c(a,b){this.id=a;this.format=b};function v_(a,b,c){this.F=a;this.D=new sk(b);this.C=c}p=v_.prototype;p.TGb=function(a){return this.F||!a.F&&vb(a.D.od(),this.z8,this)&&vb(a.C,this.p8,this)};p.z8=function(a){return this.F||this.D.contains(a)};function u_c(a,b){return ub(a.C,function(a){return a.id==b.id})}p.p8=function(a){return this.F||this.D.contains(a.qh)||u_c(this,a)};function v_c(a,b){a.C=rb(a.C,function(a){return a.qh!=b})}function w_c(a,b){u_c(a,b)&&(a.C=rb(a.C,function(a){return a.id!=b.id}))}
function q_c(a,b){var c=a.F||b.F;if(c)return new v_(c,[],[]);var d=a.clone();A(b.D.od(),function(a){d.D.contains(a)||(d.D.add(a),v_c(d,a))});A(b.C,function(a){d.p8(a)||d.C.push(a)});return d}function p_c(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.od().join(","),charts:sb(a.C,function(a){return a.id}).join(",")}}p.isEmpty=function(){return!this.F&&this.D.isEmpty()&&Ab(this.C)};p.clone=function(){return new v_(this.F,this.D.od(),Jb(this.C))};
p.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&Sb(this.C,a.C,function(a,c){return a.id==c.id&&a.qh==c.qh})};function x_c(a,b){this.id=a;this.qh=b};function y_c(a,b,c,d){R.call(this,void 0);this.C=c||new r_c(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new yM("",z_c(a,b));VR(this.D,!0);this.Qa(this.D,!0);a=new Bv;a.Qa(new yt("Interactive","interactive"),!0);a.Qa(new yt("Image","image"),!0);this.H=new yM("",a);this.Qa(this.H,!0);a=new Bv;a.Qa(new yt("Web page","html"),!0);a.Qa(new yt("Comma-separated values (.csv)","csv"),!0);a.Qa(new yt("Tab-separated values (.tsv)","tsv"),!0);a.Qa(new yt("PDF document (.pdf)","pdf"),!0);a.Qa(new yt("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Qa(new yt("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new yM("",a);this.Qa(this.F,!0);A_c(this)}y(y_c,s_);var B_c=["xlsx","ods"],C_c=["csv","tsv"];
function z_c(a,b){var c=new Bv;c.Qa(new yt("Entire Document",new D_c("entireDocument",null)),!0);c.Qa(new Av,!0);var d=i9a(b);A(a.D,function(a){c.Qa(new yt(a.we(),new D_c("sheet",a.Jb())),!0);if(a=d[a.Jb()])for(var b=0;b<a.length;b++){var e=a[b];6==e.getType()&&e.isSaved()&&(e=new yt(JYc(e),new D_c("chart",GH(e))),c.Qa(e,!0),ss(e.Pb(),"pub-dialog-link-options-chart-menu-item"))}});return c}p=y_c.prototype;
p.Ra=function(){y_c.qa.Ra.call(this);ss(this.getElement(),"pub-dialog-link-options-container");ss(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");ss(this.D.Pb(),"pub-dialog-link-options-document-part-menu-button-content");ss(this.D.wc().getElement(),"pub-dialog-link-options-document-part-menu");ps(this.D.La,"Sheet or chart selection");ps(this.H.La,"Chart format");ps(this.F.La,"Sheet format");this.getHandler().V(this.D,"change",this.zob).V(this.H,"change",this.qlb).V(this.F,
"change",this.XAb).V(this.D,"afterhide",function(a){a.stopPropagation()}).V(this.H,"afterhide",function(a){a.stopPropagation()}).V(this.F,"afterhide",function(a){a.stopPropagation()})};p.zob=function(){var a=this.D.hf().hb();switch(a.type){case "entireDocument":this.C=new r_c(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id;var b=this.C.D;b&&!E_c(this,a,b)&&(b=null);this.C=new r_c(!1,a,null,b||"html");break;case "chart":this.C=s_c(a.id,this.C.C?this.C.C.format:null)}A_c(this);YZc(this)};
p.qlb=function(){var a=this.H.hf().hb();this.C.C&&(this.C.C.format=a,YZc(this))};p.XAb=function(){var a=this.F.hf().hb();this.C.D=a;YZc(this)};
function A_c(a){var b=Jb(a.D.Uj.C);b=xb(b,function(a){a=a.hb();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.qh&&a.id==this.C.qh;case "chart":return!!this.C.C&&a.id==this.C.C.id;default:return!1}},a);Uv(a.D,b);b=!!a.C.C;Q(a.H.getElement(),b);a.C.C&&a.H.fb(a.C.C.format);Q(a.F.getElement(),a.J&&dwa&&!b);b||(F_c(a),a.F.fb(a.C.D))}function F_c(a){for(var b=a.F.wc(),c=0;c<b.mj();c++){var d=b.Te(c),e=d.bb();d.eb(null==a.C.qh||E_c(a,a.C.qh,e))}}
function E_c(a,b,c){return zb(B_c,c)?!1:(a=SC(a.O,b))&&1==a.getSheetType()&&zb(C_c,c)?!1:!0}p.IX=g("C");p.aK=function(){if(this.C.F)return new v_(!0,[],[]);if(null!=this.C.qh)return new v_(!1,[this.C.qh],[]);var a=this.L.C(this.C.C.id);a=new x_c(this.C.C.id,a.Jb());return new v_(!1,[],[a])};p.epa=function(a){if(!a.F){var b=a.D.od();0<b.length?this.C=new r_c(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=s_c(a[0].id)));A_c(this)}};function D_c(a,b){this.type=a;this.id=b};function w_(a,b){Ev.call(this,void 0,void 0,new xM,void 0);this.ib=a;this.Ia=b;this.F=new v_(!0,[],[]);this.va=!1;this.O=new NO("Entire Document");this.Fd(this.O);this.Fd(new Av);G_c(this);VR(this,!0);H_c(this)}y(w_,Ev);function G_c(a){var b=i9a(a.Ia);A(a.ib.D,function(c){var d=new NO(c.we(),c);a.Fd(d);(c=b[c.Jb()])&&A(c,function(b){6==b.getType()&&b.isSaved()&&(b=new NO(JYc(b),b),a.Fd(b),ss(b.Pb(),"pub-dialog-published-content-chart-menu-item"))})})}
w_.prototype.Ra=function(){w_.qa.Ra.call(this);ss(this.getElement(),"pub-dialog-published-content-menu-button");ss(this.Pb(),"pub-dialog-published-content-menu-button-content");ss(this.wc().getElement(),"pub-dialog-published-content-menu");this.getHandler().V(this,"afterhide",function(a){a.stopPropagation()})};
w_.prototype.Ds=function(a){if(a.target==this.O){a=this.O.isChecked();var b=this.F;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.hb(),b instanceof eB?(b=b.Jb(),a?(a=this.F,a.D.contains(b)||(a.D.add(b),v_c(a,b))):(a=this.F,a.D.contains(b)&&(a.D.remove(b),v_c(a,b)))):(b=new x_c(GH(b),b.Jb()),a?(a=this.F,a.p8(b)||a.C.push(b)):w_c(this.F,b));this.va=!0;H_c(this)};w_.prototype.xe=function(a,b){w_.qa.xe.call(this,a,b);!a&&this.va&&(this.va=!1,this.dispatchEvent(new I("oe")))};
function H_c(a){var b=a.F.F;a.O.yc(b);A(Qqc(a.wc()),function(c){var d=c.hb();d&&(d instanceof eB?(c.yc(a.F.z8(d.Jb())),c.eb(!b)):(d=new x_c(GH(d),d.Jb()),c.yc(a.F.p8(d)),c.eb(!a.F.z8(d.qh))))});I_c(a)}function I_c(a){if(a.F.F)var b="Entire Document";else{b=rb(a.ib.D,v(function(a){return this.F.z8(a.Jb())},a));b=sb(b,function(a){return a.we()});for(var c=[],d=a.F.C,e=0;e<d.length;e++){var f=a.Ia.C(d[e].id);f&&c.push(JYc(f))}b=Ib(b,c);b=0<b.length?b.join(", "):"None"}a.setContent(b)};function x_(a,b){R.call(this,void 0);this.C=new w_(a,b);this.Qa(this.C,!0);this.D=!1}y(x_,ZZc);x_.prototype.Ra=function(){x_.qa.Ra.call(this);ss(this.getElement(),"pub-dialog-published-content-container")};x_.prototype.F=function(){return this.C.F};x_.prototype.H=function(a){var b=this.C;b.F=a.clone();H_c(b)};x_.prototype.J=function(a){!a&&this.C.To()&&(this.D=!0);this.C.eb(a);a&&this.D&&(this.Wb()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function J_c(a){a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+QYc(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return U(""+('<div class="pub-dialog-chart-notice">'+a+"</div>"))};function K_c(a,b,c,d,e,f,h){var k=null!=h?s_c(h):null;h=new y_c(c,d,k,!0);k=new y_c(c,d,k,!1);t_.call(this,a,b,e,Gva,f,h,k,new x_(c,d),"/publishingsettings",new L_c);this.Lf=c;this.tc=d}y(K_c,t_);
K_c.prototype.LFa=function(a){if(a.entireDocument)return new v_(!0,[],[]);var b=a.charts||"";a=sb((a.sheets||"").split(","),function(a){return parseInt(a,10)});a=rb(a,function(a){return!!SC(this.Lf,a)},this);b=sb(b.split(","),function(a){return parseInt(a,10)});b=rb(b,v(function(a){return!!this.tc.C(a)},this));b=sb(b,function(a){var b=this.tc.C(a);return new x_c(a,b.Jb())},this);return new v_(!1,a,b)};K_c.prototype.rFa=function(){return new v_(!0,[],[])};
function g_c(a,b){if(b.F||null!=b.qh){var c="html"==b.D;a=j_c(a,c?"/pubhtml":"/pub");null!=b.qh&&(a=Lj(a,"gid",b.qh,"single","true"));c||(a=Lj(a,"output",b.D))}else a=Lj(j_c(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function h_c(a,b){var c=g_c(a,b);if(b.F||null!=b.qh)c=Lj(c,"widget","true","headers","false");a=b.C?(a=a.tc.C(b.C.id))?a.Yc():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Ya(c)+'"></iframe>'}function L_c(){}y(L_c,R);L_c.prototype.Ha=function(){this.La=S(J_c,{locale:"en"})};function M_c(a,b,c){return YFa(a||"There was a problem",Ki(b),void 0,void 0,void 0,void 0,c)};function N_c(a){return U("<div><div>"+T(a.L4a)+"</div>"+T(iu({id:"waffle-confirm-suppress-checkbox",xd:"waffle-confirm-suppress-checkbox"}))+'<span id="waffle-confirm-suppress-label">'+T(a.Bqa)+"</span></div>")};function O_c(a,b,c,d,e,f,h){if(Ca(c)){var k=new Vs;k.set("ok",c.ok,!0);k.set("cancel",c.cancel,!1,!0)}else k=nFa;return P_c(d||"Heads up!",a,b,k,e,f,h)}function P_c(a,b,c,d,e,f,h){b=Ki(b);if(f){b=Mt(N_c({L4a:b,Bqa:f}));var k=new ju;var l=c;c=function(){l(k.isChecked())}}a=ZFa(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Qa(k),k.kb(Io(a.Aa(),"waffle-confirm-suppress-checkbox")),c=Io(a.Aa(),"waffle-confirm-suppress-label"),St(k,c),k.yc(!1));return a};function Q_c(a){var b=a.description;a=a.DPb;return U('<div class="waffle-dv-rec-chip" title="'+V(b)+'"><div class="waffle-dv-rec-range">'+T(a)+'</div><div class="waffle-dv-rec-description">'+T(b)+"</div></div>")}function R_c(){return U('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function y_(){var a=new yM(null);VR(a,!0);return a};function S_c(a,b,c){J.call(this);this.D=a;this.Nj=b;this.Vb=c;this.R=this.H=this.Pa=this.Ia=this.$=this.F=null;this.Vc=new zS;this.rf=new zS;this.Ba=this.O=null;this.Hd=new zS;this.xg=new zS;this.gb=this.$a=this.cb=this.va=this.L=null;this.Me=new zS;this.Qe=new zS;this.kd=new zS;this.sf=new zS;this.ib=this.tc=null;this.C=new aX("");this.jb=this.J=this.Kb=this.Cb=this.Yd=this.Yb=this.Nb=this.Ab=null;this.kh=this.Jc=!1;this.yd=this.Lf=this.Lb=this.wb=null;this.ze=new Ti(this);this.Fa(this.ze);this.Nc=
new kl;this.ah=this.Fi=this.Ph=this.Dg=this.Ei=this.Wa=null;this.Jx();a=this.ze;a.V(this.F,"action",this.Isb);a.V(this.$,"action",this.Lka);a.V(this.Ia,"action",this.Lka);a.V(this.Pa,"action",this.Lka);a.V(this.J,"focus",Fa(this.YRa,!0));a.V(this.J,"blur",Fa(this.YRa,!1));a.V(this.J,"change",this.Aka);a.V(this.J,"keyup",this.Aka);b=[this.O,this.Ba,this.H,this.R,this.L,this.va,this.$a,this.gb];for(c=0;c<b.length;c++)this.ze.V(b[c],"change",v(this.UWb,this,b[c])),this.ze.V(b[c],"keyup",v(this.Dsb,this,
b[c]));a.V(this.Lb,"change",v(this.sKa,this));a.V(this.cb,"change",v(this.$Db,this));a.Yg(this.jb,He,this.yzb)}y(S_c,J);var T_c="placeholder"in document.createElement("input"),U_c=/\s*,\s*/;function V_c(a){var b=a.ah;b||(b=[{gj:"List from a range",type:4},{gj:"List of items",type:3},{gj:"Number",type:0},{gj:"Text",type:1},{gj:"Date",type:2},{gj:"Custom formula is",type:5}],F(E(),"fecdv")&&b.push({gj:"Checkbox",type:6}),a.ah=b);return b}
function W_c(a){var b=a.Fi;b||(b=[{gj:"contains",code:9,inputs:0,example:"Approved"},{gj:"does not contain",code:10,inputs:0,example:"Approved"},{gj:"equals",code:13,inputs:0,example:"Approved"},{gj:"is valid email",code:14,inputs:-1,example:null},{gj:"is valid url",code:15,inputs:-1,example:null}],a.Fi=b);return b}
function X_c(a){var b=a.Dg;b||(b=[{gj:"is valid date",code:30,inputs:-1,example:null},{gj:"equal to",code:16,inputs:2,example:"11/15/2014"},{gj:"before",code:17,inputs:2,example:"11/15/2014"},{gj:"on or before",code:19,inputs:2,example:"11/15/2014"},{gj:"after",code:18,inputs:2,example:"11/15/2014"},{gj:"on or after",code:20,inputs:2,example:"11/15/2014"},{gj:"between",code:21,inputs:3,example:"11/15/2014",pP:"11/15/2015"},{gj:"not between",code:22,inputs:3,example:"11/15/2014",pP:"11/15/2015"}],
a.Dg=b);return b}function Y_c(a){var b=a.Ph;b||(b=[{gj:"range",code:23,inputs:6,example:null},{gj:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.Ph=b);return b}
function Z_c(a){var b=a.Ei;b||(b=[{gj:"between",code:7,inputs:8,example:"10",pP:"100"},{gj:"not between",code:8,inputs:8,example:"10",pP:"100"},{gj:"less than",code:3,inputs:7,example:"10"},{gj:"less than or equal to",code:4,inputs:7,example:"10"},{gj:"greater than",code:1,inputs:7,example:"10"},{gj:"greater than or equal to",code:2,inputs:7,example:"10"},{gj:"equal to",code:5,inputs:7,example:"10"},{gj:"not equal to",code:6,inputs:7,example:"10"}],a.Ei=b);return b}
function $_c(){return{gj:"",code:29,inputs:0,example:"=ISODD(A1)"}}function a0c(){return{gj:"",code:31,inputs:-1,example:""}}p=S_c.prototype;
p.Jx=function(){var a=this.D,b,c,d,e,f,h,k,l,m,q,t,w,x,z,C=a.Aa(),L;var P=C.Ha("TR","waffle-dv-trrules",C.Ha("TD","waffle-dv-label",C.Ha("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),C.Ha("TD",{colspan:"7"},l=C.Ha("DIV","goog-inline-block"),L=C.Ha("DIV","goog-inline-block"),h=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=C.Ha("SPAN","waffle-dv-separator","and"),k=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.kd.kb(h);this.sf.kb(k);this.Hd.kb(c);this.xg.kb(d);this.Vc.kb(e);this.rf.kb(f);var W=y_();Tr(W,l);var ea=y_();Tr(ea,l);var ca=y_();Tr(ca,l);var oa=y_();Tr(oa,l);var wa=b0c(a,L);(w=W.getElement())&&ks(w,"labelledby","waffle-dv-criteria");
var ua;var ya=C.Ha("TR","waffle-dv-trrules waffle-dv-trrules-showitems",C.Ha("TD"),C.Ha("TD",{colspan:"7"},ua=C.Ha("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show dropdown list in cell")));w=new ju;St(w,ua);Tr(w,ua);var Xa=C.Ha("TR","waffle-dv-trrules waffle-dv-trrules-showitems",C.Ha("TD"),C.Ha("TD",{colspan:"7"},m=C.Ha("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var Wa=new ju;St(Wa,m);Tr(Wa,m);var Ra=C.Ha("TR","waffle-dv-trrules",C.Ha("TD"),C.Ha("TD","waffle-dv-customcheckboxlabel",
C.Ha("SPAN",{id:"customCheckboxInputLabel_checked"},"Checked:")),C.Ha("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},q=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var wb=C.Ha("TR","waffle-dv-trrules",C.Ha("TD"),C.Ha("TD","waffle-dv-customcheckboxlabel",C.Ha("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unchecked:")),C.Ha("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},t=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));this.Me.kb(q);
this.Qe.kb(t);ks(q,"labelledby","customCheckboxInputLabel_checked");ks(t,"labelledby","customCheckboxInputLabel_unchecked");CS(this.Me,"e.g., TRUE");CS(this.Qe,"e.g., FALSE");var Nc=C.Ha("TR","waffle-dv-trrules",C.Ha("TD","waffle-dv-label",C.Ha("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),C.Ha("TD",{colspan:"7"},C.Ha("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},C.Ha("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",
role:"radio"}),C.Ha("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),C.Ha("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),C.Ha("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new qAc(!0);rAc(m,"onInvalidData",Nc);var Rb=C.Ha("TR","waffle-dv-trrules waffle-dv-trrules-appearance",C.Ha("TD",null,C.Ha("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),C.Ha("TD",{colspan:"7"},x=C.Ha("SPAN","waffle-dv-label waffle-dv-checkbox-label",
"Show validation help text:")));var Sc=new ju;St(Sc,x);Tr(Sc,x);x=Sc.La;var Tc=BEa(x,"labelledby");ks(x,"labelledby","waffle-dv-appearance "+Tc);x=C.Ha("TR","waffle-dv-trrules",C.Ha("TD"),C.Ha("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},z=C.Ha("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),Tc=C.Ha("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));Co(Tc,!0);a=a.O.childNodes[0];C.appendChild(a,P);C.appendChild(a,
ya);C.appendChild(a,Xa);C.appendChild(a,Ra);C.appendChild(a,wb);C.appendChild(a,Nc);C.appendChild(a,Rb);C.appendChild(a,x);this.C.render(l);C=this.C;C.Xma=29;C.resize();C=this.C;C.kNa=200;C.resize();this.C.getElement().style.width="324px";T_c?this.C.getElement().placeholder="Enter items separated by a comma...":(C=this.C.getElement(),dv(C,"Enter items separated by a comma...","Enter items separated by a comma..."));if(C=this.C.getElement())ps(C,"Enter items separated by a comma..."),ts(C,["waffle-dv-list-options-textarea",
"jfk-textinput"]);this.J=z;W.setVisible(!0);C=V_c(this);c0c(this,C,W);C=Z_c(this);c0c(this,C,oa);C=W_c(this);c0c(this,C,ea);C=X_c(this);c0c(this,C,ca);d0c(this,W,oa,ea,ca,h,k,c,d,e,f,b,l,wa,ya,x,w,ua,Tc,Sc,L,m,Wa,q,t,Xa,Ra,wb)};
function d0c(a,b,c,d,e,f,h,k,l,m,q,t,w,x,z,C,L,P,W,ea,ca,oa,wa,ua,ya,Xa,Wa,Ra){a.F=b;a.F.setVisible(!0);a.Ia=c;a.$=e;a.Pa=d;a.tc=t;a.L=f;a.va=h;a.O=k;a.Ba=l;a.H=m;a.R=q;a.ib=w;a.Wa=x;a.Ab=ca;a.cb=wa;a.$a=ua;a.gb=ya;a.Yd=Xa;a.Cb=Wa;a.Kb=Ra;Q(a.Yd,!1);Q(a.Cb,!1);Q(a.Kb,!1);ea.yc(!1);a.Lb=ea;a.yd=oa;e0c(a,!1);a.Nb=z;L.yc(!0);a.wb=L;a.Lf=P;a.Yb=C;Q(a.Yb,!0);f0c(a);g0c(a);a.jb=W;Q(a.jb,!1)}
function h0c(a,b){Q(a.Nb,23==b||24==b);a.Lf.innerText="Show dropdown list in cell";b=31==b;Q(a.Yd,b);var c=a.cb.isChecked();Q(a.Cb,b&&c);Q(a.Kb,b&&c)}function i0c(a){d0c(a,a.F,a.Ia,a.Pa,a.$,a.L,a.va,a.O,a.Ba,a.H,a.R,a.tc,a.ib,a.Wa,a.Nb,a.Yb,a.wb,a.Lf,a.jb,a.Lb,a.Ab,a.yd,a.cb,a.$a,a.gb,a.Yd,a.Cb,a.Kb)}function c0c(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.Aa();e=new yt(b[d].gj,null,e);c.Fd(e);js(e.getElement(),"menuitem")}c.Bf(0)}p.Lka=function(){g0c(this);this.J.value=j0c(this);this.dispatchEvent("change")};
p.Isb=function(){f0c(this);g0c(this);this.J.value=j0c(this);this.dispatchEvent("change")};p.YRa=da("kh");p.Aka=function(a){this.Jc||a&&!eDa(a)||this.J.value===k0c(this)||(this.Jc=!0,Q(this.jb,!0))};p.yzb=function(){this.Jc=!1;this.J.value=j0c(this);Q(this.jb,!1)};p.sKa=function(){Q(this.Yb,this.Lb.isChecked())};p.$Db=function(){var a=this.cb.isChecked();a||l0c(this);Q(this.Cb,a);Q(this.Kb,a);m0c(this)};function m0c(a){a.J.value=j0c(a)}function n0c(a){m0c(a);a.C.resize()}
p.UWb=function(a){m0c(this);o0c(this,a)?(this.D.Hl=0,z_(a),this.dispatchEvent("change")):(this.D.Hl=1,A_(a),this.dispatchEvent("error"))};p.Dsb=function(){this.dispatchEvent("keyup")};function o0c(a,b){if(0!=B_(a))return!0;var c=b.value;if(null!=c&&Lr(b)){if(!p0c(a.D))return!0;a=C_(a,c,q0c(a).code);return!!a&&(Me(a,3)||Me(a,5)&&M(a,5).Qc()&&3==M(M(a,5).bb(),1))}return!0}function A_(a){a.select();ss(a,"waffle-input-error")}function z_(a){a&&us(a,"waffle-input-error")}
function l0c(a){z_(a.C.getElement());z_(a.H);z_(a.R);z_(a.L);z_(a.va);z_(a.$a);z_(a.O);z_(a.Ba);z_(a.Wa.Er());a.D.Hl=0;a.dispatchEvent("change")}function B_(a){return V_c(a)[a.F.eh()].type}function f0c(a){var b=B_(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.$.setVisible(c);a.Ia.setVisible(d);a.Pa.setVisible(e);Q(a.ib,f);Q(a.Ab,h);Q(a.L,!1);Q(a.va,!1);Q(a.O,!1);Q(a.Ba,!1);Q(a.H,!1);Q(a.R,!1);f&&a.C.resize();a.dispatchEvent("change")}
function q0c(a){var b;r0c(a)?b=r0c(a):a.$.isVisible()?b=X_c(a)[a.$.eh()]:a.Ia.isVisible()?b=Z_c(a)[a.Ia.eh()]:5==B_(a)?b=$_c():6==B_(a)?b=a0c():b=W_c(a)[a.Pa.eh()];return b}function r0c(a){var b=Y_c(a);return 4==B_(a)?b[0]:3==B_(a)?b[1]:null}
function g0c(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,q=q0c(a);-1!=q.inputs&&(0==q.inputs?d=!0:1==q.inputs?k=e=d=!0:2==q.inputs?f=!0:3==q.inputs?k=h=f=!0:7==q.inputs?b=!0:8==q.inputs?k=c=b=!0:5==q.inputs?l=!0:6==q.inputs&&(m=!0));var t=q0c(a);if(3==B_(a))T_c?a.C.getElement().placeholder="Enter items separated by a comma...":(t=a.C.getElement(),dv(t,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(t.example)if(0==t.inputs||1==t.inputs)CS(a.Hd,"e.g., "+
t.example),CS(a.xg,"e.g., "+t.pP||"");else if(2==t.inputs||3==t.inputs)CS(a.Vc,"e.g., "+t.example),CS(a.rf,"e.g., "+t.pP||"");else if(7==t.inputs||8==t.inputs)CS(a.kd,"e.g., "+t.example),CS(a.sf,"e.g., "+t.pP||"");l0c(a);Q(a.L,b);Q(a.va,c);Q(a.O,d);Q(a.Ba,e);Q(a.H,f);Q(a.R,h);Q(a.ib,l);l&&a.C.resize();Q(a.Ab,m);h0c(a,q.code);Q(a.tc,k)}
function C_(a,b,c){var d=p0c(a.D);if(""==b||null==d.fd)return null;var e=d.rect,f=e.kc();e=e.gc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.fd+"",f,e,b,c,!0))?a.Nc.jd(If.Na(),b):null}
function s0c(a){var b=new Mf,c=q0c(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(C_(a,a.O.value,d));break;case 1:e.push(C_(a,a.O.value,d));e.push(C_(a,a.Ba.value,d));break;case 2:e.push(C_(a,a.H.value,d));break;case 3:e.push(C_(a,a.H.value,d));e.push(C_(a,a.R.value,d));break;case 7:e.push(C_(a,a.L.value,d));break;case 8:e.push(C_(a,a.L.value,d));e.push(C_(a,a.va.value,d));break;case 5:a=a.C.bb().split(",");for(c=0;c<a.length;c++)e.push(dsc(a[c]));break;case 6:c=XZa("="+a.Wa.bb());e.push(C_(a,c,
d));break;case -1:a.cb.isChecked()&&(e.push(C_(a,Ta(a.$a.value),d)),Qa(a.gb.value)||e.push(C_(a,Ta(a.gb.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=uS(d,e);N(b,1,d);return b}function t0c(a){var b=Ta(a.Wa.bb());!a.Vb.C.D[Ta(fb(b).toLowerCase())]&&DU(a.Vb,b)&&(b=orc(a.Vb,b,!0));return b}function j0c(a){return a.Jc||a.kh?a.J.value:k0c(a)}
function k0c(a){var b="";var c=B_(a);var d=4==c;c=3==c||4==c;if(a.$.isVisible())c=X_c(a)[a.$.eh()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Pa.isVisible())c=W_c(a)[a.Pa.eh()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid url":b+"Enter text that ";else if(c)c=r0c(a),b+="Click and enter a value from ";else if(5==B_(a))c=$_c(),b="Enter a value that satisfies the formula:";else if(6==B_(a))if(c=a0c(),a.cb.isChecked()&&!Qa(Ta(a.$a.value))){b=Ta(a.$a.value);var e=
Ta(a.gb.value);b=Qa(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=Z_c(a)[a.Ia.eh()],b+="Enter a number ";-1!=c.inputs&&(b+=c.gj);e=t0c(a);23==c.code&&""!=e&&d&&(d=orc(a.Vb,e,!0))&&(b+=" "+d);Qa(fb(a.O.value))||0!=c.inputs&&1!=c.inputs?Qa(fb(a.H.value))||2!=c.inputs&&3!=c.inputs?Qa(fb(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;Qa(fb(a.Ba.value))||1!=c.inputs?Qa(fb(a.R.value))||3!=c.inputs?Qa(fb(a.va.value))||
8!=c.inputs||(b+=" and "+a.va.value):b+=" and "+a.R.value:b+=" and "+a.Ba.value;return b}function e0c(a,b){sAc(a.yd,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function D_(a,b){switch(b){case 0:a.F.Bf(2);break;case 1:a.F.Bf(3);break;case 2:a.F.Bf(4);break;case 3:a.F.Bf(1);break;case 4:a.F.Bf(0);break;case 5:a.F.Bf(5);break;case 6:a.F.Bf(6)}}
function u0c(a,b,c,d,e){a.F.Bf(0);a.$.Bf(0);a.Ia.Bf(0);a.Pa.Bf(0);a.J.value="";a.L.value="";a.va.value="";a.H.value="";a.R.value="";a.O.value="";a.Ba.value="";a.C.fb("");a.Wa.fb("");e0c(a,!1);var f=a.Jc=!1,h=!1,k=!1,l=!1,m=!1,q=!1,t=!1,w=!1,x=!1,z=!1,C=!1,L=!1,P=!1,W=!1,ea=!1,ca=!1,oa=!1,wa=!1,ua=b&&M(b,1);b=ua&&Kf(ua);if((ua=ua&&Re(ua,2))&&b){for(var ya=Y_c(a),Xa=X_c(a),Wa=Z_c(a),Ra=W_c(a),wb=$_c(),Nc=a0c(),Rb=0,Sc=0;Sc<ya.length;Sc++)if(b==ya[Sc].code){Rb=ya[Sc].inputs;23==ya[Sc].code?(ca=!0,D_(a,
4)):(L=!0,D_(a,3));a.wb.yc(!!e);break}for(e=0;e<Xa.length;e++)if(b==Xa[e].code){Rb=Xa[e].inputs;a.$.Bf(e);D_(a,2);P=w=!0;break}for(e=0;e<Wa.length;e++)if(b==Wa[e].code){Rb=Wa[e].inputs;a.Ia.Bf(e);D_(a,0);W=x=!0;break}for(e=0;e<Ra.length;e++)if(b==Ra[e].code){Rb=Ra[e].inputs;a.Pa.Bf(e);D_(a,1);ea=z=!0;break}b==wb.code&&(Rb=wb.inputs,D_(a,5),oa=!0);b==Nc.code&&(Rb=Nc.inputs,D_(a,6),wa=!0);if(P||ea||W||L||ca||oa||wa)if(ea=p0c(a.D),P=ea.rect.kc(),W=ea.rect.gc(),ea=ea.fd+"",-1==Rb)wa&&0<ua.length&&(C=
!0,a.cb.yc(!0),a.Me.fb(pE(ua[0],ea,P,W)),1<ua.length&&a.Qe.fb(pE(ua[1],ea,P,W)));else if(0==Rb)m=pE(ua[0],ea,P,W),a.Hd.fb(m),m=!0;else if(1==Rb)q=pE(ua[0],ea,P,W),m=pE(ua[1],ea,P,W),a.Hd.fb(q),a.xg.fb(m),q=m=t=!0;else if(2==Rb)f=pE(ua[0],ea,P,W),a.Vc.fb(f),f=!0;else if(3==Rb)h=pE(ua[0],ea,P,W),f=pE(ua[1],ea,P,W),a.Vc.fb(h),a.rf.fb(f),h=f=t=!0;else if(7==Rb)k=pE(ua[0],ea,P,W),a.kd.fb(k),k=!0;else if(8==Rb)l=pE(ua[0],ea,P,W),k=pE(ua[1],ea,P,W),a.kd.fb(l),a.sf.fb(k),l=k=t=!0;else if(5==Rb){L=!0;wa=[];
for(Rb=0;Rb<ua.length;Rb++)wa.push(pE(ua[Rb],ea,P,W));a.C.fb(wa.join(","));a.C.resize()}else 6==Rb&&(ca=!0,wa=pE(ua[0],ea,P,W),null!=wa&&(wa=wa.substring(1),ua=!!NE(wa),wa=(Rb=PE(wa,a.Nj,!1,!0))?RE(Rb.rect,Rb.Vg):wa,ua||(wa=OE(wa)),a.Wa.fb(wa)));else a.F.Bf(0),ca=!0;Q(a.tc,t);a.$.setVisible(w);a.Ia.setVisible(x);a.Pa.setVisible(z);Q(a.H,f);Q(a.R,h);Q(a.O,m);Q(a.Ba,q);Q(a.L,k);Q(a.va,l);Q(a.Cb,C);Q(a.Kb,C);Q(a.Nb,!0);Q(a.ib,L);a.C.resize();Q(a.Ab,ca);null!=b&&h0c(a,b)}else{if(Xva){w=RI(a.Nj);x=w.Ic();
z=new sk;for(C=x.kc();C<x.Mc();C++)for(L=x.gc();L<x.Pc();L++)ca=w.Tf(C,L),""!=bF(ca)&&z.addAll(bF(ca).split(U_c));z.isEmpty()?w=!1:(i0c(a),a.C.fb(z.od().join(",")),D_(a,3),f0c(a),w=!0)}else w=!1;w||i0c(a)}a.sKa();c=c||"";w=c.lastIndexOf("</strong>");-1!=w&&(c=Za(Ta(c.substring(w+9))));a.Lb.yc(!!c);c&&(j0c(a)!=c&&a.Aka(),a.J.value=c,Q(a.Yb,!0));e0c(a,d)}
p.Oa=function(){this.gb=this.$a=this.va=this.L=this.Ba=this.O=this.R=this.H=null;H(this.C);this.Nb=this.wb=this.jb=this.J=this.tc=this.C=null;H(this.Wa);this.Wa=null;H(this.wb);this.wb=null;H(this.Pa);this.Pa=null;H(this.Ia);this.Ia=null;H(this.$);this.$=null;H(this.F);this.F=null;S_c.qa.Oa.call(this)};function v0c(a,b,c,d,e,f,h){Ms.call(this);this.Ab=a;this.Vc=b;this.tc=c;this.Jc=d;this.Ia=e;this.wb=f;this.Lb=h;this.R=new R(this.Aa());this.Qa(this.R);this.Kb=new Yu("",new AW,this.Aa());this.Qa(this.Kb);this.Cb=new R(this.Aa());this.Qa(this.Cb);this.cb=new qW(!1,"#4285f4");this.Qa(this.cb);this.Nb=new xW(c,w0c.ica,w0c.jca);this.Fa(this.Nb);this.F=this.O=null;this.jb=new Ti(this);this.Fa(this.jb);this.ib=this.L=this.J=this.C=null;this.gb=F(E(),"fedvs");this.Ba=null;this.Yb=[];this.Vb=-1;this.L=new Vs;
this.L.set("save","Save",!1);this.L.set("clear","Remove validation",!1,!1);this.L.set("cancel","Cancel",!1,!0);Ys(this,this.L);Us(this,!1);this.render();a=this.Pb();b=this.Aa();c=w0c;Ns(this,"Data validation");this.J||(d=b.Ha("DIV",{"class":c.tWa}),e=b.Ha("DIV",{"class":c.sWa},d),b.appendChild(a,e),this.J=new ou(e),this.J.setType("warning"),this.J.setContent(""),this.J.render(d),tHa(this.J,!0),this.J.setVisible(!1));this.gb&&(e=b.Ha("DIV",c.X0a),f=b.Ha("DIV",{id:x0c.lxa},"Suggested validations"),
d=b.Ha("DIV",c.W0a),h=b.Ha("DIV",c.qYa,"Send feedback"),b.appendChild(a,e),b.appendChild(e,h),b.appendChild(e,f),b.appendChild(a,d),this.Kb.kb(h),this.R.kb(d),e=b.Ha("DIV",c.K0a),b.appendChild(d,e),this.Cb.kb(e),this.cb.render(e),rW(this.cb,!0));this.O=b.Ha("TABLE",{cellSpacing:"0","class":c.nI},b.Ha("TBODY"));b.appendChild(a,this.O);this.gb&&ss(this.O,c.e1a);a=this.Pb();a=Qn(a);b=a.Ha("TR",w0c.u1a);b.appendChild(a.Ha("TD","waffle-dv-label",a.Ha("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));
c=a.Ha("TD",{colspan:"7"});this.C=b0c(this,c);y0c(this);b.appendChild(c);a.appendChild(this.O.childNodes[0],b);(a=this.C.Er())&&ks(a,"labelledby","waffle-dv-cell-range");this.F=new S_c(this,this.Ab,this.Ia);Ht(this,"save");z0c(this)}y(v0c,Ms);
var w0c={sWa:"waffle-input-error-butter-container",tWa:"waffle-input-error-butter-wrap",qYa:"waffle-dv-feedback-link",ica:"waffle-dv-highlight-styled-border",jca:"waffle-dv-highlight-styled-rect",wua:"waffle-input-error",K0a:"waffle-dv-rec-spinner-container",bda:"waffle-dv-rec-chip-selected",W0a:"waffle-dv-rec-wrapper",X0a:"waffle-dv-recs-title-bar",nI:"waffle-dv-table",e1a:"waffle-dv-table-with-suggestions",u1a:"waffle-dv-trrules"},x0c={lxa:"waffle-dv-recs-title"};p=v0c.prototype;p.Hl=0;
function y0c(a){if(a.C){var b=a.Ab.getActiveGrid();b&&(b=RE(lG(a.tc).Ic(),b.we()),a.C.fb(b))}}function z0c(a){a.jb.V(a,"dialogselect",a.TWb).V(a.F,"error",a.Bsb).V(a.F,"change",a.SWb);a.gb&&a.jb.V(a.wb,"recommender-calc-ended",a.RWb).V(a.Kb,"action",function(){O.Lu.mc({source:"dataValidationDialogFeedback"})})}p.Bsb=function(){A0c(this)};p.SWb=function(){A0c(this);at(this.L,"save",!0)};function B0c(a){var b=a.Aa();a=a.R.La;var c=S(R_c);b.appendChild(a,c)}
p.RWb=function(a){var b=this;rW(this.cb,!1);Q(this.Cb.La,!1);a=a.C;if(0==a.length)B0c(this);else{var c=this.Aa(),d=this.R.La,e=0;A(a,function(a){var f=M(a,13);if(!(3<=e)&&f){e++;var k=BU(a),l=RE(vl(k)),m=M(f,3);b.Yb.push(m);a="";switch(Kf(m)){case 14:a="Is valid email";break;case 15:a="Is valid URL";break;case 30:a="Is valid date";break;case 24:a=Re(m,2).map(function(a){return M(M(a,5).bb(),2)}).join();break;case 1:a="Greater than "+M(M(Re(m,2)[0],5).bb(),3);break;case 7:a=Re(m,2);a="Between "+(M(M(a[0],
5).bb(),3)+(" and "+M(M(a[1],5).bb(),3)));break;default:Kbc.C("Unrecognized data validation type.")}a=S(Q_c,{description:a,DPb:l});var q=new gv("",c);q.vf(8,!0);q.kb(a);ks(a,"describedby",x0c.lxa);b.R.Qa(q);c.appendChild(d,a);b.jb.V(q,"action",function(){C0c(b,q,m,l)}).V(a,"mouseenter",function(){yW(b.Nb,wU(k))}).V(a,"mouseleave",function(){zW(b.Nb)})}})}};
function C0c(a,b,c,d){var e=w0c,f=rs(b.La,e.bda);a.R.Ff(function(a){a.Hk(e.bda,!1);a.Fc(!1)});b.Hk(e.bda,!f);b.Fc(!f);f?(a.show(!0),a.Ba=null):(b=new Mf,N(b,1,c),u0c(a.F,b,null,null,!0),n0c(a.F),a.C.fb(d),a.Ba=c)}p.TWb=function(a){if("save"==a.key){if(!D0c(this)){a.preventDefault();return}}else{var b;if(b="clear"==a.key)(b=E0c(this))?(this.Lb.Xb(35300),b=this.Jc.C(new uT(new Nf,b))):b=!1,b=!b;if(b){a.preventDefault();return}}this.C&&this.C.eb(!1)};
function A0c(a){var b=F0c(a.Hl);b&&a.J.setContent(b);a.J.setVisible(0!=a.Hl);b=2==a.Hl||4==a.Hl;var c=w0c,d=a.Aa().Uw(a.C.getElement());ws(d,c.wua,b);b&&a.C.Er().select()}
function F0c(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid checked value.";case 9:return"Enter different values for checked and unchecked cell contents.";case 10:return"Formulas are not permitted as custom checked/unchecked values."}return null}
function G0c(a){var b=a.F,c=B_(b);if(0==c){c=b.L;var d=b.va,e=o0c(b,c),f=o0c(b,d);e&&f?b.D.Hl=0:(e||A_(c),f||A_(d),b.D.Hl=1)}else if(1==c)c=b.O,d=b.Ba,e=!Lr(c)||!Qa(fb(c.value)),f=!Lr(d)||!Qa(fb(d.value)),e&&f?b.D.Hl=0:(e||A_(c),f||A_(d),b.D.Hl=6);else if(2==c)c=b.H,d=b.R,e=!Lr(c)||!Qa(fb(c.value)),f=!Lr(d)||!Qa(fb(d.value)),e&&f?b.D.Hl=0:(e||A_(c),f||A_(d),b.D.Hl=7);else if(3==c||4==c)c=0,4==B_(b)?(d=t0c(b),DU(b.Vb,d)?(d=t0c(b),d=EU(b.Vb,d),e=p0c(b.D),d&&e&&d.fd==e.fd&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==B_(b)&&b.C.getElement()&&Qa(fb(b.C.bb()))&&(c=5),d=c,c=0==d,b.D.Hl=d,d=b.Ab&&Lr(b.Ab),b.ib&&Lr(b.ib)?(ws(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.Aa().Uw(b.Wa.getElement()),ws(d,"waffle-input-error",!c),b.Wa.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.cb.isChecked()){c=b.$a;e=b.gb;d=Ta(fb(c.value));e=Ta(fb(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==e.toLowerCase();
var h=mb(d)==mb(e);f=d==e||h||f;Qa(d)?(A_(c),b.D.Hl=8):f?b.D.Hl=9:Ax(d)||Ax(e)?b.D.Hl=10:b.D.Hl=0}}else b.D.Hl=0;b=a.C.bb();b=DU(a.Ia,b);2==a.Hl&&b?a.Hl=0:0!=a.Hl||b||(a.Hl=2);A0c(a);return 0!=a.Hl}
function D0c(a){if(G0c(a))return!1;var b=a.F,c=b.yd.isChecked("rejectInvalidData_radio"),d=j0c(b);b.Lb.isChecked()||(d="");var e=s0c(b);if(!e)return!1;var f=new Nf;N(f,1,e);N(f,2,d);N(f,3,c);Cqc(f,Lr(b.Nb)&&b.wb.isChecked());b=E0c(a);if(!b)return!1;c=new qq;e=M(e,1);d=a.Ba&&Kf(a.Ba)==Kf(e);var h=Re(e,2);if(d){var k=Re(a.Ba,2);k=k.length==h.length&&k.every(function(a,b){return a.equals(h[b])});D(c,12,!k);Pqc(c,pxc(Kf(e)))}k=ja(a.Yb);for(var l=k.next();!l.done;l=k.next())HYc(c,pxc(Kf(l.value)));k=Ha()-
a.Vb;D(c,14,1E3*k);k=new oq;bd(k,58,c);c=Uq(ar(new Tq,k),1).build();a.Lb.Xb(d?35578:35301,c);31==Kf(e)&&a.Lb.Xb(0<h.length?35604:35603,c);return a.Jc.C(new uT(f,b))}function E0c(a){var b=a.C.bb();b=(b=EU(a.Ia,b))?b.rect:null;var c=a.C.bb();a=(a=EU(a.Ia,c))?a.fd:null;return b&&null!=a?tl(b,a):null}function p0c(a){var b=a.C.bb();return EU(a.Ia,b)}
function b0c(a,b){var c=a.Ab.C.we();c=new pV(a.tc,v(a.QWb,a),!1,"e.g., Sheet1!A2:D5",!0,c,a.Aa());a.getHandler().V(c,"change",function(){var a=this.F;a&&m0c(a)});c.render(b);return c}p.setVisible=function(a){v0c.qa.setVisible.call(this,a);a&&this.ib&&(this.ib.focus(),this.ib=null)};p.QWb=function(a,b,c,d){this.ib=a.Er();this.Vc.mba(this,a,b,c,!1,!0,d)};
p.show=function(a){var b="",c=!1,d=RI(this.Ab),e=SF(d);e=fF(MF(d,e));d=null;var f=!1;e&&(e=e.C,d=M(e,1),b=M(e,2),c=M(e,3),f=M(e,4));u0c(this.F,d,b,c,f);this.setVisible(!0);this.C&&this.C.eb(!0);y0c(this);n0c(this.F);this.gb&&!a&&(tqc(this.wb)?(Xqc(this.wb),grc(this.wb,!0,!1,[6])):(rW(this.cb,!1),Q(this.Cb.La,!1),B0c(this)));this.Vb=Ha()};p.Oa=function(){H(this.F);this.F=null;H(this.C);this.L=this.O=this.C=null;v0c.qa.Oa.call(this)};function H0c(a,b,c,d,e){Ms.call(this);this.Jc=d.O;this.ib=c;this.wb=d.C;this.cb=d;this.Yb=e;this.jb=null;this.Lb=d.R;Ns(this,"Find and replace");Us(this,!1);c=this.Pb();d=Qn(c);this.C=d.Ha("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.Ia=d.Ha("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new yM(null);this.Vc=b;this.O=new pV(this.ib,v(this.xXb,this),!1,"",!0);this.R=null;this.Ba=new ju;this.gb=new ju;this.L=new ju;this.J=new ju;this.Vb=this.Cb=this.Kb=
this.Nb=!1;this.Ab=d.Ha("SPAN");Rsc(this.Ab);this.tc=new It(this.C);this.Fa(this.tc);a=I0c;d.Ha("LABEL",{"for":a.$ta},"Search");b=d.Ha("LABEL",{"for":a.bva},"Match case");e=d.Ha("LABEL",{"for":a.cva},"Match entire cell contents");var f=d.Ha("LABEL",{},"Also search within formulas"),h=d.Ha("LABEL",{"for":a.Iwa},"Search using regular expressions "),k=(new Uj(Hva)).toString(),l=d.Ha("SPAN",null,d.Ha("A",{target:"_blank",href:k},"Help"));this.getHandler().V(l,["keydown","keypress"],function(a){13==a.keyCode&&
a.stopPropagation()});k=Ur(this,"findLabel");var m=Ur(this,"replaceLabel"),q=Ur(this,"findScopeLabel"),t=d.Ha("DIV","goog-inline-block"),w=d.Ha("DIV",a.k0a);l=d.Ha("TABLE",null,d.Ha("TBODY",null,d.Ha("TR",null,d.Ha("TD",a.LABEL,d.Ha("LABEL",{id:k},"Find")),d.Ha("TD",null,this.C)),d.Ha("TR",null,d.Ha("TD",a.LABEL,d.Ha("LABEL",{id:m},"Replace with")),d.Ha("TD",null,this.Ia)),d.Ha("TR",null,d.Ha("TD",null,d.Ha("LABEL",{id:q},"Search")),d.Ha("TD",null,t,w)),d.Ha("TR",null,d.Ha("TD",null,""),d.Ha("TD",
null,b,d.Ha("BR"),e,d.Ha("BR"),h,l,d.Ha("BR"),f)),d.Ha("TR",null,d.Ha("TD",{colspan:"2"},this.Ab))));this.F.render(t);ss(this.F.getElement(),a.$ta);this.O.render(w);Tr(this.Ba,b);St(this.Ba,b);this.Ba.getElement().id=a.bva;Tr(this.gb,e);St(this.gb,e);this.gb.getElement().id=a.cva;Tr(this.L,h);St(this.L,h);this.L.getElement().id=a.Iwa;St(this.J,f);Tr(this.J,f);ks(this.C,"labelledby",k);ks(this.Ia,"labelledby",m);ks(this.F.La,"labelledby",q);d.appendChild(c,l);c=new Vs;c.set("findNext","Find",!0);c.set("replace",
"Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);Ys(this,c);Ht(this,"");this.getHandler().V(this,"dialogselect",this.yXb).V(this.tc,"input",this.Kla).V(this.L,"change",this.jAb).V(this.F,"change",this.Bqb).V(this.O,"change",this.zXb).V(this.J,"change",this.kAb);c=new Jt;c.kb(this.C);this.Fa(c);c=new Jt;c.kb(this.Ia);this.Fa(c);J0c(this);c=new zs(this.getElement());this.Fa(c);this.getHandler().V(c,"focusin",this.ZUa).V(this.getElement(),"mousedown",this.ZUa)}y(H0c,Ms);
var I0c={Lsa:"waffle-find-replace-dialog-border",$ta:"waffle-find-replace-find-scope-select",wua:"waffle-input-error",LABEL:"waffle-find-replace-dialog-label",bva:"find-replace-case",cva:"find-replace-cell",Iwa:"find-replace-regex",k0a:"waffle-find-replace-selection-input goog-inline-block"};
function J0c(a){var b=lG(a.ib),c=null,d=null;b&&(c=mvb(b),d=SC(a.wb,c.fd).we());a.J.yc(a.Lb);var e=new yt("All sheets",nSa.TVa),f=new yt("This sheet",nSa.s0a),h=new yt("Specific range",nSa.hI);a.F.Fd(e);a.F.Fd(f);a.F.Fd(h);f=c?qH(a.wb,c.fd):null;f=(f=c&&f?rF(f,c.rect.kc(),c.rect.gc()):null)?f.wh():1;c&&c.rect.wh()>f?Uv(a.F,h):Uv(a.F,e);b&&a.O.fb(RE(c.rect,d))}function K0c(a){var b=a.F.hf().hb(),c=qG(a.ib.C);return 0==b?PE(a.O.bb(),a.wb,!1,!0):1!=b||null===c?null:new hl(c,"",new Lk(0,0,1,1))}p=H0c.prototype;
p.ZUa=function(a){a.target==this.getElement()?this.focus():this.Yb.Mb(2)};p.zXb=function(){L0c(this)};p.kAb=function(){var a=this.J.isChecked();N7b(this.cb,a)};p.Bqb=function(){L0c(this)};p.jAb=function(){this.L.isChecked()&&this.Ba.yc(!0);this.Kla()};
p.yXb=function(a){var b=M0c;if("findNext"==a.key)a.preventDefault(),this.Nb&&(E_(this,null),N0c(this,b.Zta));else if("replace"==a.key)a.preventDefault(),this.Kb&&(E_(this,null),N0c(this,b.Uva));else if("replaceAll"==a.key&&(a.preventDefault(),this.Vb)){a=v(function(){E_(this,null);N0c(this,b.Tva)},this);var c=this.F.hf().hb();1<this.wb.D.length&&2==c&&!this.Cb?(qqc("Replace in all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.Cb=!0):a()}};
p.Kla=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;Zs(this.D,"findNext").disabled=!a;this.Nb=a;O0c(this,a);this.Kb&&!a&&P0c(this,!1);ws(this.C,"waffle-input-error",b)};p.xXb=function(a,b,c){this.jb=a.Er();this.Vc.mba(this,a,b,c,!1,!0)};
function L0c(a){var b=0==a.F.hf().hb();a.O.setVisible(b);H(a.R);a.R=null;var c=K0c(a),d=lG(a.ib);b&&d&&c&&(a.R=OM(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.R.setVisible(!0),a.Fa(a.R))}function N0c(a,b){if(0!=a.F.hf().hb()||K0c(a)){var c=a.F.hf().hb();a.dispatchEvent(new Q0c(b,a.C.value,a.Ia.value,c,a.Ba.isChecked(),a.gb.isChecked(),a.L.isChecked(),a.J.isChecked(),K0c(a)))}else ws(a.O.D,"waffle-range-selection-error",!0),E_(a,"Invalid range")}
p.setVisible=function(a){var b=this.cb.vd();O0c(this,!b);P0c(this,!b);this.Ia.disabled=b;H0c.qa.setVisible.call(this,a);a&&this.jb&&(this.jb.focus(),this.jb=null)};p.ZRb=function(a){this.C.value=a};p.uRa=function(){this.C.select()};p.focus=function(){this.Wb()&&this.isVisible()&&(this.C.focus(),this.Yb.Mb(2),fx(this.C,this.C.value.length),this.Kla())};function P0c(a,b,c){b=b&&!a.cb.vd()&&0==!a.C.value.length;a.Kb=b;a=Zs(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function O0c(a,b){var c=!!xb(O5a(a.Jc),function(a){return!a.Pj()});b=b&&!a.cb.vd()&&!c&&0==!a.C.value.length;a.Vb=b;a=Zs(a.D,"replaceAll");a.disabled=!b;c&&(a.title="This is disabled because there are protected cells in this spreadsheet.")}function E_(a,b){var c=Qn(a.Pb());a=a.Ab;b?(0<to(a).length&&c.appendChild(a,c.Ha("BR")),c.appendChild(a,c.Ha("B",null,Mo(c,b)))):c.Cd(a)}p.Oa=function(){H0c.qa.Oa.call(this);this.Cb=!1;N7b(this.cb,this.Lb)};
function Q0c(a,b,c,d,e,f,h,k,l){I.call(this,a);this.F=b;this.J=c;this.C=d;this.L=e;this.R=f;this.$=h;this.Pa=k;this.Wa=l||null}y(Q0c,I);var M0c={Zta:"findnext",ncc:"findall",Uva:"replace",Tva:"replaceall",DONE:"done",G4b:"canceled"};function R0c(a,b,c,d,e){G.call(this);var f=M0c;this.H=null;this.C=a;this.D=b;this.F=c;this.O=d;this.L=e;this.J=new Ti(this);this.Fa(this.J);this.J.V(a,f.Tva,this.rzb).V(a,f.Uva,this.szb).V(a,f.Zta,this.YUa).V(a,f.DONE,this.Fob)}y(R0c,G);var F_={oN:"cg",pN:"cr",nN:"cc",Yta:"loop"};p=R0c.prototype;p.dUb=function(){this.C.setVisible(!0);S0c(this,null)};p.YUa=function(a){if(mG(this.D.C)){var b=lG(this.D).hb(),c=this.H;c||(c=SF(b),c=tc(F_.oN,b.fc(),F_.pN,fG(b,c.y),F_.nN,gG(b,c.x)));T0c(this,a,b,c)}};
function T0c(a,b,c,d){var e=new kl,f=U0c(b);V0c(f,c,d);c=e.serialize(f);a=v(function(a){var c=e.jd((new pB).Na(),a);a=M(f,1);var d=b.type;mG(this.D.C)&&(c?Me(c,1)?(d=M(c,1),c=tc(F_.oN,parseInt(d.Jb(),10),F_.pN,d.kz(),F_.nN,d.getColumnIndex(),F_.Yta,M(c,2)),W0c(this,a,c)):(W0c(this,a,{}),"replace"==d&&this.C.focus()):X0c(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function V0c(a,b,c){if(c){var d=""+c[F_.oN],e=new Pf;N(e,1,d);N(e,2,cG(b,c[F_.pN],"r"));N(e,3,cG(b,c[F_.nN],"c"));N(a,10,e)}}
function U0c(a){var b=new nB;N(b,1,a.F);N(b,3,a.J);N(b,5,a.C);if(0==a.C||1==a.C){var c=a.Wa,d=new yf;N(d,1,""+c.fd);var e=c.rect.kc();N(d,2,e);zf(d,c.rect.Mc());Af(d,c.rect.gc());Bf(d,c.rect.Pc());b.setSelection(d)}N(b,6,a.L||!1);N(b,7,a.R||!1);N(b,8,a.$||!1);b.setType(a.Pa?1:0);N(b,11,0);return b}function W0c(a,b,c){c?c&&null!=c.cg?(b=c[F_.oN],c[F_.Yta]&&E_(a.C,"No more results found, looping around"),a.F.sA(b,v(a.wXb,a,c))):(S0c(a,null),E_(a.C,"There are no entries matching "+b)):X0c(a)}
p.wXb=function(a){var b=lG(this.D).hb(),c=a[F_.pN],d=a[F_.nN];a[F_.pN]=fG(b,c);a[F_.nN]=gG(b,d);S0c(this,a);a=new Ak(d,c);b=new hl(b.fc(),"",Tk(a));FU(this.F,b,v(this.x2a,this,a))};
p.x2a=function(a){if(!this.isDisposed()){this.C.focus();var b=lG(this.D).hb();cF(b.Tf(a.y,a.x))&&!this.C.J.isChecked()&&P0c(this.C,!1,"Can't replace formula");var c=tF(b,a.y),d=uF(b,a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=QE(a),a=bF(MF(b,a)),E_(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function X0c(a){E_(a.C,null);E_(a.C,"Error while searching spreadsheet. Please try again.")}
p.szb=function(a){if(!this.L.vd()){var b=this.H;if(b){var c=UE(this.F,b[F_.oN]);if(c){c=c.Kc();var d=cG(c,b[F_.pN],"r"),e=cG(c,b[F_.nN],"c"),f=c.Tf(d,e);if(!cF(f)||this.C.J.isChecked()){f=bF(f);var h=new kl,k=U0c(a);N(k,5,0);V0c(k,c,b);var l=new yf;N(l,1,""+b[F_.oN]);N(l,2,d);zf(l,d+1);Af(l,e);Bf(l,e+1);k.setSelection(l);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);Y0c(this,c,k,f,b,!1);this.YUa(a)}}}}};
p.rzb=function(a){if(!this.L.vd()&&mG(this.D.C)){var b=this.F.getActiveGrid().Kc(),c=U0c(a);Y0c(this,b,c,a.F,a.J,!0)}};
function Y0c(a,b,c,d,e,f){b=new cX(b,c);bB(b,v(function(a,b){a?(a=M(b,5),b=M(b,4),b=0==a?"No matches found":f?(new Ip(1==b?"{NUM_CHANGED, plural,=0 {unused plural form}=1 {Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other {Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS, plural,=0 {unused plural form}=1 {unused plural form}other {Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:d,
NEW_VALUE:e}):'Replaced "'+(d+('" with "'+(e+'"'))),E_(this.C,null),E_(this.C,b)):X0c(this)},a));E_(a.C,null);E_(a.C,"Working...");a.O.C(b)||X0c(a)}p.Fob=function(){S0c(this,null)};function S0c(a,b){a.H=b;(a=a.C)&&P0c(a,!!b)};function G_(a,b){Ms.call(this,"docs-material-dialog",a,b);Ys(this,null);Xs(this,!0);Ts(this,this.wJ?0:.6);this.L=new DW("Ok");this.Qa(this.L);this.O=new txc("Cancel");this.Qa(this.O)}r(G_,Ms);G_.prototype.Ra=function(){var a=this;Ms.prototype.Ra.call(this);this.getHandler().V(this.L,"action",function(){return a.J()}).V(this.O,"action",function(){a.dispatchEvent("qe")&&a.setVisible(!1)})};G_.prototype.J=function(){this.dispatchEvent("pe")&&this.setVisible(!1)};
G_.prototype.Ha=function(){Ms.prototype.Ha.call(this);var a=Rs(this);this.O.render(a);this.L.render(a);Q(a,!0);Ot(iFa(this),vxc)};G_.prototype.vz=function(a){Ms.prototype.vz.call(this,a);Ts(this,this.wJ?0:.6)};function Z0c(a,b,c){G_.call(this);Ns(this,"Grouping rule");this.Ba=a;this.cb=b;this.Ia=c;this.R=new $0c("Starting at",!0);this.Qa(this.R,!0);this.F=new $0c("Create group by",!1);this.Qa(this.F,!0);this.C=new $0c("Ending at",!0);this.Qa(this.C,!0);(a=this.Ba.C.getActiveGrid())&&(a=kG(a.Kc()))&&(a=a1c(this,a))&&Me(a,10)&&Me(M(a,10),3)&&(a=M(M(a,10),3),Me(a,1)&&(b=M(a,1),this.R.D.fb(UW.format(b))),Me(a,2)&&(b=M(a,2),this.F.D.fb(UW.format(b))),Me(a,3)&&(a=M(a,3),this.C.D.fb(UW.format(a))))}r(Z0c,G_);
Z0c.prototype.J=function(){var a=b1c(this.R),b=b1c(this.F),c=b1c(this.C);if(isNaN(a)||isNaN(b)||isNaN(c))var d=!1;else 0>=b?(ZU(this.F.C,"Must be greater than 0",!0),d=!1):null!=a&&null!=c&&a>=c?(ZU(this.C.C,"End must be greater than start",!0),d=!1):d=!0;if(d){d=new rg;d.setType(2);var e=new ug;null!=a&&N(e,1,a);null!=b&&N(e,2,b);null!=c&&N(e,3,c);N(d,3,e);if(a=this.Ba.C.getActiveGrid())if(a=a.Kc(),b=kG(a))if(c=a1c(this,b))N(c,10,d),this.cb.C(new fL(b,a));G_.prototype.J.call(this)}};
function a1c(a,b){b=IYc(b,function(b){return M(b,1)==a.Ia});if(0==b.length)return null;if(1==b.length)return b[0];if(2==b.length)return Me(b[0],10)?b[0]:b[1]}function $0c(a,b,c){R.call(this,c);this.D=new Exc;this.D.setContent(a);this.Qa(this.D,!0);this.F=b;this.C=new YU(this.Aa(),!0);this.Fa(this.C)}r($0c,R);$0c.prototype.Ra=function(){R.prototype.Ra.call(this);this.C.render();this.C.sj(this.D.La);aV(this.C,this.D.Ed().sL(this.D.La))};
function b1c(a){$U(a.C);var b=a.D.bb();if(Qa(b)){if(a.F)return null;ZU(a.C,"Required",!0);return NaN}b=UW.parse(b);isNaN(b)&&ZU(a.C,"Must be a number",!0);return b};function c1c(a){a=""+(""+d1c({id:"waffle-resize-selection-custom",xMa:a.$fa,bl:$t("<br/>"+T(XYc({id:"waffle-resize-input",xd:"waffle-resize-inset-input"})))})+d1c({id:"waffle-resize-selection-auto",xMa:Zt("Fit to data"),bl:$t("")})+"");return U(a)}function d1c(a){return U('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+V(a.id)+'"><label for="'+V(a.id)+'" class="waffle-resize-label">'+T(a.xMa)+"</label>"+T(a.bl)+"</div>")}
function e1c(a){var b=a.Ocb;a='<label for="waffle-resize-input">'+T(a.$fa)+'</label><br/><br/><input id="waffle-resize-input"/>';b&&(a+='<br/><br/><span class="waffle-resize-dialog-checkbox"><span id="waffle-resize-rows-can-grow-checkbox">Allow row heights to grow automatically to fit cell contents.</span></span>');return U(a+"")};function f1c(a,b,c,d,e){Ms.call(this);this.L=a;this.Ia=b;var f=this.L.Ic().dd();this.C=f;this.F=rb(this.L.Fj(),function(a){return a.dd()==f});this.J=new zS;this.O=new qAc(!0);this.R=new ju;this.cb=c;this.gb=d;this.Ba=e}y(f1c,Ms);var g1c={AUTO:"waffle-resize-selection-auto",gt:"waffle-resize-selection-custom",kca:"waffle-resize-input",g_a:"waffle-resize-selection",e0a:"waffle-resize-rows-can-grow-checkbox"};p=f1c.prototype;
p.Ha=function(){f1c.qa.Ha.call(this);var a=this.F[0];if("r"==this.C){var b=a.kc();a=a.Mc()-1;var c=String(IE(b+1)),d=String(IE(a+1));b=1<this.F.length?"Resize selected rows":b==a?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else b=a.gc(),a=a.Pc()-1,c=KE(b),b=1<this.F.length?"Resize selected columns":b==a?"Resize column "+c:"Resize columns "+(c+(" - "+KE(a)));Ns(this,b);"r"==this.C?this.Pb().appendChild(S(e1c,{$fa:h1c(this),Ocb:F(E(),"fefrha")})):this.Pb().appendChild(S(c1c,{$fa:h1c(this)}));Ht(this,
"ok")};p.Ra=function(){f1c.qa.Ra.call(this);var a=this.Aa(),b="r"==this.C;this.J.kb(a.getElement(g1c.kca));F(E(),"fefrha")&&b&&(a=a.getElement(g1c.e0a),St(this.R,a),Tr(this.R,a));a=this.L.Ic();var c=a.dd();a=S0a(KF(this.L,c,$k(a,c)));this.J.fb(String(a));b||(rAc(this.O,g1c.g_a),sAc(this.O,g1c.gt));this.getHandler().V(this,"dialogselect",this.RYb).V(this.J.getElement(),"focus",this.cEb)};p.cEb=function(){"c"==this.C&&sAc(this.O,g1c.gt)};p.focus=function(){this.Wb()&&DS(this.J)};
function h1c(a){return"r"==a.C?"Enter new row height in pixels. (Default: "+(FF+")"):"Enter new column width in pixels. (Default: "+(T0a+")")}
p.RYb=function(a){if("ok"==a.key)if((a="r"==this.C)||tAc(this.O)==g1c.gt){var b=parseInt(this.J.bb(),10);isNaN(b)?XA("Entered value is not a number."):2>b||2E3<b?XA("Size must be between 2 and 2000 pixels."):(this.Ba.C("r"==this.C?35310:35308),b=new sP(this.L,this.F[0],b,this.F.slice(1)),F(E(),"fefrha")&&a&&(a=!this.R.isChecked(),b.L=a),this.Ia.C(b))}else b=lG(this.cb).$,a=b.H,b=F(E(),"fecllr")?b.D:null,this.Ba.C(35307),bFb(this.F,a,b,this.gb,this.Ia)};function i1c(a){Wc(this,a,0,-1,null,null)}y(i1c,Vc);i1c.prototype.getType=function(){return B(this,3)};i1c.prototype.setType=function(a){D(this,3,a)};function j1c(a){R.call(this,a);this.$=ep("email");this.C=this.D=null}y(j1c,R);p=j1c.prototype;
p.Ha=function(){var a=this.Aa();var b=this.Aa();this.C=new TV;this.Fa(this.C);this.D=new TV;this.Fa(this.D);var c=b.Ha("DIV","waffle-dialog-notifications-input");js(c,"presentation");this.F=new RV;SV(this.F,b.Ha("LABEL",null,"Any changes are made"));this.F.render(c);this.C.vG(this.F);var d=b.Ha("DIV","waffle-dialog-notifications-input");js(d,"presentation");this.J=new RV;SV(this.J,b.Ha("LABEL",null,"A user submits a form"));this.J.render(d);this.C.vG(this.J);var e=b.Ha("DIV","waffle-dialog-notifications-input");
js(e,"presentation");this.H=new RV;SV(this.H,b.Ha("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.vG(this.H);var f=b.Ha("DIV","waffle-dialog-notifications-input");js(f,"presentation");this.L=new RV;SV(this.L,b.Ha("LABEL",null,"Email - right away"));this.L.render(f);this.D.vG(this.L);b=b.Ha("DIV",null,b.Ha("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.$+" when...")),b.Ha("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.$+" when...")},c,d),b.Ha("DIV",{style:"padding: 5px"}),
b.Ha("DIV","waffle-dialog-notifications-label","Notify me with..."),b.Ha("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.Aa();d=c.Ha("DIV");this.O=mS("Save",c);this.Qa(this.O,!1);this.O.render(d);this.R=new gv("Cancel",c);this.Qa(this.R,!1);this.R.render(d);this.La=a.Ha("DIV","waffle-dialog-notifications",a.Ha("DIV",null,b),a.Ha("DIV",null,d))};
p.Ra=function(){j1c.qa.Ra.call(this);this.getHandler().V(this.O,"action",this.hRb,!0).V(this.R,"action",v(this.dispatchEvent,this,new I("cancelRuleEdit"))).V(this.C,"change",this.ura).V(this.D,"change",this.ura)};p.ud=function(a){j1c.qa.ud.call(this,a);a?1==a.getType()?UV(this.C,this.F):2==a.getType()&&UV(this.C,this.J):UV(this.C,null);a?2==B(a,2)?UV(this.D,this.H):1==B(a,2)&&UV(this.D,this.L):UV(this.D,null);this.ura()};p.focus=function(){var a=VV(this.C),b=this.C.C.Te(0);(a||b).getElement().focus()};
p.setVisible=function(a){this.getElement()&&Q(this.getElement(),a)};p.hRb=function(){this.dispatchEvent(new I("saveRule",k1c(this)))};function k1c(a){var b=new i1c,c=a.hb();c&&(c=B(c,1),D(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?D(b,2,1):a.H.isChecked()&&D(b,2,2);return b}p.ura=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.eb(a)};function H_(a,b){R.call(this,b);this.ud(a)}y(H_,R);
H_.prototype.Ha=function(){var a=this.hb(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==B(a,2)?c+="send digest email":1==B(a,2)&&(c+="send email");c="If "+(b+(" then "+c));var d=this.Aa();a=d.Ha("TD",null);b=d.Ha("TD",{width:"50px"});c=d.Ha("TR",{valign:"center"},d.Ha("TD",null,d.Ha("SPAN","waffle-notification-rule",c)),d.Ha("TD",{align:"right"},d.Ha("TABLE",null,d.Ha("TBODY",null,d.Ha("TR",null,a,b)))));d=ht(Wu,"waffle-notifications-add");this.D=new Yu("Edit",
d,this.Aa());this.D.bf("goog-link-button");this.D.bf("menuMainLink");this.Qa(this.D,!1);this.D.render(a);this.C=new Yu("Delete",d,this.Aa());this.C.bf("goog-link-button");this.C.bf("menuMainLink");this.Qa(this.C,!1);this.C.render(b);this.La=c};H_.prototype.Ra=function(){H_.qa.Ra.call(this);this.getHandler().V(this.D,"action",this.H);this.getHandler().V(this.C,"action",this.F)};H_.prototype.H=function(){this.dispatchEvent(new I("edit",this.hb()))};
H_.prototype.F=function(){var a=v(function(){this.dispatchEvent(new I("del",this.hb()))},this),b=v(function(){this.C.getElement().focus()},this);O_c("Are you sure you want to delete this notification rule?",a,void 0,void 0,b)};function l1c(a){R.call(this,a);this.C=null}y(l1c,R);l1c.prototype.Ha=function(){var a=this.Aa();this.C=a.Ha("TBODY");this.La=a.Ha("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C)};l1c.prototype.Pb=g("C");l1c.prototype.setVisible=function(a){this.getElement()&&Q(this.getElement(),a)};function m1c(a,b,c){Ms.call(this);this.Ba=a;this.L=b;Ns(this,"Set notification rules");Us(this,!1);a=new Vs;a.set("cancel","Done",!1,!0);Ys(this,a);this.C=new j1c(c);this.Qa(this.C,!1);this.F=new l1c;this.Qa(this.F,!1);this.J=new Yu("Add another notification rule",OO.getInstance(),this.Aa());this.Qa(this.J,!1)}y(m1c,Ms);p=m1c.prototype;
p.Ha=function(){m1c.qa.Ha.call(this);var a=this.Aa(),b=R9a(this.Ba,new Uj(Dva+"91588")).toString();b=a.Ha("A",{target:"_blank",href:b},"Help");var c=a.Ha("DIV");this.J.render(c);this.R=a.Ha("DIV");this.O=a.Ha("DIV");var d=a.Ha("DIV","waffle-dialog-notifications-bounds",this.R,this.O);b=a.Ha("DIV",null,a.Ha("DIV",{align:"right"},b),d,c);a.appendChild(this.Pb(),b);Ht(this,"")};
p.Ra=function(){m1c.qa.Ra.call(this);this.F.render(this.R);this.C.render(this.O);this.getHandler().V(this,"edit",this.$Yb).V(this,"del",this.ZYb).V(this.J,"action",this.YYb).V(this,"saveRule",this.gRb).V(this,"cancelRuleEdit",this.V3a)};p.$Z=function(a){this.isDisposed()||(this.C.setVisible(!1),n1c(this,!1),Fm(this.L,"/notifications/list",v(this.oVb,this,a)).ye())};
p.oVb=function(a,b,c){if(!this.isDisposed()){b=c.Ye();c=[];for(var d=0;d<b.length;d++)c[d]=new i1c(b[d]);this.ud(c);if(a&&0==c.length)o1c(this,null,!1);else{if(a=this.hb())if(b=this.F,b.Cd(!0),b.Aa().Cd(b.Pb()),b.ud(a),c=b.Aa(),0==a.length)c.appendChild(b.Pb(),c.Ha("TR",null,c.Ha("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Qa(new H_(a[d],c),!0);n1c(this,!0);this.focus()}}};
p.gRb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();B(a,1)?Jm(Fm(this.L,"/notifications/set",v(this.$Z,this,!1)),{rule:b}).ye():Jm(Fm(this.L,"/notifications/create",v(this.$Z,this,!1)),{rule:b}).ye()};p.V3a=function(){this.C.setVisible(!1);this.$Z(!1)};p.$Yb=function(a){o1c(this,a?a.target:null,!0)};p.YYb=function(){o1c(this,null,!0)};function o1c(a,b,c){n1c(a,!1);var d=a.C;d.ud(b);d.setVisible(!0);c&&a.C.focus()}
p.ZYb=function(a){this.F.setVisible(!1);a=a.target;Jm(Fm(this.L,"/notifications/delete",v(this.$Z,this,!1)),{rule_id:B(a,1)}).ye()};function n1c(a,b){a.F.setVisible(b);var c=Rs(a);Q(c,b);a.J.setVisible(b)}p.show=function(){this.setVisible(!0);this.$Z(!0)};function p1c(a){var b="",c='Display language: <a id="ds-settings-link" target="_blank">'+(T(a.Z5a)+"</a>");b+='<tr class="dialog-settings-general-settings-div"><div><span>'+c+"</span></div>";a.bTb&&(b+='<div class="dialog-settings-english-name-div">'+T(iu({id:"waffle-settings-dialog-english-name-checkbox"}))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">Always use English function names</label></div>');return U(b+"</tr>")}
function q1c(){return U('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function I_(a,b,c,d){Ms.call(this);this.Nb=a;this.Vc=b;this.L=c;this.tc=d;this.C={};this.Kb=this.wb=!1;this.Yb=this.Lb=this.Cb="";this.Jc=new kl;this.J=[];this.F=this.Jc.jd((new Kh).Na(),ritz_api.RitzModelApi.getWorkbookProperties());Ns(this,"Settings for this spreadsheet");this.jb=!1;this.gb=new ju;this.Qa(this.gb);this.R=new YU;this.Qa(this.R);this.O=new YU;this.Qa(this.O);this.Ab=new mV;this.Qa(this.Ab);this.cb=this.ib=null;this.Vb=new Bp(1);this.Ba=this.Ia="";this.C[0]=y_();this.C[1]=y_();this.C[2]=
y_();this.C[3]=y_();this.C[4]=new zS;this.C[5]=new zS}y(I_,Ms);var r1c=null,s1c={S1:0,l1a:1,dWa:2,jZa:3,xZa:4,cXa:5},t1c={K1a:"waffle-settings-dialog-english-name-checkbox",L1a:"waffle-settings-dialog-english-name-checkbox-label"},u1c=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],v1c=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];p=I_.prototype;
p.Ha=function(){I_.qa.Ha.call(this);var a=this.Pb(),b=this.Aa(),c=[w1c(b,"Locale","waffle-settings-label-locale"),x1c(this,b,"This affects formatting details such as functions, dates, and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),y1c(this),w1c(b,"Time zone","waffle-settings-label-timezone"),x1c(this,b,"Your spreadsheet's history will be recorded in this time zone. This will affect all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
y1c(this)],d=[];d.push(w1c(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(x1c(this,b,"This affects how often NOW, TODAY, RAND, and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(y1c(this));d.push(w1c(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=R9a(this.L,new Uj(Dva+"58515")).toString();e=b.Ha("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push(x1c(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=w1c(b,"Max number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=x1c(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");z1c(e);d.push(e);this.J.push(e);e=w1c(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=x1c(this,
b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");z1c(e);d.push(e);this.J.push(e);"OFF"==this.C[3].hf().bb()&&A1c(this);d.push(y1c(this));c=Ib(c,d);c.push(S(p1c,{Z5a:this.Lb,bTb:this.jb}));this.ib=b.Ha("TABLE","dialog-settings",b.Ha("TBODY",null,c));this.cb=b.Ha("table","dialog-settings",b.Ha("tbody",null,d));c=S(q1c);b.appendChild(a,c);this.Ab.kb(c);b.appendChild(a,
this.ib);b.appendChild(a,this.cb);Q(this.cb,!1);r1c||(a=new Vs(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),r1c=a);Ys(this,r1c);B1c(this,4,Me(this.F,3)&&M(this.F,3).R7()?M(this.F,3).K5().toString():"50");B1c(this,5,Me(this.F,3)&&M(this.F,3).O7()?M(this.F,3).r5().toString():"0.05");Ht(this,"save")};function z1c(a){a=a.firstChild.firstChild;ss(a,"jfk-textinput");qr(a,"width","7em")}function A1c(a){for(var b=0;b<a.J.length;b++)Q(a.J[b],!1)}
function w1c(a,b,c){return a.Ha("TR",null,a.Ha("TD",{id:c,"class":"dialog-settings-label"},b))}function x1c(a,b,c,d,e,f,h){b=b.Ha("TR",null,b.Ha("TD","dialog-settings-input"),b.Ha("TD",{id:f,"class":"dialog-settings-text"},c,h));a=a.C[d];a.render(b.firstChild);a=a.La;ks(a,"labelledby",e);ks(a,"describedby",f);return b}function y1c(a){a=a.Aa();return a.Ha("TR",null,a.Ha("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.Ha("HR",{"class":"dialog-settings-sep"})))}
p.Ra=function(){I_.qa.Ra.call(this);Ee(this,"dialogselect",v(this.pZb,this));this.getHandler().V(this.C[3],"action",this.rTb);this.getHandler().V(this.Ab,"select",this.HCb);var a=this.C[4].getElement();this.R.sj(a);aV(this.R,a,a);this.R.render();$U(this.R);this.getHandler().V(a,"change",v(this.KVb,this));a=this.C[5].getElement();this.O.sj(a);aV(this.O,a);this.O.render();$U(this.O);this.getHandler().V(a,"change",v(this.JVb,this));if(this.jb){a=this.Aa().getElement(t1c.K1a);var b=this.Aa().getElement(t1c.L1a);
this.gb.kb(a);St(this.gb,b);this.gb.yc(!fwa||N9a(this.L.F))}};p.setVisible=function(a){if(a){if(!this.wb){C1c(this);return}var b=this.L.L;B1c(this,0,b.C);b=b.D||uKb().name();B1c(this,1,b);B1c(this,2,Me(this.F,3)&&M(this.F,3).$ka()?M(this.F,3).Qha().toString():"");B1c(this,3,Me(this.F,3)&&Me(M(this.F,3),1)?M(M(this.F,3),1)?"ON":"OFF":"OFF")}I_.qa.setVisible.call(this,a);if(this.wb&&!this.Kb){if(a=Tn("ds-settings-link"))a.href=this.Cb;this.Kb=!0}};
function C1c(a){Hm(a.Vc.Ke("/info/settings").Ef(D1c()),v(function(a){a=a.Ye();(a={locale:a.l?this.JJ(a.l):null,HTa:a.tz?this.JJ(a.tz):null,g6a:a.dls,MHb:a.dln,HVb:a.hl},a.locale)&&a.HTa&&(E1c(this,0,a.locale),E1c(this,1,a.HTa),E1c(this,2,u1c),E1c(this,3,v1c),this.Cb=a.g6a,this.Lb=a.MHb,this.Yb=a.HVb,this.jb=fwa&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.Yb),this.wb=!0);this.setVisible(!0)},a)).ye()}
function D1c(){var a=dk(ep("win").location.href),b=ck(a,"hl");a=ck(a,"forcehl");return["hl",b,"forcehl",a]}function E1c(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new yt(e.caption,e.value);a.Fd(e);js(e.getElement(),"menuitem")}a.wc().getElement().style.overflow="auto";VR(a,!0)}p.JJ=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function B1c(a,b,c){(a=a.C[b])&&a.fb(c)}
p.pZb=function(a){if("save"==a.key)if("ON"!=this.C[3].hf().bb()||""==this.Ia&&""==this.Ba){F1c(this);a=this.L.L.C;this.Nb.C(G1c(this));this.Nb.C(H1c(this));if(this.jb){var b=!fwa||N9a(this.L.F);var c=this.gb.isChecked();b!=c?(V9a(this.L,c),b=Uq(new Tq,1).build(),this.tc.Xb(c?2433:2434,b),c=!0):c=!1}else c=!1;c||(c=this.C[0].hf(),c=null!=c&&c.bb()!=a);c&&Ssa(this.L.D.C,this.oZb)}else a.preventDefault(),F1c(this),""!=this.Ia&&ZU(this.R,this.Ia,!0),""!=this.Ba&&ZU(this.O,this.Ba,!0)};
p.rTb=function(a){if("ON"==a.target.bb())for(a=0;a<this.J.length;a++)Q(this.J[a],!0);else A1c(this);F1c(this)};function F1c(a){$U(a.R);$U(a.O)}p.KVb=function(){this.Ia="";var a=this.C[4].bb()||"";a=this.Vb.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.Ia="Please enter an integer value.";else if(0>=a||1E4<a)this.Ia="Please enter a value between 1 and 10000."};p.JVb=function(){this.Ba="";var a=this.C[5].bb()||"";a=this.Vb.parse(a);isNaN(a)?this.Ba="Please enter a numeric value.":0>a&&(this.Ba="Please enter a non-negative value.")};
p.HCb=function(a){switch(a.target.getId()){case "general-settings-tab":Q(this.ib,!0);Q(this.cb,!1);break;case "calculation-settings-tab":Q(this.ib,!1),Q(this.cb,!0)}};function G1c(a){var b=a.C,c=b[s1c.dWa].hf().bb(),d=b[s1c.jZa].hf().bb();a=b[s1c.xZa].bb()||"";b=b[s1c.cXa].bb()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new iQ(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function H1c(a){var b=a.C;a=a.L.L;var c=b[s1c.S1].hf();c=null==c?a.C:c.bb();b=b[s1c.l1a].hf();b=null==b?a.D||uKb().name():b.bb();return new OJb(c,b)}p.oZb=function(){(new cLb).exec()};p.Oa=function(){Zb(this.C,H);delete this.C;I_.qa.Oa.call(this)};function I1c(a,b,c,d,e,f,h){Ms.call(this,void 0,!1,h);this.L=this.J=this.R=this.O=null;this.Ia=a;this.C=b;this.F=[];this.Ba=new Kfc(a,d,e,f)}r(I1c,Ms);p=I1c.prototype;
p.Ha=function(){Ms.prototype.Ha.call(this);var a=this.Aa(),b=this.C.Ic(),c=QE(b.Re()),d=QE(new Ak(b.left+b.width-1,b.top+b.height-1));Ns(this,"Sort range from "+(c+(" to "+d)));J1c||(c=new Vs,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),J1c=c);Ys(this,J1c);Ht(this,"save");var e;c=a.Ha("DIV",{style:"overflow: hidden"},d=a.Ha("SPAN","jfk-checkbox"),e=a.Ha("SPAN",{style:"cursor: default"},"Data has header row"));var f=this.L=new ju(void 0,a);f.kb(d);St(f,e);1==b.height&&f.eb(!1);fJ(this.Ia,this.C.fc(),
b)||(f.yc(!0),f.eb(!1));Jwa&&ritz_api.TablesApi.getTables((new kl).serialize(tl(b,this.C.fc())),v(function(a){if(0<a.length){var c=a[0];a=K8b(c.getDimensionTableAccessor().getHeaderRange());if(c=ritz_api.TablesApi.isRowBased(c))c=rl(a),c=1==uf(c)-M(c,1);c&&(c=tl(b,this.C.fc()),c=a.Jb()==c.Jb()&&NYc(rl(a),rl(c))&&NYc(sl(a),sl(c)));c&&f.yc(!0)}},this));d=this.Pb();a.appendChild(d,c);this.O=a.Ha("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.Ha("TABLE",{cellSpacing:"0"},this.R=
a.Ha("TBODY")));a.appendChild(d,this.O);c=K1c(this);this.F.push(c);c=a.Ha("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(d,c);Co(c,!0);js(c,"button");this.J=c};p.Ra=function(){Ms.prototype.Ra.call(this);this.getHandler().V(this,"dialogselect",this.JIb).Yg(this.J,He,this.Yib).V(this.L,"change",this.Drb)};
function K1c(a){var b=a.Aa(),c=0==a.F.length,d=new L1c(a,c,a.C,0,b),e=b.Ha("TR",null,b.Ha("TD",{colspan:"4"},b.Ha("DIV","waffle-sd-row-separator")));d.render(a.R);b.appendChild(a.R,e);c||a.getHandler().Yg(d.D,He,v(a.C5a,a,d));a=M1c(a);N1c(d,a);return d}p.C5a=function(a){var b=this.F;if(1<b.length){var c=ob(b,a);-1!=c&&(Hb(b,c),b=a.getElement(),b=vo(b),a.dispose(),ro(b),Q(this.J,!0),this.J.focus(),YA("Sort criteria removed."))}};
function M1c(a){var b=a.C.Ic(),c=b.gc();b=b.Pc();var d=sb(a.F,function(a){return a.bk()},a);if(d)for(var e=eG(a.C,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=gG(a.C,f);if(!zb(d,h))return h}return null}p.Drb=function(){for(var a=this.F,b=0;b<a.length;b++)N1c(a[b])};p.Yib=function(){var a=el(this.C.Ic(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push(K1c(this)),YA("Sort criteria added."));Cr(nb(this.F).getElement(),this.O,!0);this.O.scrollLeft=0;this.F.length>=a&&Q(this.J,!1)};
p.JIb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(e.bk());e=e.F.isChecked();b.push(e?1:0)}c=this.C.Ic();d=el(c,"r");if(this.L.isChecked()&&1<d){d=c.kc()+1;e=c.gc();var f=c.Mc(),h=c.Pc();c.top=d;c.left=e;c.height=f-d;c.width=h-e}a=new Efc(a,b,this.C,c,this.L.isChecked());Lfc(this.Ba,this.C,a)}};p.Oa=function(){Ms.prototype.Oa.call(this);we(this.F)};var J1c=null;
function L1c(a,b,c,d,e){R.call(this,e);this.J=this.L=this.F=this.C=this.D=null;this.R=-1;this.$=a;this.O=b;this.H=c}r(L1c,R);L1c.prototype.bk=function(){var a=this.C.hf();return a?a.bb():-1};
L1c.prototype.Ha=function(){var a=this.Aa(),b=this.O?"sort by":"then by",c,d,e,f=a.Ha("TR","waffle-sd-tr-rules",a.Ha("TD","waffle-sd-delete",this.O?"":this.D=a.Ha("SPAN",{title:"Remove sort criteria."},"x")),a.Ha("TD","waffle-sd-td-rules",a.Ha("LABEL",{id:Ur(this,"csl")},b)),b=a.Ha("TD","waffle-sd-column-selector"),a.Ha("TD","waffle-sd-td-ascending",e=a.Ha("DIV",null,c=a.Ha("DIV",{title:"Ascending"}),d=a.Ha("DIV",{title:"Descending"}))));js(e,"radiogroup");e=this.F=new RV(a,No(a,ip(Fx(!0,this.zf()))),
"ascending");e.render(c);a=this.L=new RV(a,No(a,ip(Fx(!1,this.zf()))),"descending");a.render(d);this.J=new TV([e,a]);UV(this.J,e);a=this.C=y_();a.render(b);ks(a.getElement(),"label",this.O?"Select first column to sort by:":"Select next column to sort by:");this.D&&(Co(this.D,!0),js(this.D,"button"),ps(this.D,"Remove sort criteria."));this.La=f};
function N1c(a,b){var c=a.Aa(),d=a.$.L.isChecked(),e=a.H.Ic(),f=e.kc(),h=e.gc();e=e.Pc();a.R=b||a.bk();for(b=a.C.mj();0<b;b--)a.C.VB(0);for(;h<e;h++)b=ab(bF(a.H.Tf(f,h)),25),b=new yt(Qa(b)||!d?"Column "+KE(h):b,gG(a.H,h),c),b.bf("waffle-sd-menu-item"),a.C.Fd(b);a.C.Bf(0);0<=a.R&&a.C.fb(a.R)}L1c.prototype.Oa=function(){R.prototype.Oa.call(this);this.C=this.D=this.H=this.$=null;H(this.F);H(this.L);H(this.J);this.J=this.L=this.F=null};function O1c(a){return U('<input type="text" id="docs-copy-link" class="'+V("docs-copy-link")+'" value="'+V(a.link)+'" readonly="readonly">')};function J_(a,b,c,d){lu.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Ia="";this.F=b||null;this.Ba=c||new hBb(a);this.R=null!=d?d:null;a=new Vs;$s(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.Ba.C()&&$s(a,{key:"copy-link",caption:"Copy Link"});Ys(this,a)}y(J_,lu);p=J_.prototype;
p.Ha=function(){J_.qa.Ha.call(this);ss(Ss(this),"copy-link-dialog");ss(Zs(this.D,"done"),"copy-link-done-button");this.C=S(O1c,{link:this.Ia},void 0,this.Aa());ks(this.C,"label","Link to this comment");this.Pb().appendChild(this.C);if(this.L=Zs(this.D,"copy-link")){var a=ao("DIV");ss(a,"copy-link-butter-holder");this.getElement().insertBefore(a,Qs(this));this.O=new pu(a);this.J=ru("Link copied to clipboard.","info",!1,4E3)}null!==this.R&&(qr(this.kx(),"z-index",this.R),qr(Ss(this),"z-index",this.R+
1))};p.Tm=function(){J_.qa.Tm.call(this);this.F&&this.getHandler().V(this.F,"copy",this.qCa);this.C.focus();this.C.select()};p.Xo=function(){J_.qa.Xo.call(this);this.F&&this.getHandler().Gc(this.F,"copy",this.qCa)};p.Ra=function(){J_.qa.Ra.call(this);this.getHandler().V(this.C,"click",this.ARb);this.L&&this.getHandler().V(this.L,"click",this.Smb)};p.fSb=function(a){this.Ia=a;this.C&&(this.C.value=a)};p.ARb=function(a){a.target.focus();a.target.select()};
p.Smb=function(a){a.stopPropagation();this.F&&this.Ba.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.C(this.C.value))};p.qCa=function(a){a.C&&this.J&&this.O&&(this.J.isVisible()||this.O.postMessage(this.J),this.C.focus(),this.C.select())};p.Oa=function(){J_.qa.Oa.call(this);H(this.J);delete this.J;delete this.L;delete this.C};function P1c(){G.call(this)}y(P1c,kp);p=P1c.prototype;p.Tdb=function(){return M_c};p.leb=function(){return O_c};p.TJb=function(a,b,c,d){var e=new Jt;a=new Gt(a,b,c,d,void 0,!0,void 0);Ht(a,"ok");b=v(e.kb,e);a.Ila=b;a.Fa(e);a.pj=!0;a.L6=Pka(Qa);return a};p.Ufb=function(){return f1c};p.n5a=function(a,b,c,d,e){return new I1c(a,b,0,c,d,e,void 0)};p.ueb=function(){return v0c};p.gFa=function(){return H0c};p.Keb=function(){return R0c};p.Zfb=function(){return I_};p.Yfb=function(){return K_c};p.Ffb=function(){return Z0c};
p.Xfb=function(){return m1c};p.peb=function(){return kZc};p.Vfb=function(){return hZc};p.Wfb=function(){return IZc};p.oeb=function(){return J_};up("dialogs",P1c);
