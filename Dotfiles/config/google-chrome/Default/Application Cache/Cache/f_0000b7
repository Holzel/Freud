oW.prototype.SRa=PR(231,function(a){this.J=Lb(arguments,0)});var $Dc=[2];function aEc(a){Wc(this,a,0,-1,$Dc,null)}y(aEc,Vc);function SX(a){Wc(this,a,0,-1,null,null)}y(SX,Vc);var bEc=[1,2];function cEc(a){Wc(this,a,0,-1,bEc,null)}y(cEc,Vc);var dEc=[1];function eEc(a){Wc(this,a,0,-1,dEc,null)}y(eEc,Vc);var fEc=[1];function gEc(a){Wc(this,a,0,-1,fEc,null)}y(gEc,Vc);var hEc=[1];function iEc(a){Wc(this,a,0,-1,hEc,null)}y(iEc,Vc);var jEc=[3];function kEc(a){Wc(this,a,0,-1,jEc,null)}y(kEc,Vc);
kEc.prototype.getChartType=function(){return B(this,1)};function TX(a){Wc(this,a,0,-1,null,null)}y(TX,Vc);function lEc(a){Wc(this,a,0,-1,null,null)}y(lEc,Vc);function mEc(a){Wc(this,a,0,-1,null,null)}y(mEc,Vc);mEc.prototype.getChartType=function(){return B(this,1)};function nEc(a){Wc(this,a,0,-1,null,null)}y(nEc,Vc);nEc.prototype.xf=function(){return B(this,2)};function UX(a,b){return M(a,2,b)}
function oEc(a,b,c,d,e){return DNb(a,v(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function pEc(a){var b=0;A(a,function(c,d){c.length>a[b].length&&(b=d)});return sb(a[b],function(b,d){return sb(a,function(a){return a[d]})})}function qEc(a){a=qG(a.D);return null!=a?a.toString():"0"}
function rEc(a,b){var c={row:0,yj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Mc()+1?c.row=b.Mc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Pc()+1&&(c.yj=b.Pc()+1));return c}function sEc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=qEc(a);c=rEc(e,c);(a=oEc(a.C,b,e,c.row,c.yj))&&d&&a.length<a[0].length&&(a=pEc(a));return a}
function tEc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function uEc(a,b){ws(a.La,"waffle-autovis-lightbox-readonly",b);a.D.setVisible(!b)}function vEc(a,b){var c=Me(a,1)?M(a,1):Number.MIN_VALUE;a=Me(a,2)?uf(a):Number.MAX_VALUE;var d=Me(b,1)?M(b,1):Number.MIN_VALUE;b=Me(b,2)?uf(b):Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}var wEc={Vzc:0,kxa:1,Kxa:2};
function xEc(a){return jc(msc,function(b){return b.match(a)}).getName()}function VX(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function WX(a){return a[VX(a.length,1)[0]]}function yEc(a){var b={};A(a,function(a){b[a]||(b[a]=0);b[a]++});Mb(a);Pb(a,function(a,d){return b[d]-b[a]})}
function zEc(){return U('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function AEc(){return U(""+T(ev({xd:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:$t(""+T(xw({icon:"docs-icon-img docs-icon-plus"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+T(ev({xd:"waffle-assistant-zoom-button",content:$t(""+T(xw({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4}))+"")}
var BEc={z1a:0,cda:1,Dba:2,zca:3,N1a:4,M0a:5,dva:6,bU:7,G0a:8,H0a:9},CEc={UNKNOWN_ERROR:0,wAc:1,Hqc:2,xcc:3},DEc={gAc:0,Scc:1,Jba:2,lk:3,$zc:4,a3b:5,mec:6},EEc={eAc:0,HA:1,Oqc:2,sqc:3,rtc:4},FEc={aAc:0,Kqc:1,fE:2,Qnc:3},GEc={Szc:0,zzc:1,Xgc:2,tyc:3,ryc:4,E6b:5,Aoc:6},HEc={uxc:0,nI:1,RWa:2,tzc:3,mwc:4,v_a:5,uAc:6,Mua:7,Bsa:8,fta:9,M1:10},IEc={UNKNOWN:0,L2b:1,K2b:2,J2b:3,d4b:4,R5b:5,y6b:6,g$b:7,vdc:8,lpc:9,Ftc:10,Qtc:11,Hxc:12,Ixc:13,Xyc:14,ctc:15};var JEc={DEFAULT:0,RIGHT:1,LEFT:2,YA:3,yA:4},KEc={L0a:0,toc:1};function LEc(){K.call(this)}y(LEc,K);var MEc=null;function XX(){K.call(this)}y(XX,K);var NEc=null;function YX(){K.call(this)}y(YX,K);var OEc=null;YX.prototype.getPosition=function(){return M(this,1)};YX.prototype.setPosition=function(a){N(this,1,a)};function ZX(){K.call(this)}y(ZX,K);var PEc=null;function QEc(){K.call(this)}y(QEc,K);var REc=null;
LEc.prototype.Na=function(){var a=MEc;a||(MEc=a=Te(LEc,{0:{name:"ChartScale",Fb:"virtualanalyst.sheets.ChartScale"},1:{name:"custom_scale",Ja:14,defaultValue:0,type:KEc},2:{name:"factor",Ja:1,type:Number}}));return a};LEc.Na=LEc.prototype.Na;XX.prototype.Na=function(){var a=NEc;a||(NEc=a=Te(XX,{0:{name:"ChartTitle",Fb:"virtualanalyst.sheets.ChartTitle"},1:{name:"title",Ja:9,type:String}}));return a};XX.Na=XX.prototype.Na;
YX.prototype.Na=function(){var a=OEc;a||(OEc=a=Te(YX,{0:{name:"ChartLegend",Fb:"virtualanalyst.sheets.ChartLegend"},1:{name:"position",Ja:14,defaultValue:0,type:JEc}}));return a};YX.Na=YX.prototype.Na;ZX.prototype.Na=function(){var a=PEc;a||(PEc=a=Te(ZX,{0:{name:"ChartAxis",Fb:"virtualanalyst.sheets.ChartAxis"},1:{name:"scale",Ja:11,type:LEc}}));return a};ZX.Na=ZX.prototype.Na;
QEc.prototype.Na=function(){var a=REc;a||(REc=a=Te(QEc,{0:{name:"ChartOptions",Fb:"virtualanalyst.sheets.ChartOptions"},1:{name:"h_axis",Ja:11,type:ZX},2:{name:"v_axis",Ja:11,type:ZX},3:{name:"title",Ja:11,type:XX},4:{name:"subtitle",Ja:11,type:XX},5:{name:"legend",Ja:11,type:YX},6:{name:"chart_conversation",Ja:8,type:Boolean}}));return a};QEc.Na=QEc.prototype.Na;function $X(){K.call(this)}y($X,K);var SEc=null;$X.prototype.Sj=function(){return M(this,1)};function aY(){K.call(this)}y(aY,K);var TEc=null;aY.prototype.getText=function(){return M(this,1)};aY.prototype.Ut=function(){return Me(this,1)};function bY(){K.call(this)}y(bY,K);var UEc=null;bY.prototype.getStatus=function(){return M(this,1)};bY.prototype.getError=function(){return M(this,9)};function cY(){K.call(this)}y(cY,K);var VEc=null;function WEc(){K.call(this)}y(WEc,K);var XEc=null;
function dY(){K.call(this)}y(dY,K);var YEc=null;dY.prototype.iC=function(){return Me(this,1)};dY.prototype.getType=function(){return M(this,3)};dY.prototype.setType=function(a){N(this,3,a)};function ZEc(){K.call(this)}y(ZEc,K);var $Ec=null;function aFc(){K.call(this)}y(aFc,K);var bFc=null;
$X.prototype.Na=function(){var a=SEc;a||(SEc=a=Te($X,{0:{name:"Error",Fb:"ritz.assistant.Error"},1:{name:"message",Ja:9,type:String},2:{name:"code",Ja:14,defaultValue:0,type:CEc},3:{name:"unsupported_op_reason",Ja:14,defaultValue:0,type:DEc}}));return a};$X.Na=$X.prototype.Na;
aY.prototype.Na=function(){var a=TEc;a||(TEc=a=Te(aY,{0:{name:"AnswerQueryPhrase",Fb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ja:9,type:String},2:{name:"start_byte",Ja:5,type:Number},3:{name:"num_bytes",Ja:5,type:Number}}));return a};aY.Na=aY.prototype.Na;
bY.prototype.Na=function(){var a=UEc;a||(UEc=a=Te(bY,{0:{name:"AnswerResponse",Fb:"ritz.assistant.AnswerResponse"},1:{name:"status",Ja:5,type:Number},10:{name:"parse_status",Ja:14,defaultValue:0,type:EEc},11:{name:"answer_status",Ja:14,defaultValue:0,type:FEc},2:{name:"formula",Ja:9,type:String},3:{name:"debug_parse_response",Ja:9,type:String},4:{name:"interpretation",Ja:9,type:String},5:{name:"debug_interpretation_response",Ja:9,type:String},6:{name:"unused_phrase",Ec:!0,Ja:11,type:aY},7:{name:"used_entity_phrase",
Ec:!0,Ja:11,type:aY},8:{name:"unused_entity_phrase",Ec:!0,Ja:11,type:aY},9:{name:"error",Ja:11,type:$X},12:{name:"alternate_suggestion",Ec:!0,Ja:11,type:dY},14:{name:"deprecated_formula_builder_used",Ja:9,type:String},15:{name:"answer_visualization_type",Ec:!0,Ja:14,defaultValue:0,type:HEc},16:{name:"formula_builder_used",Ja:14,defaultValue:0,type:IEc},17:{name:"charting_info",Ja:11,type:WEc},18:{name:"answer_field_info",Ec:!0,Ja:11,type:cY},19:{name:"charting_formula",Ja:9,type:String},21:{name:"parse_info",
Ec:!0,Ja:11,type:ZEc},22:{name:"answer_field_info_for_ranges",Ec:!0,Ja:11,type:cY},23:{name:"va_query",Ja:9,type:String},24:{name:"pivot_table_def",Ja:11,type:Cg}}));return a};bY.Na=bY.prototype.Na;cY.prototype.Na=function(){var a=VEc;a||(VEc=a=Te(cY,{0:{name:"AnswerFieldInfo",Fb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Ja:14,defaultValue:0,type:wja},2:{name:"range_ref",Ja:9,type:String}}));return a};cY.Na=cY.prototype.Na;
WEc.prototype.Na=function(){var a=XEc;a||(XEc=a=Te(WEc,{0:{name:"ChartingInfo",Fb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",Ec:!0,Ja:14,defaultValue:0,type:HEc},2:{name:"recommended",Ja:8,type:Boolean},3:{name:"user_requested_type",Ec:!0,Ja:14,defaultValue:0,type:HEc},4:{name:"show_only_chart",Ja:8,type:Boolean},5:{name:"chart_options",Ja:11,type:QEc}}));return a};WEc.Na=WEc.prototype.Na;
dY.prototype.Na=function(){var a=YEc;a||(YEc=a=Te(dY,{0:{name:"QuerySuggestion",Fb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ja:9,type:String},2:{name:"formula",Ja:9,type:String},3:{name:"type",Ja:14,defaultValue:0,type:GEc},4:{name:"deprecated_formula_builder_used",Ja:9,type:String},5:{name:"formula_builder_used",Ja:14,defaultValue:0,type:IEc}}));return a};dY.Na=dY.prototype.Na;
ZEc.prototype.Na=function(){var a=$Ec;a||($Ec=a=Te(ZEc,{0:{name:"ParseInfo",Fb:"ritz.assistant.ParseInfo"},1:{name:"intent_info",Ec:!0,Ja:11,type:aFc}}));return a};ZEc.Na=ZEc.prototype.Na;aFc.prototype.Na=function(){var a=bFc;a||(bFc=a=Te(aFc,{0:{name:"IntentInfo",Fb:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Ja:14,defaultValue:0,type:BEc}}));return a};aFc.Na=aFc.prototype.Na;function cFc(){var a=Zt("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<div class="waffle-assistant-answers-search-icon">'+T(xw({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input type="text" class="waffle-assistant-answers-input-box" placeholder="'+V(a)+'" aria-label="'+V(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');
a+='<div class="'+V("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+'">'+T(xw({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return U(a)};function eY(a){R.call(this,a);this.D=new Yu("",new gX,this.Aa());this.Qa(this.D);this.F=new qW(!1,"#4285f4");this.Qa(this.F);this.C=this.J=this.H=null}r(eY,R);eY.prototype.Ha=function(){this.hd(S(cFc))};eY.prototype.hd=function(a){R.prototype.hd.call(this,a)};
eY.prototype.Ra=function(){R.prototype.Ra.call(this);var a=this.Aa();this.C=a.Za("waffle-assistant-answers-query-box",this.La);this.D.kb(a.Za("waffle-assistant-answers-clear-query-button",this.C));this.H=a.Za("waffle-assistant-answers-spinner-container",this.C);this.F.render(this.H);this.J=a.Za("waffle-assistant-answers-input-box",this.C)};eY.prototype.setVisible=function(a){this.getElement()&&(Q(this.getElement(),a),(a=xx)&&a.dispatchEvent("resize"))};function fY(a,b,c){a&&(u(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Ta(b),dv(a,b,void 0),Urc(a),a.setAttribute("data-tooltip-delay",500),p9b(a,u(c)?c:1))};function dFc(a){var b=a.type;switch(na(b)&&b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":b=[];for(var c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return null!=a.value?a.value:null}}
function eFc(a,b){var c=a.type;switch(na(c)&&c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(na(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":na(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function fFc(a,b,c,d,e,f){I.call(this,"sqc");this.R=a;this.F=f||"";this.L=b;this.J=d;this.$=e;this.C=c}y(fFc,I);function gFc(a,b,c,d,e,f,h){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;h=void 0===h?null:h;I.call(this,"answers-submit-query");this.C=a;this.R=b;this.L=c;this.J=d;this.$=e;this.F=f;this.Pa=h}y(gFc,I);function hFc(){this.F=[];this.D={};this.J=null;this.C=new xJ}function iFc(a,b,c,d){function e(a){return a.toLowerCase()}Mb(b,void 0,e);Mb(c,void 0,e);Mb(d,void 0,e);A(b,a.H,a);A(c,a.H,a);A(d,a.H,a)}hFc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function jFc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}hFc.prototype.fH=function(a,b,c){if(Ta(a||"")){var d=this.J.Jm();d=kFc(this,a.substring(0,d));var e=lFc(this,b-d.length,a);d=Ib(d,e)}else d=lFc(this,b);d.length>b&&(d=Lb(d,0,b));c(a,d)};
function lFc(a,b,c){var d=c||"";c=$b(a.D,function(a){return Ma(a,d)});var e=mFc(ec(c),d?1:2,1);a=rb(a.F,function(a){return Ma(a.query,d)&&!e[a.query.toLowerCase()]});b=mFc(a,b-dc(e),2);b=ec(b);var f=sb(b,function(a,b){a.yqa=b;return a.yTa});A(b,function(a){a.wqa=f});return Ib(b,ec(e))}
function kFc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={Haa:h.Haa,g_:h.g_,ZR:h.ZR},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.ZR={};h.g_=0;h.Haa=f.substr(k);var l=a.C.Se(h.Haa);A(l,function(b){return function(c){var d=c.length-b.Haa.length;b.g_=Math.max(d,b.g_);c=a.C.get(c);b.ZR[d]||(b.ZR[d]=[]);Kb(b.ZR[d],c)}}(h));for(l=0;l<=h.g_&&0<d;++l){var m=h.ZR[l];if(m)for(var q=0;q<m.length&&0<d;++q){var t=m[q];$a(b.toLowerCase(),t.toLowerCase())||e[t]||(--d,c.push({text:t,$m:"",
jA:0,tza:f.length-k,yTa:void 0,wqa:[],yqa:-1}),e[t]=!0)}}}return c}function mFc(a,b,c){b=VX(a.length,Math.min(a.length,b));var d={};A(b,function(b){b=a[b];var e=na(b)?b:b.query;d[e.toLowerCase()]={text:e,$m:na(b)?"":b.$m,jA:c,tza:0,yTa:na(b)?void 0:b.type,wqa:[],yqa:-1}});return d};function gY(){pL.call(this,"",null,!1)}y(gY,pL);gY.prototype.dD=function(a,b){if(2==a.jA||1==a.jA)return gY.qa.dD.call(this,a.text,b);var c=this.bb(),d=this.Jm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.tza)+a.text;e||(f+=" ");a=gY.qa.dD.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.nk;b.blur();b.focus();this.a0(f.length);return a};
gY.prototype.ag=function(a){var b=gY.qa.ag.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,Pmb(b)&&b.KF()&&a.preventDefault(),b=!0);return b};function nFc(){return U('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+T(xw({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+T(xw({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+T(xw({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function oFc(a){this.xb=a||Qn()}
oFc.prototype.yu=function(a,b,c){b=S(nFc);var d=this.xb.Za("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.xb.Ze(d,a.text);d=this.xb.Za("waffle-assistant-answers-ac-entity-icon",b);var e=this.xb.Za("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.xb.Za("waffle-assistant-answers-ac-session-query-icon",b);Q(d,0==a.jA);Q(e,2==a.jA);Q(f,1==a.jA);d="";switch(a.jA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&ss(c,d);this.xb.appendChild(c,b)};function pFc(a,b,c,d){G.call(this);this.O=a;this.D=a.J;this.F=a.D;this.L=a.C;this.H=new gY;this.H.qEa=!0;this.H.Pa=!0;this.Fa(this.H);this.R=c;this.R.J=this.H;a=new oL(null,new oFc(a.Aa()));this.C=new nL(this.R,a,this.H);this.Fa(this.C);this.va=b;this.J=!1;this.$=Uq(new Tq,d).build();this.Va=new Ti(this);this.Fa(this.Va);qFc(this)}r(pFc,G);
function qFc(a){rFc(a);a.H.C=a.C;a.C.cY=!1;a.C.e9=6;gnb(a.H,a.D);fY(a.F.getElement(),"Clear query");a.Va.V(a.C,"update",a.Zjb).V(a.L,"submit",a.KIb).V(a.L,"focus",function(){return sFc(a,!0)},!0).V(a.L,"blur",function(){return sFc(a,!1)},!0).V(a.F,"action",a.r4a).V(a.D,"input",a.xUa).V(a.D,"focus",a.XQa);a.F.setVisible(!1)}p=pFc.prototype;p.Oa=function(){G.prototype.Oa.call(this);this.R.J=null};function tFc(a,b,c){c=void 0===c?!1:c;eFc(a.D,b);c&&a.D.focus();a.xUa()}
function rFc(a){a=a.C.Ed();a.className="waffle-assistant-answers-ac-renderer";a.$L="waffle-assistant-answers-ac-row";a.D2="waffle-assistant-answers-ac-active";a.ola="waffle-assistant-answers-ac-highlighted"}p.Zjb=function(a){a.row&&(a=a.row,2==a.jA?(uFc(this,1,a.wqa,a.yqa,a.$m,2),this.va.Xb(2652,this.$)):0==a.jA?(this.J=!0,this.va.Xb(2651,this.$)):1==a.jA&&uFc(this,3))};function sFc(a,b){ws(a.L,"waffle-assistant-answers-query-box-focused",b);a.C.Kf()&&!b&&a.C.dh()}p.xUa=function(){this.F.setVisible(!!dFc(this.D))};
p.XQa=function(){this.C.aw(this.D);var a=fb(dFc(this.D));this.H.a0(a.length);Mmb(this.C,a||"  ");this.C.update(!0)};p.KIb=function(a){a.stopPropagation();a.preventDefault();uFc(this,2)};function uFc(a,b,c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;var h=Ta(dFc(a.D));a.F.setVisible(!!h);vFc(a);a.O.dispatchEvent(new gFc(b,h,a.J,c,d,e,f));a.J=!1}p.r4a=function(){eFc(this.D,"");this.F.setVisible(!1)};function vFc(a){a.D.blur();a.C.Kf()&&a.C.dh()};function wFc(a,b){R.call(this,b);this.F=a;this.H=new hFc;this.C=new eY(this.Aa());this.Qa(this.C);this.D=null}r(wFc,R);wFc.prototype.hd=function(a){R.prototype.hd.call(this,a);this.C.render(a)};wFc.prototype.Ra=function(){R.prototype.Ra.call(this);this.D=new pFc(this.C,this.F,this.H,4);this.Fa(this.D);ss(this.C.La,"waffle-assistant-answers-input-with-icon")};function hY(a,b,c,d,e,f){I.call(this,a,b);this.C=b;this.Pa=c;this.$=d||null;this.Wa=e||null;this.J=f||null}y(hY,I);hY.prototype.jj=g("Pa");hY.prototype.Re=g("$");function xFc(a,b,c,d,e,f,h){h=void 0===h?null:h;hY.call(this,"Pd",null,d,e,f);this.L=a;this.R=b;this.xc=c;this.F=h}y(xFc,hY);xFc.prototype.Gd=g("xc");function yFc(a,b,c){hY.call(this,"Sd",null,2859);this.L=a;this.R=b;this.F=c}y(yFc,hY);function zFc(){return U('<div class="waffle-assistant-card" tabindex="0" role="region">'+(Uo?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(Uo?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function AFc(){return U('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function BFc(a,b){R.call(this,b);this.D=a;this.C=new Yu("",new AW,this.Aa());this.Qa(this.C)}y(BFc,R);p=BFc.prototype;p.Ha=function(){this.La=S(AFc)};p.Ra=function(){BFc.qa.Ra.call(this);var a=this.Za("waffle-assistant-feedback-card-link");this.C.kb(a);this.getHandler().V(this.La,"mousedown",this.U_b).V(this.C,"action",this.T_b);this.show(!1)};p.U_b=function(a){a.stopPropagation()};
p.show=function(a){var b=this.La,c=this.Za("waffle-assistant-feedback-card-link");ws(b,"waffle-assistant-feedback-card-hidden",!a);Co(c,a)};p.T_b=function(){O.Lu.mc({source:this.D});this.show(!1);this.dispatchEvent(new I("feedback-dialog-opened"))};function CFc(){var a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+T(xw({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+T(xw({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return U(a)};function iY(a){R.call(this,a);this.C=new Yu("",new gX,this.Aa());this.Qa(this.C);this.D=new Yu("",new gX,this.Aa());this.Qa(this.D)}y(iY,R);iY.prototype.Ha=function(){this.La=S(CFc)};iY.prototype.Ra=function(){iY.qa.Ra.call(this);var a=this.Za("waffle-assistant-thumbs-down-button");this.C.kb(a);fY(a,"Not useful");a=this.Za("waffle-assistant-thumbs-up-button");this.D.kb(a);fY(a,"Useful");this.getHandler().V(this.C,"action",this.F).V(this.D,"action",this.H)};
function DFc(a,b){a.Aa().Ze(a.Za("waffle-assistant-thumbs-text"),b)}iY.prototype.F=function(){this.dispatchEvent(new I("thumbs-down"));Q(this.La,!1)};iY.prototype.H=function(){this.dispatchEvent(new I("thumbs-up"));Q(this.La,!1)};function jY(a,b){var c=this;R.call(this,b);this.F=a;this.Pa=this.Ia=this.Ba=null;this.Lb=new qW(!0,"#4285f4");this.Qa(this.Lb);this.Vb=this.Vc=this.ze=!1;this.ib=new En(function(){c.ib.stop();c.La.parentNode.querySelector(":hover")==c.La?c.ib.start():c.JT()},100);this.Fa(this.ib);this.Lf=this.Jc=!1}y(jY,R);p=jY.prototype;p.tA=Ph;p.T7=Qh;p.NB=Rh;p.MB=Rh;p.a6=Rh;p.Kia=Rh;p.Jia=Rh;p.vA=da("Lf");p.vd=g("Lf");p.Ha=function(){this.La=S(zFc)};
p.Ra=function(){jY.qa.Ra.call(this);var a=this.Za("waffle-assistant-card-spinner-container");this.Lb.render(a);qr(this.Za("waffle-assistant-card-inner"),"visibility","hidden");if(this.tA()){a=this.La;var b=new zs(a);this.Fa(b);this.getHandler().V(b,"focusin",this.Ukb).V(b,"focusout",this.Tkb).V(a,"mouseenter",this.f1).V(a,"mouseleave",this.JT)}EFc(this,!1);Uo&&(this.Pa=new BFc(this.cz(),this.Aa()),this.Pa.render(this.Za("waffle-assistant-card-feedback-container")),this.getHandler().V(this.Pa,"feedback-dialog-opened",
this.Zpb).V(this,"trigger_feedback",this.dVb),this.T7()?(this.Ia=new iY(this.Aa()),this.Ia.render(this.Za("waffle-assistant-thumbs-container")),FFc(this,!0),a=fb(this.a6()),Qa(a)||DFc(this.Ia,a),a=fb(this.Kia()),Qa(a)||fY(this.Ia.Za("waffle-assistant-thumbs-up-button"),a),a=fb(this.Jia()),Qa(a)||fY(this.Ia.Za("waffle-assistant-thumbs-down-button"),a),this.getHandler().V(this.Ia,"thumbs-down",this.R_b).V(this.Ia,"thumbs-up",this.S_b)):FFc(this,!1));this.mA()};
function kY(a){return a.Za("waffle-assistant-card-content-container")}function GFc(a){a.tA();return a.Za("waffle-assistant-card-options")}function FFc(a,b){Uo&&Q(a.Za("waffle-assistant-thumbs-container"),a.T7()&&b)}p.bJ=function(){this.isDisposed()||(this.ze=!0,HFc(this))};function IFc(a,b){!a.Vc&&b&&(a.Vc=!0,HFc(a))}function HFc(a){if(a.ze&&a.Vc){var b=v(a.Q_b,a);a.uA(b)}}p.f1=function(){this.Vb||(EFc(this,!0),this.Vb=!0,this.ib.start())};p.JT=function(){EFc(this,!1);this.Vb=!1};
p.Ukb=function(){EFc(this,!0)};p.Tkb=function(){var a=this,b=new En(function(){yo(a.La,document.activeElement)||a.La.parentNode.querySelector(":hover")==a.La||EFc(a,!1)},0);this.Fa(b);b.start()};p.R_b=function(){JFc(this,!0);FFc(this,!1);var a=this.MB();this.dispatchEvent(new hY("Ud",this,a))};p.S_b=function(){FFc(this,!1);var a=this.NB();this.dispatchEvent(new hY("Ud",this,a))};p.Zpb=function(){JFc(this,!1)};p.dVb=function(){JFc(this,!0)};
function EFc(a,b){var c=a.Za("waffle-assistant-card-options");a=a.tA();Q(c,a&&b)}p.Q_b=function(){rW(this.Lb,!1);Q(this.Lb.La,!1);qr(this.Za("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new I("content-rendered"))};function JFc(a,b){ws(a.Za("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.Pa.show(b)};function KFc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+T(a.title)+"</div>"+T(ev({xd:"waffle-assistant-section-more-button",content:$t("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return U(a)};function LFc(a){return U('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+V(a.iconSize)+'px" width="'+V(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+V(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function MFc(){var a=U;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+T(LFc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=U(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function NFc(a){return U('<div class="waffle-assistant-panel-title-bar">'+T(ev({xd:"waffle-assistant-panel-back-button",content:$t(""+T(xw({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+T(a.title)+"</div></div>")};function lY(a){R.call(this,a);this.tc=new qW(!1,"#4285f4");this.Qa(this.tc);this.H=new R(this.Aa());this.Qa(this.H);this.C=[];this.ze=this.Yb=!1;this.kd=this.Vc=this.ib=this.$=null;this.Lb=new gv("",a,4);st(this.Lb,2,!1);this.Qa(this.Lb)}y(lY,R);var OFc={defaultHelpArticleId:"6280499"};p=lY.prototype;p.Ha=function(){lY.qa.Ha.call(this);this.La=S(MFc);this.Vc=this.Za("waffle-assistant-panel-content-container");this.kd=this.Za("waffle-assistant-empty-list")};
p.Ra=function(){lY.qa.Ra.call(this);var a=this.Za("waffle-assistant-spinner-container");this.tc.render(a);this.H.kb(this.Za("waffle-assistant-panel-card-holder"));this.Lb.kb(this.Za("waffle-assistant-empty-list-learn-more"));this.getHandler().V(this.Lb,"action",this.V_b).V(this.La,"scroll",Grc(this.pba,10,this))};p.setVisible=function(a){var b=this;Q(this.La,a);A(this.C,function(a){if(!a.Wb()){var c=b.H.Wc();a.Ba=c;b.H.Qa(a,!0);a.bJ()}});this.Yb=a};
p.Hoa=function(a,b){var c=this.Aa();this.$&&this.R3();this.$=new R;this.Qa(this.$);a=Ot(a,NFc,{title:b});this.ib=new gv("",this.Aa());this.$.Qa(this.ib);this.ib.kb(c.Za("waffle-assistant-panel-back-button",a));fY(this.ib.La,"Back");this.$.getHandler().V(this.ib,"action",this.pkb)};p.R3=function(){this.$.dispose();this.$=null};function PFc(a,b){rW(a.tc,b);Q(a.Za("waffle-assistant-panel-pane"),!b)}p.rH=function(a){Q(this.kd,a);Q(this.Vc,!a)};
function QFc(a,b){Gb(a.C,b);a.H.removeChild(b);a.H.vh(b,0);a.C.push(b)}p.cH=function(a){Gb(this.C,a);-1!=Xr(this.H,a)&&this.H.removeChild(a,!0)};p.HV=function(){this.H.Cd(!0);we(this.C);this.C=[]};p.pba=function(){var a=this.La;a=a.scrollTop+Ir(a).height;for(var b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(IFc(d,!0),b+=Ir(d.La).height):IFc(d,!1)}};function RFc(a,b){a.ze=b;A(a.C,function(a){a.vA(b)})}p.vd=g("ze");p.V_b=function(){O.xo.mc(OFc)};p.pkb=function(){this.dispatchEvent("Md")};function mY(a,b,c,d){R.call(this,d);this.$=a;this.ib=b;this.va=new gv("",this.Aa());this.Qa(this.va);this.J=new R(this.Aa());this.Qa(this.J);this.C=null;this.gb=[];this.cb=this.$a=!1;this.R=c}y(mY,R);p=mY.prototype;p.OKa=Ph;p.Jpa=Qh;p.Ha=function(){mY.qa.Ha.call(this);this.La=S(KFc,{title:this.gN()})};
p.Ra=function(){mY.qa.Ra.call(this);this.J.kb(this.Za("waffle-assistant-section-card-holder"));this.va.kb(this.Za("waffle-assistant-section-more-button"));this.getHandler().V(this.va,"action",this.Zub);this.C=this.nAa();this.Fa(this.C);Q(SFc(this),this.OKa());this.setVisible(!1)};p.setVisible=function(a){if(this.Wb()&&this.isVisible()!=a&&(Q(this.La,a),a)){Q(this.va.La,this.Npa());a=new qq;D(a,4,this.g1());var b=new oq;bd(b,58,a);a=ar(Uq(new Tq,10),b).build();this.R.Xb(2774,a)}};
p.isVisible=function(){return this.Wb()&&Lr(this.La)};p.Npa=function(){return this.gb.length>this.$};p.nAa=function(){return new lY(this.Aa())};p.hN=function(a){this.cb=a;A(TFc(this),function(b){b.vA(a)});RFc(this.C,a)};p.vd=g("cb");p.Mf=ta;
p.fN=function(a){this.gb=a;for(var b=0;b<a.length;b++){if(this.J.Wc()<this.$){var c=this.EO(a[b]);c.vA(this.cb);var d=this.J.Wc();c.Ba=d;this.J.Qa(c,!0)}if(this.Jpa()&&(this.C.rH(!1),c=this.C,d=this.EO(a[b]),c.C.push(d),c.Yb)){PFc(c,!1);var e=c.H.Wc();d.Ba=e;c.H.Qa(d,!0);d.bJ()}}};function TFc(a){var b=[];a.J.Ff(function(a){b.push(a)});return b}function SFc(a){return a.Za("waffle-assistant-section-content")}p.ela=function(){return this.J.N7()};
p.KT=function(){this.gb=[];we(this.J.Cd(!0));this.setVisible(!1);this.Jpa()&&(this.C.HV(),this.C.rH(!0))};function UFc(a){a.J.Ff(function(a,c){c<this.$&&a.bJ()},a)}p.iN=function(a){var b=0;if(this.$a)this.C.pba();else if(this.ela()){this.setVisible(!0);b=Ir(this.Za("waffle-assistant-section-header")).height+Ir(SFc(this)).height;for(var c=TFc(this),d=0;d<c.length;d++)b<a&&d<this.$?(this.YHa(c[d]),IFc(c[d],!0),b+=Ir(c[d].La).height):IFc(c[d],!1)}else this.setVisible(!1);return a-b};p.YHa=ta;
p.h1=function(a){(this.$a=a)||this.C.R3()};p.Ub=g("$a");function VFc(a,b){a.C.Hoa(b,a.gN())}p.Zub=function(){this.h1(!0);this.dispatchEvent("Rd")};var WFc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function XFc(a){var b=new uI(qc(WFc));return Owc(a,b)}
function YFc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.jc("useFirstColumnAsDomain")&&a.Gd()&&"number"===a.Gd().Xc(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.jc("useFirstColumnAsDomain")&&a.Gd()&&"string"===a.Gd().Xc(0)){c=0;var d=co("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Gd().getNumberOfRows();b++)Ao(d,a.Gd().Gf(b,0)),c=Math.max(c,Pr(d).width);ro(d);c=Math.min(27,Math.max(15,10+100*c/271))}Yo&&Xo||Zo||(a.setOption("chartArea.top","15%"),b=a.jc("hAxis.title"),a.setOption("chartArea.height",Qa(fb(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Qa(fb(a.jc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function ZFc(a,b,c){var d=a.Mc(),e=a.Pc();switch(b){case 0:d=Math.min(d,a.kc()+c);break;case 1:e=Math.min(e,a.gc()+c)}return ml(a.Jb(),a.kc(),a.gc(),d,e)}function $Fc(a){var b=new RAa;D(b,1,""+a.fd);var c=a.rect.kc();D(b,2,c);c=a.rect.Mc();D(b,3,c);c=a.rect.gc();D(b,4,c);a=a.rect.Pc();D(b,5,a);return b}function aGc(a){var b=new oq;if(a){var c=new qq;a=$Fc(a);bd(c,7,a);bd(b,58,c)}return b};function bGc(){return U('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function cGc(){return U(""+T(ev({xd:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:$t(""+T(xw({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+T(ev({xd:"waffle-assistant-zoom-button",content:$t(""+T(xw({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4}))+"")};function dGc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(T(a.x4a)+"</span>"),d=0==a.KDa.length;b+='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(d)c=U('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.KDa;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';c=h?c+T(h):c+"(empty)";c+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}c=U(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(Uo?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return U(b)};function eGc(a,b,c,d,e,f,h,k){R.call(this,k);this.H=a;this.D=b;this.L=e;this.O=f;this.F=h;this.C=this.xc=null;this.J=Uq(new Tq,10).build()}y(eGc,R);p=eGc.prototype;p.Ra=function(){eGc.qa.Ra.call(this);(new EV(zI,this.D.hg())).send(v(this.tnb,this,this.D))};p.BIa=function(a,b){a=new xFc(this.H.clone(),this.L,this.xc,2746,a,b);this.dispatchEvent(a)};p.tnb=function(a,b){b&&(b.oi()?jI.jE(this.La,b):(b=b.Gd(),a.ge(b),iW(a,b),kI(a,"ready",v(this.D_b,this,a)),JW(a,this.La,this.O,this.F,Zo),this.xc=b))};
p.D_b=function(a){a.Nl()&&(kI(a.Nl(),"onmouseover",v(this.B_b,this)),kI(a.Nl(),"onmouseout",v(this.C_b,this)))};p.B_b=function(){this.C=Ha()};p.C_b=function(){qa(this.C)&&500<Ha()-this.C&&this.F.Xb(2750,this.J);this.C=null};function fGc(a,b,c,d,e,f){R.call(this,f);this.J=a;this.Wa=b;this.$a=c;this.Ia=d;this.Ba=e;this.L=Re(this.J,23);this.Pa=M(this.J,22);this.D=M(this.J,26);this.va=[];this.Nc=new kl;this.O=this.F=this.C=null;this.R=!1;this.$=new gv("",this.Aa());this.Qa(this.$);this.H=null}y(fGc,R);p=fGc.prototype;p.Ha=function(){fGc.qa.Ha.call(this);this.La=S(dGc,{x4a:this.D,KDa:this.L});this.La.style.visibility="hidden"};
p.Ra=function(){fGc.qa.Ra.call(this);var a=this.Za("waffle-assistant-facet-toggle");this.$.kb(a);this.getHandler().V(this.La,"mousedown",this.y_b).V(this.$,"action",this.gDb);Uo&&(this.O=new BFc("assistantAutovisFacetFeedback",this.Aa()),this.O.render(this.Za("waffle-assistant-facet-feedback-container")),this.C=new iY(this.Aa()),this.Qa(this.C),this.C.render(this.Za("waffle-assistant-facet-thumbs-container")),DFc(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().V(this.C,
"thumbs-up",this.A_b).V(this.C,"thumbs-down",this.z_b));gGc(this,swa)};p.vd=g("R");p.y_b=function(a){a.stopPropagation()};p.gDb=function(){var a=rs(this.Za("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");gGc(this,a);hGc(this,a?2647:2646)};
function gGc(a,b){var c=a.Za("waffle-assistant-facet-toggle");Ao(c,b?"HIDE":"SHOW");ws(a.Za("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);A(a.Oi("waffle-assistant-faceted-chart"),function(a){Co(a,b)});a.C&&Q(a.C.La,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');fY(c,b?a:d)}
function iGc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function jGc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function kGc(a){a.R||A(a.va,v(function(a){var b=a.La;if(!this.Ba.contains(b)){var d=this.Ba;a=new lGc(b,a);Hzb(d,a)}},a))}p.A_b=function(){hGc(this,2649)};p.z_b=function(){hGc(this,2648);this.O.show(!0)};function hGc(a,b){var c=a.Ia,d=new lW,e=a.H.getChartType();d.C=e;e=a.H.Gd();d.F=e?e.clone():null;mW(c,b,d,10,a.H,a.H.hg())};function nY(a,b,c,d,e,f,h,k){jY.call(this,a,k);this.C=M(a,8);this.Kb=b;this.Cb=c;this.Nb=d;this.L=e;this.gb=f;this.Yb=h;this.O=new gv("",this.Aa());this.Qa(this.O);this.R=new gv("",this.Aa());this.Qa(this.R);this.Nc=new kl;this.Ab=null;this.Wa=!1;this.wb=[];this.jb=[];this.cb=[];this.$a=this.va=this.D=this.H=this.$=null;a=aGc(this.Yb);this.J=ar(Uq(new Tq,10),a).build()}y(nY,jY);
var oY={QVa:"waffle-assistant-after-chart-preview",kWa:"waffle-assistant-before-chart-preview",wWa:"waffle-assistant-card-draggable",L1:"waffle-assistant-chart-highlights",bZa:"waffle-assistant-insert-chart-button",Dva:"waffle-assistant-chart-preview",m0a:"waffle-assistant-button-separator",P0a:"waffle-assistant-styled-border",Q0a:"waffle-assistant-styled-rect",b2a:"waffle-assistant-zoom-button"};p=nY.prototype;p.uA=function(a){this.Ab=a;mGc(this)};
p.mA=function(){nGc(this,v(function(a){a=nsc(this.Kb,a);ps(this.La,a)},this),!1)};p.tA=Qh;p.cz=n("autovisFeedback");p.NB=n(2208);p.MB=n(2207);p.a6=n("Was this chart useful?");p.Ha=function(){nY.qa.Ha.call(this);kY(this).appendChild(S(bGc));GFc(this).appendChild(S(cGc));if(Me(this.C,22)){this.D=new fGc(this.C,this.Ba,this.Nb,this.L,this.gb,this.Aa());this.Qa(this.D,!0);var a=this.D,b=this.vd();a.R=b;kGc(a)}};
p.Ra=function(){nY.qa.Ra.call(this);ss(this.La,oY.wWa);var a=this.Za(oY.bZa);this.O.kb(a);fY(a,"Insert chart");a=this.Za(oY.b2a);this.R.kb(a);fY(a,"View full size");a=this.Za(oY.kWa);var b=this.Za(oY.QVa);this.getHandler().V(this.La,"keydown",this.v_b).V(a,"focus",this.ykb).V(b,"focus",this.jjb).V(this.O,"action",this.Ksb).V(this.O.La,"mousedown",this.Rra).V(this.R,"action",this.SEb).V(this.R.La,"mousedown",this.Rra).V(this.Za(oY.L1),"mousedown",this.Rra).V(nD(this.Kb),"Ca",this.w_b);oGc(this);this.L.Xb(2790,
this.J);this.D&&this.L.Xb(2791,this.J)};p.vA=function(a){nY.qa.vA.call(this,a);oGc(this);this.Wb()&&pGc(this)};function oGc(a){if(a.Wb()){var b=a.vd();a.O.setVisible(!b);a=a.Aa().Za(oY.m0a,GFc(a));Q(a,!b)}}p.v_b=function(a){13==a.keyCode&&a.target==this.La&&(a.preventDefault(),a.stopPropagation(),qGc(this,2255))};
function rGc(a){var b=a.getChartType(),c=!!M(a.C,14),d=M(a.C,16),e=!!M(a.C,15),f="Histogram"==b;b="PieChart"==b;for(var h=Lrc(Re(a.F,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var q=h[m].rect;q=c!=b?Eqc(q,new Ek(q.width,1)):Eqc(q,new Ek(1,q.height));Kb(l,q)}c=lG(a.Cb).D;var t=[];for(w in vk)t.push(Oob(c,vk[w]));var w=sb(l,function(a){return sb(t,Fa(Wk,a))});f&&e&&(w=Lb(w,1));a.cb=sGc(w.length,b&&0<d||!f&&!b&&e,b&&k);d=lG(a.Cb);for(e=0;e<w.length;e++)for(f=a.cb[e],b=0;b<w[e].length;b++)w[e][b]&&gl(w[e][b])&&
(k=rrc(d,w[e][b],oY.Q0a),a.Fa(k),tM(d.O,"default",k,!0),qr(k.La,"background-color",f),k.setVisible(!0),a.wb.push(k),k=OM(d,w[e][b],oY.P0a,1,0),a.Fa(k),ppb(k,f),k.setVisible(!0),a.jb.push(k))}function tGc(a){we(a.wb);we(a.jb);a.wb=[];a.jb=[];a.cb=[]}p.w_b=function(){this.Wa&&(tGc(this),rGc(this))};p.f1=function(){nY.qa.f1.call(this);this.va=Ha();this.Wa||(rGc(this),this.Wa=!0)};
p.JT=function(){nY.qa.JT.call(this);qa(this.va)&&500<Ha()-this.va&&this.L.Xb(2789,this.J);this.va=null;tGc(this);this.Wa=!1};p.ykb=function(){var a=this.Za(oY.L1);Lr(a)?a.focus():this.La.nextSibling&&this.La.nextSibling.focus()};p.jjb=function(){var a;if(a=this.Pa)a=this.Pa,a.Db("waffle-assistant-feedback-card-hidden")?a=!1:(a.Za("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.R.La.focus()};p.Ksb=function(){qGc(this,2255)};p.Rra=function(a){a.stopPropagation()};
p.SEb=function(){ANa.mc(this,this.J)};p.BIa=function(a,b){qGc(this,2257,a,b)};function qGc(a,b,c,d){nGc(a,v(function(a){a=new xFc(a,this.Ba,this.H&&this.H.Gd(),b,c,d,pCa(this.J));this.dispatchEvent(a)},a),!1)}
p.x_b=function(a,b){if(b){var c=this.Za(oY.Dva);if(b.oi())jI.jE(c,b);else{a.ge(b.Gd());iW(a,a.Gd());WU(a,"ready",v(this.u_b,this,a));b=[];try{var d=new dh;d.setContext(a.toJSON());var e=!!M(this.C,14);N(d,3,e);var f=M(this.C,16);N(d,4,f);N(d,5,"ROWS"==(e?"ROWS":"COLS"));N(d,8,0);if(M(this.C,24)){var h=M(this.C,25);N(d,9,h)}var k=Lrc(Re(this.F,4));for(e=0;e<k.length;e++)d.addRange(tl(k[e].rect,k[e].fd));var l=this.Nc.serialize(d);b=sb(vyc(Fa(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
syc)}catch(m){b=[]}d=this.Za(oY.L1);Q(d,0<b.length);0<b.length&&(d.appendChild(b[0]),Co(d,!0));this.H=a;JW(a,c,this.Nb,this.L,Zo)}}};p.u_b=function(a){null!==this.$&&(ae(Zd(),this.$),this.$=null);this.isDisposed()||(a.Nl()&&(kI(a.Nl(),"onmouseover",v(this.s_b,this)),kI(a.Nl(),"onmouseout",v(this.t_b,this))),this.Ab(),pGc(this))};p.s_b=function(){this.$a=Ha()};p.t_b=function(){qa(this.$a)&&500<Ha()-this.$a&&this.L.Xb(2795,this.J);this.$a=null};
function pGc(a){if(!a.vd()){var b=a.Za(oY.Dva);if(!a.gb.contains(b)){var c=a.gb;a=new lGc(b,a);Hzb(c,a)}}}function uGc(a){a.Jc&&(a.$=$d(Zd(),nm.Fsa),a.Jc=!1);M(a.C,16);var b=XFc(a.C);b.V$(zI);var c=Qwc(a.F);b.ej(c.toString());a.D&&(c=c.clone(),a.D.F=c);return b}
function mGc(a){var b=uGc(a);b=YFc(b,a.Za("waffle-assistant-card-inner"));(new EV(zI,b.hg())).send(v(a.x_b,a,b));a.D&&nGc(a,v(function(a){var c=this.D,e=b;a=new uI(a.toJSON());e=new uI(e.toJSON());var f=c.Oi("waffle-assistant-faceted-chart");if(1<f.length){jGc(a);var h=e;iGc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");Yo&&Xo||Zo||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,jGc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),iGc(e);h=Lrc(Re(c.J,27));S8a(c.F,h);h=M(c.J,25);for(var k=0;k<f.length;k++){var l=na(c.L[k])?c.L[k]:null,m=h.clone(),q=c.Pa,t=new ih;N(t,1,q);na(l)&&t.fb(l);N(m,7,t);c.F.rc("dt",encodeURIComponent(JSON.stringify(c.Nc.serialize(m))));
q=new uI(a.toJSON());q.ej(c.F.toString());m=e.clone();m.ej(c.F.toString());var w=c,x=q.jc("title");x||(x=xEc(q));t=x+(' when "'+(w.D+('" is "'+(l+'"'))));w=x+(' by "'+(w.D+'"'));t=l?t:w;q.setOption("title",t);m.setOption("title",t);w=new eGc(q,m,0,0,c.Wa,c.$a,c.Ia,c.Aa());c.Qa(w);t=f[k];w.kb(t);c.va.push(w);w=c;x=xEc(q);q=x+(' broken down by "'+(w.D+('" for "'+(l+'"'))));w=x+(' broken down by "'+(w.D+'"'));ps(t,l?q:w);c.H=m}kGc(c);c.La.style.visibility="visible"},a),!1)}
function nGc(a,b,c){var d=uGc(a);(new EV(zI,d.hg())).send(function(a){a?(a=a.Gd(),c&&d.ge(a),iW(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function sGc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=cvc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Kb(d,d);return d};function lGc(a){vO.apply(this,arguments)}r(lGc,vO);lGc.prototype.Via=g("element");function vGc(){tO.call(this);this.Wa.push(this);this.Ba=this.Ia=!0;this.ib="waffle-assistant-dragged-card"}y(vGc,Gzb);vGc.prototype.contains=function(a){return!!A(this.L,function(b){if(b.element==a)return!0})};vGc.prototype.Tia=function(a){var b=vGc.qa.Tia.call(this,a);if(Yo&&Xo||Zo){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=sb(b.querySelectorAll("clippath"),function(a){return a.id}),wGc(b,a);return b};
function wGc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];na(c)&&$a(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=to(a);for(c=0;c<a.length;c++)wGc(a[c],b)};function xGc(){return U('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function yGc(a,b){jY.call(this,a,b);this.C=M(a,8)}y(yGc,jY);p=yGc.prototype;p.mA=ta;p.cz=n("assistantWordCloudFeedback");p.NB=n(2634);p.MB=n(2633);p.Ha=function(){yGc.qa.Ha.call(this);kY(this).appendChild(S(xGc));ss(kY(this),"waffle-assistant-word-cloud-content-container")};
p.uA=function(a){for(var b=Re(this.C,19),c=Re(this.C,20),d=this.Za("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(zGc(this,b,c,e),120<d.clientHeight){zGc(this,b,c,e-1);break}b=this.Aa();c=M(this.C,2);c=Mo(b,c);d=this.Za("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function zGc(a,b,c,d){var e=a.Za("waffle-assistant-word-cloud-words-container");for(a=a.Aa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Mo(a," "));var l=a.createElement("SPAN");a.appendChild(l,Mo(a,b[k]));a.appendChild(e,l);ss(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function pY(a,b,c,d,e,f){mY.call(this,20,e,d,f);this.Ba=a;this.L=b;this.Ia=c;this.D=new vGc;this.Fa(this.D);this.F=null;this.H=0;this.O=null}y(pY,mY);p=pY.prototype;p.Ra=function(){pY.qa.Ra.call(this);this.D.Ne();this.getHandler().V(this.D,"drag",this.r_b).V(this.D,"dragend",this.q_b)};p.gN=n("Analysis");p.wV=function(a){return 0==a};p.EO=function(a){return"WordCloud"==M(a,8).getChartType()?new yGc(a,this.Aa()):new nY(a,this.Ba,this.L,this.Ia,this.R,this.D,this.O,this.Aa())};
p.hN=function(a){pY.qa.hN.call(this,a);a&&kzb(this.D)};p.YHa=function(a){this.getHandler().Oc(a,"content-rendered",this.p_b);this.H++};p.fN=function(a,b){this.O=b||null;pY.qa.fN.call(this,a,b)};p.p_b=function(){0==--this.H&&this.dispatchEvent("Od")};p.r_b=function(){this.F=Er(this.D.Zc.target)};p.q_b=function(a){var b=this.F,c=lG(this.L).C;if(Ik(QL(c,"page",!1,!1)).contains(b)){var d=PL(c,b.x,b.y,"page");c=TL(c,d,"page");b=new Ak(b.x-c.left,b.y-c.top);a.C.getData().BIa(d,b)}this.F=null};p.g1=n(2);function AGc(a){var b=[];if(Me(a,25)&&(a=M(a,25)))for(var c=0;c<Ne(a,1);c++){var d=M(a,1,c);if(Me(d,2)){var e=M(d,2);e&&b.push(BGc(e,CGc(d)))}}return b}function DGc(a){var b=AGc(a);Me(a,6)&&(a=M(a,6))&&b.push(BGc(a,0));return b}function CGc(a){return(a=Me(a,4)?M(a,4):0)?a:0}function BGc(a,b){return{name:a,z2a:b}};function EGc(a,b,c){this.Ba=a;this.Ia=b;this.L=[];this.O=[];this.H=[];this.J=[];this.$=[];this.va=[];this.C={};this.F={};this.R={};this.D={};FGc(this,c)}function GGc(a,b){return a[b]?a[b].values.od():[]}
function FGc(a,b){for(var c=new sk,d=new sk,e=0;e<b.length;e++){for(var f=DGc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(void 0!=a.Ba[m]){var q=a.Ba[m];c.add(q);h.push(q)}void 0!=a.Ia[m]&&(m=a.Ia[m],d.add(m),k.push(m))}HGc(a,h,k)}a.L=c.od();a.O=d.od();Pb(a.L);Pb(a.O);a.H=sb(ec(a.C),function(a){return a.key});Pb(a.H);a.J=sb(ec(a.F),function(a){return a.key});Pb(a.J);a.$=sb(ec(a.R),function(a){return a.key});Pb(a.$);a.va=sb(ec(a.D),function(a){return a.key});Pb(a.va)}
function HGc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)b[d]!=b[e]&&(IGc(a.C,b[d],b[e]),IGc(a.C,b[e],b[d]));for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)IGc(a.F,b[d],c[e]),IGc(a.R,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)c[b]!=c[d]&&(IGc(a.D,c[b],c[d]),IGc(a.D,c[d],c[b]))}function IGc(a,b,c){var d;a[b]?d=a[b].values:d=new sk;d.add(c);a[b]={key:b,values:d}};function JGc(a,b){this.C=a;for(var c={},d=0;d<a.$j();d++)c[a.dd(d).getName().toLowerCase()]=d;this.O=c;c={};for(d=0;d<Ne(a,1);d++)c[M(a,1,d).getName().toLowerCase()]=d;this.R=c;c={};for(d=0;d<this.C.$j();d++)c[M(this.C.dd(d),11)]=d;this.va=c;c={};for(d=0;d<Ne(this.C,1);d++)c[M(M(this.C,1,d),4)]=d;this.Ba=c;c=[];for(d=0;d<a.$j();d++)qY(a.dd(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<Ne(a,1);d++)qY(M(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Ne(a,1);d++){for(var e=M(a,1,d).getName(),
f=!0,h=0;h<KGc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+KGc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Pa=c;this.$a=LGc(a,0);this.$=LGc(a,1);c=[];for(d=0;d<a.$j();d++).8<=M(a.dd(d),6)&&c.push(d);this.Ia=c;c=[];for(d=0;d<a.$j();d++)e=a.dd(d),.95<=Re(e,2).length/M(e,8)&&c.push(d);this.cb=c;c=[];for(d=0;d<Ne(a,3);d++){e=a.dd(M(a,3,d));a:if(.5<Re(e,2).length/M(e,8)||.3>Ne(e,3)/Ne(e,2))e=!1;else{for(f=0;f<Ne(e,10);f++)if(.95<M(e,10,f)/M(e,8)){e=!1;break a}e=!0}e&&c.push(M(a,3,d))}Pb(c);this.Wa=
c;this.F=MGc(a.$j());this.H=MGc(Ne(a,1));this.D=new EGc(this.O,this.R,b)}function MGc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function LGc(a,b){for(var c=[],d=0;d<a.$j();d++)a.dd(d).getType()==b&&c.push(d);return c}function NGc(a,b){if(0==a.length&&0==b.length)return[];for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=OGc(c,a[d]);for(a=0;a<b.length;a++)d=OGc(c,b[a]),c=0<d.length?d:c;return c}
function rY(a,b,c,d,e,f,h,k){var l=[a.J,a.D.L],m=[a.F];c&&(m.push(a.$a),m.push(a.Ia));d&&m.push(a.Wa);e&&m.push(a.cb);null!=h&&-1!=h?l.push(GGc(a.D.R,h)):f&&l.push(a.D.J);k&&l.push(a.D.H);a=NGc(m,l);b=OGc(a,b);return 0<b.length?{index:WX(b),nB:3}:0<a.length?{index:WX(a),nB:1}:PGc()}
function sY(a,b,c,d,e,f){var h=[a.L,a.D.O],k=[a.H];c&&k.push(a.Pa);null!=e&&-1!=e?h.push(GGc(a.D.F,e)):d&&h.push(a.D.$);f&&h.push(a.D.va);a=NGc(k,h);b=OGc(a,b);return 0<b.length?{index:WX(b),nB:3}:0<a.length?{index:WX(a),nB:1}:PGc()}function QGc(a,b){for(var c=5;;){var d=a.C.dd(b),e=VX(Ne(d,2),1)[0];c--;if(qY(UX(d,e))||0==c)return e}}function RGc(a,b){for(var c=5;;){var d=a.C.dd(b),e=VX(Ne(d,3),1)[0];e=M(d,3,e);c--;if(qY(UX(d,e))||0==c)return e}}
function tY(a,b){b=a.C.dd(b);a=b.getName();qY(a)||(b=SGc(Re(b,7)),a=null==b?a:b);return a}function uY(a,b){b=M(a.C,1,b);a=b.getName();qY(a)||(b=SGc(Re(b,2)),a=null==b?a:b);return a}function SGc(a){for(var b=0;b<a.length;b++)if(qY(a[b]))return a[b];return null}function qY(a){return null==a?!1:50>=a.length}function TGc(a,b){return b.toLowerCase()in a.O?a.O[b.toLowerCase()]:-1}function PGc(){return{index:-1,nB:0}}
function UGc(a){for(var b=VX(a.length,2),c=[],d=0;d<b.length;d++)c.push({index:a[b[d]],nB:1});return c}function OGc(a,b){Pb(a);Pb(b);for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var KGc=["average","total","sum","mean","median"];function vY(a){this.$a=a;this.ew=[];this.C=this.Ba=this.va=this.WK=this.wH=null;this.R=[];this.Ia=[];this.O=new sk;this.Pa=new sk;this.$=!1;this.D=[];this.F=[]}p=vY.prototype;p.Ne=function(a,b,c,d,e,f){this.reset();this.wH=b;this.WK=c;this.va=d;this.Ba=a;this.Ia=f;this.R=nwa?e:[];this.C=new JGc(a,e)};
p.t9=function(){VGc(this);var a=[];if(nwa)for(var b=0;b<this.R.length;b++){var c=this.R[b];switch(c.getChartType()){case "BarChart":if(this.Ak(13)||this.Ak(2)){var d=M(c,6);if(d&&-1!=TGc(this.C,d)){var e=WGc(this,c);1<e.length&&(Wo&&this.Ak(23)?wY(this,a,"Scatter chart of "+e[0].name+" vs "+e[1].name,23,2):this.Ak(2)&&wY(this,a,"Correlation of "+e[0].name+" and "+e[1].name,2,1.5))}}break;case "ScatterChart":var f=WGc(this,c);1<f.length&&(Wo&&this.Ak(23)?wY(this,a,"Scatter chart of "+f[0].name+" vs "+
f[1].name,23,2):this.Ak(2)&&wY(this,a,"Correlation of "+f[0].name+" and "+f[1].name,2,1.5));break;case "PieChart":for(var h=void 0,k=[],l=AGc(c),m=0;m<l.length&&-1!=TGc(this.C,l[m].name);m++)k.push(l[m]);h=k;1==h.length&&4==h[0].z2a&&(Wo&&this.Ak(20)?wY(this,a,"Chart of distribution of "+h[0].name,20,2):this.Ak(14)&&wY(this,a,"Distribution of "+h[0].name,14,1.5))}}for(var q=0;q<this.Ia.length;q++){var t=this.Ia[q];if(Me(t,3)){if(!this.Ak(26))break;wY(this,a,t.Tg(),26,2)}}if(this.Ak(1)){var w=this.C.C,
x=sY(this.C,this.F,!1,!0),z=x.index,C=rY(this.C,this.D,!0,!1,!0,!0,z),L=C.index;if(-1!=L&&-1!=z){var P=10<=Ne(w.dd(L),2)?"5 ":"",W=tY(this.C,L),ea=uY(this.C,z);if(W!=ea){var ca=xY(1,[x],[C]);wY(this,a,this.aGa(1)+" "+P+W+" by "+ea,1,ca)}}}if(this.Ak(2)&&1<Ne(this.C.C,1)){a:{var oa=this.C,wa=this.F;if(2>oa.H.length)var ua=[PGc(),PGc()];else{var ya=sY(oa,wa,!1,!1,void 0,!0),Xa=ya.index;if(-1!=Xa){var Wa=GGc(oa.D.D,Xa);if(0<Wa.length){var Ra=[ya],wb=WX(Wa),Nc=2,Rb=OGc(Wa,wa);0<Rb.length&&(wb=WX(Rb),
Nc=3);Ra.push({index:wb,nB:Nc});ua=Ra;break a}}ua=UGc(2<=oa.L.length?oa.L:oa.H)}}var Sc=ua,Tc=uY(this.C,Sc[0].index),fe=uY(this.C,Sc[1].index);if(Tc!=fe){var Ad=xY(1,Sc,[]);wY(this,a,"Correlation of "+Tc+" and "+fe,2,Ad)}}if(this.Ak(3)){var Tb=this.C.C,Ue=sY(this.C,this.F,!0),pb=Ue.index;if(-1!=pb){var le=xY(1,[Ue],[]);wY(this,a,this.EP(Re(M(Tb,1,pb),3),3)+" of "+uY(this.C,pb),3,le)}}if(this.Ak(5)){var ue=this.C.C,tf=sY(this.C,this.F,!0,!0),Mg=tf.index,Yg=rY(this.C,this.D,!0,!0,!1,!0,Mg),Vh=Yg.index;
if(-1!=Mg&&-1!=Vh){var Di=uY(this.C,Mg),Ei=ue.dd(Vh),Nk=tY(this.C,Vh);if(0<Ne(Ei,3)&&Nk!=Di){var nl=xY(1,[tf],[Yg]),xm=RGc(this.C,Vh);wY(this,a,this.EP(Re(M(ue,1,Mg),3),5)+" of "+Di+" when "+Nk+" is "+UX(Ei,xm),5,nl)}}}if(this.Ak(9)){var sj=sY(this.C,this.F,!1,!0),Bg=sj.index,Ok=rY(this.C,this.D,!0,!1,!0,!0,Bg),Xi=Ok.index;if(-1!=Xi&&-1!=Bg){var ym=uY(this.C,Bg),nk=tY(this.C,Xi);if(nk!=ym){var ol=xY(1,[sj],[Ok]);wY(this,a,nk+" with "+this.xia(9)+" "+ym,9,ol)}}}if(this.Ak(10)&&0<Ne(this.C.C,1)){var Yi=
sY(this.C,this.F),mi=xY(1,[Yi],[]),Wh=uY(this.C,Yi.index);wY(this,a,this.xia(10)+" "+Wh,10,mi)}if(this.Ak(11)){var zm=this.C.C,Ol=rY(this.C,this.D,!0,!0,!1,!1,-1),ok=Ol.index;if(-1!=ok){var gs=tY(this.C,ok);if(0<Ne(zm.dd(ok),3)){var vh=xY(1,[],[Ol]);wY(this,a,"Most frequent "+gs,11,vh)}}}if(this.Ak(12)){var eo=this.C.C,Dp=sY(this.C,this.F,!0),Pk=Dp.index;a:{var Vq=this.C;if(1==Vq.$.length){var Wq=Vq.$[0];if(!M(Vq.C.dd(Wq),5)){var Xq=Wq;break a}}Xq=-1}var Qk=Xq;if(-1!=Qk&&-1!=Pk){var Am=uY(this.C,
Pk),fo=eo.dd(Qk);if(0<Ne(fo,2)){var hs=xY(1,[Dp],[]),sx=QGc(this.C,Qk);wY(this,a,this.EP(Re(M(eo,1,Pk),3),12)+" of "+Am+" "+WX(XGc)+" "+UX(fo,sx),12,hs)}}}if(this.Ak(15)){var go=this.C.C,pl=sY(this.C,this.F,!0),Rk=pl.index,Yq=rY(this.C,this.D,!1,!0,!1,!0,Rk),Pl=Yq.index;if(-1!=Rk&&-1!=Pl){var Sk=uY(this.C,Rk),pk=tY(this.C,Pl);if(pk!=Sk){var Fi=go.dd(Pl);if(2<=Ne(Fi,3)){var Bm=xY(1,[pl],[Yq]),is=VX(Ne(Fi,3),2);wY(this,a,"Compare "+this.EP(Re(M(go,1,Rk),3),15)+" "+Sk+" for "+pk+" "+UX(Fi,M(Fi,3,is[0]))+
" and "+UX(Fi,M(Fi,3,is[1])),15,Bm)}}}}if(this.Ak(16)){var Cm=rY(this.C,this.D,!0,!0,!1,!1),Ep=Cm.index;if(-1!=Ep){var rn=tY(this.C,Ep),Tj=xY(1,[],[Cm]);wY(this,a,"List unique values in "+rn,16,Tj)}}if(this.Ak(17)){var ql=this.C.C,sn=rY(this.C,this.D,!0,!0,!1,!1),qk=sn.index;if(-1!=qk){var tn=ql.dd(qk),ho=tY(this.C,qk);if(!(1>Ne(tn,3))){var Zq=RGc(this.C,qk),un=xY(1,[],[sn]);wY(this,a,"What percentage of "+ho+" is "+UX(tn,Zq),17,un)}}}if(this.Ak(13)){var Fp=this.C.C,Gp=sY(this.C,this.F,!0,!0),$q=
Gp.index,io=rY(this.C,this.D,!0,!0,!1,!0,$q),vn=io.index;if(-1!=$q&&-1!=vn){var Dm=uY(this.C,$q),jo=tY(this.C,vn);if(jo!=Dm){var rk=xY(1,[Gp],[io]);wY(this,a,this.EP(Re(M(Fp,1,$q),3),13)+" of "+Dm+" by "+jo,13,rk)}}}if(Wo&&this.Ak(18)){var tt=sY(this.C,this.F),ut=tt.index;if(-1!=ut){var fv=xY(2,[tt],[]);wY(this,a,"Histogram of "+uY(this.C,ut),18,fv)}}if(this.Ak(24)){var FP=rY(this.C,this.D,!0,!0),sZ=FP.index;if(-1!=sZ){var XI=xY(1,[FP],[]);wY(this,a,"Count of "+tY(this.C,sZ),24,XI)}}if(this.Ak(25)){var tZ=
this.C.C,YI=rY(this.C,this.D,!0,!0),vA=YI.index;if(-1!=vA){var qv=tZ.dd(vA),ZI=QGc(this.C,vA),$I=xY(1,[YI],[]);wY(this,a,"Count when "+tY(this.C,vA)+" is "+UX(qv,ZI),25,$I)}}var GP=3>a.length;if((GP||0==VX(5,1)[0])&&this.Ak(7)){var W$=this.C.C,HP=sY(this.C,this.F,!1,!0),wA=rY(this.C,this.D,!1,!1,!1,!0,HP.index);if(-1!=wA.index&&-1!=HP.index){var Im=W$.dd(wA.index),aJ=tY(this.C,wA.index),FE=uY(this.C,HP.index);if(0<Ne(Im,2)&&aJ!=FE){var IP=xY(1,[HP],[wA]),xA=QGc(this.C,wA.index);wY(this,a,"Show "+
FE+" for "+aJ+" "+UX(Im,xA),7,IP)}}}if((GP||0==VX(5,1)[0])&&this.Ak(8)){var bJ=this.C.C;a:{var Cx=this.C,Dx=this.D;if(2>Cx.F.length)var Ft=[PGc(),PGc()];else{var JP=rY(Cx,Dx,!0,!1,!1,!1,void 0,!0),yA=JP.index;if(-1!=yA){var cJ=GGc(Cx.D.C,yA);if(0<cJ.length){var KP=[JP],rv=WX(cJ),zA=2,GE=OGc(cJ,Dx);0<GE.length&&(rv=WX(GE),zA=3);KP.push({index:rv,nB:zA});Ft=KP;break a}}var Ex=UGc(2<=Cx.J.length?Cx.J:Cx.F);Ex[0].index!=yA&&(Ex[1]=Ex[0],Ex[0]=JP);Ft=Ex}}var AA=Ft,LP=AA[0].index;if(1<bJ.$j()&&-1!=LP){var BA=
AA[1].index,MP=bJ.dd(BA),sv=tY(this.C,BA),ns=tY(this.C,LP);if(0<Ne(MP,2)&&sv!=ns){var kQa=xY(1,[],AA),X$=QGc(this.C,BA);wY(this,a,"What is "+ns+" where "+sv+" is "+UX(MP,X$),8,kQa)}}}this.ew=YGc(a)};function VGc(a){if(a.$){var b=RI(a.$a).Fj(),c=Se(a.C.C,4);A(b,function(b){var d=b.left,f=b.width;c&&(d=b.top,f=b.height);for(b=0;b<f;b++){var h=a.C.va[d+b],k=a.C.Ba[d+b];h&&0<=h&&Cb(a.D,h);k&&0<=k&&Cb(a.F,k)}})}}p.reset=function(){this.ew=[];this.F=[];this.D=[];this.Pa=new sk;this.O=new sk};p.u9=function(){return ai(this.ew.slice())};
function YGc(a){Pb(a,function(a,c){return c.weight-a.weight});return sb(a,function(a){return a.xqa})}function wY(a,b,c,d,e){e=a.ZFa(d,e);a.Pa.contains(c)||(b.push({xqa:{query:c,$m:void 0,type:d},weight:e}),a.O.add(d),a.Pa.add(c))}p.Ak=function(a){return!this.O.contains(a)};function ZGc(a,b){return a.u9().then(function(a){return a.length<=b?a:Lb(a,0,b)},null,a)}function xY(a,b,c){A(b,function(b){3==b.nB&&a++});A(c,function(b){3==b.nB&&a++});return a}
function WGc(a,b){var c=[];b=AGc(b);for(var d=0;d<b.length;d++){var e=a.C,f=b[d].name;if(-1==(f.toLowerCase()in e.R?e.R[f.toLowerCase()]:-1))break;c.push(b[d])}return c}p.EP=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=$Gc;break a;case 4:a=aHc;break a}a=bHc}return WX(a)};p.aGa=function(){return WX(cHc)};p.xia=function(){return WX(dHc)};
var bHc=["Average","Median"],$Gc=["Total","Average","Median"],aHc=["Median"],dHc="Minimum Maximum Most Least Highest Lowest".split(" "),cHc=["Top","Bottom"],XGc=["before","after"];function eHc(a,b,c){vY.call(this,a);this.J=[];this.L=this.H=null;this.Wa=b;this.gb=c;this.cb=Uq(new Tq,10).build()}r(eHc,vY);p=eHc.prototype;p.t9=function(){this.reset();vY.prototype.t9.call(this);mwa&&fHc(this)};p.reset=function(){vY.prototype.reset.call(this);this.J=[];this.H&&(this.H.cancel(),this.H=null)};p.u9=function(){return mwa&&this.H?this.H.then(function(){return this.J.slice()},null,this):vY.prototype.u9.call(this)};p.ZFa=function(a,b){return Math.pow(Math.random(),1/(gHc(a)*b))};
p.Mf=da("L");function gHc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;default:return.3}}
function fHc(a){var b=null;a.H=new Zh(function(a){if(!this.L||this.L.getStatus().getState().Th())this.J=this.ew,a();var c=RE(this.wH.rect),e=sb(this.ew,function(a){return a.query});c=Bn(An(Em(Gm(Hm(this.L.Ke("/answers/parsesuggestions").Ef("gid",this.wH.fd,"range",c),v(function(b){hHc(this,b).then(a)},this)),v(function(b){8==b.errorCode&&this.gb.Xb(2833,this.cb);this.J=this.ew;a()},this)).setContent(["queries",jj(e)]).setTimeout(2E3),1)),"POST");dp&&this.WK&&null!=this.va&&(e=0==this.WK.rect.width||
0==this.WK.rect.height?"":RE(this.WK.rect),c.Ef("headerRange",e,"tableRecordDimension",""+this.va));b=c.ye()},a);fi(a.H,function(){b&&b.dispose()})}function hHc(a,b){return a.Wa.C.D.C.then(function(){var a=[];if(b.Mk())for(var d=b.Ye(),e=0;e<d.length;e++){var f;if(f=d[e])f=!!this.Ba&&!!M(this.Ba,4),f=sEc(this.Wa,d[e],this.wH,f),f=tEc(f);f&&(this.ew[e].$m=d[e],a.push(this.ew[e]))}this.J=a},function(){this.J.length=0},a)};var iHc={};Zb({z1a:{type:0,lA:"",iA:[]},cda:{type:1,lA:"Sum",iA:[3,5,13,12,15]},Dba:{type:2,lA:"Average",iA:[3,5,13,12,15]},zca:{type:3,lA:"Mode",iA:[3]},N1a:{type:4,lA:"Variance",iA:[3]},M0a:{type:5,lA:"Standard deviation",iA:[3]},dva:{type:6,lA:"Median",iA:[3,5,13,12]},bU:{type:7,lA:"Count",iA:[24,25]},G0a:{type:8,lA:"Bottom",iA:[1,10,14]},H0a:{type:9,lA:"Top",iA:[1,11,10,14]}},function(a){iHc[a.type]=a});function jHc(a){if(a=iHc[a])return a};function kHc(a){vY.call(this,a);this.H=[]}r(kHc,vY);p=kHc.prototype;p.reset=function(){vY.prototype.reset.call(this);this.H=[]};p.ZFa=function(a,b){return 1+b};p.Ak=function(a){return!this.O.contains(a)&&0<lHc(this,a).length};p.aGa=function(a){return mHc(this,a)};p.EP=function(a,b){return mHc(this,b)};p.xia=function(a){return mHc(this,a)};function nHc(a,b){a.reset();A(b,function(b){A(Re(b,1),function(b){a.H.push(M(b,1))},a)},a);yEc(a.H);a.t9();return ZGc(a,3)}
function lHc(a,b){return rb(a.H,function(a){return zb(jHc(a).iA,b)},a)}function oHc(a,b){a=xb(a.H,function(a){return jHc(a).type==b},a);return jHc(a)}function mHc(a,b){b=lHc(a,b);return oHc(a,WX(b)).lA};function pHc(){this.F=this.D="";this.L=!1;this.H=0;this.O=!1;this.J=0;this.C=""};var qHc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),rHc=[{Yj:["Thank you","Thankyou","Thanks"],Bq:"No problem"},{Yj:["you are amazing","This is great","omg"],Bq:"Happy to help"},{Yj:["I love you"],Bq:"Must be in the air"},{Yj:["How do you know","How are you so smart"],Bq:"It's all in the data"},{Yj:["Are you sure"],Bq:"Send feedback if this doesn't seem correct to help improve accuracy"},{Yj:["How are you"],Bq:"Pretty good, thanks"},
{Yj:["Hi","Hello","Hey"],Bq:"Hi, there. Try asking a question about your data."},{Yj:["You are stupid","This is dumb","You are wrong"],Bq:"Help improve this experience by sending feedback"},{Yj:["How smart are you"],Bq:"Pretty smart"}];function sHc(a){for(var b=0;b<rHc.length;++b)if(-1!=yb(rHc[b].Yj,function(b){return Ma(a,b)}))return b;return-1};function tHc(a,b,c,d){var e=new iEc;D(e,2,c);A(b,function(a){Yc(e,1).push(a)});D(e,3,d);d=new TX;D(d,1,a);D(d,3,b[c]);bd(d,11,e);return d}function uHc(a,b,c,d){var e=new eEc;D(e,2,c);A(b,function(a){Yc(e,1).push(a)});D(e,3,d);d=new TX;D(d,1,a);D(d,2,b[c]);bd(d,10,e);return d}function vHc(a){var b=new cEc;A(a,function(a){var c=a.type;Yc(b,1).push(c);a.nEa&&(a=a.nEa,Yc(b,2).push(a))});return b}function wHc(a){var b=new gEc;A(a,function(a){a=a.type;Yc(b,1).push(a)});return b}
function xHc(a,b,c,d){var e=new kEc;a&&D(e,1,a);b&&D(e,2,b);for(a=0;a<c.length;a++)b=c[a],Yc(e,3).push(b);D(e,4,d);return e};function yY(a,b){this.D=a;this.C=b}yY.prototype.getChartType=g("D");var zY={2:new yY("ColumnChart","Column chart"),3:new yY("LineChart","Time series"),4:new yY("ScatterChart","Scatter chart"),5:new yY("PieChart","Pie chart"),10:new yY("Histogram","Histogram"),7:new yY("LineChart","Line chart")};function AY(a,b,c,d,e,f,h){this.D=a;this.bB=b;this.H=(void 0===h?null:h)||b;this.C=d;this.$m=c;this.Wa=d?Re(d,6):[];this.$a=d?Re(d,7):[];this.Pa=d?Re(d,8):[];this.error=e||1;this.interpretation=d&&Me(d,4)?M(d,4):null;this.va=new pHc;this.O=d?Re(d,12):[];this.Ia=d?Re(d,21):[];this.Ba=f;this.F=null;this.$=this.J=!1;this.L=[];this.R=null;Wo&&yHc(this)}function zHc(a){return 1==a.error&&null!=a.$m}
function AHc(a){return{QL:BHc(a),interpretation:a.interpretation,bB:a.bB,$m:a.$m,mL:1<a.bB.length&&1<a.bB[0].length,ek:a.ek(),Ypa:a.$,px:a.px(),h8:a.L}}AY.prototype.ek=function(){return Wo&&null!=this.F&&(this.F in zY?!0:!1)&&2<this.H.length};AY.prototype.px=function(){return Vo&&F(E(),"feapt")&&null!==this.C&&Me(this.C,24)};AY.prototype.getChartType=function(){if(!this.ek())return null;var a=this.F;if(a in zY)return zY[a].getChartType();throw Error("Unknown chart type.");};
function CHc(a){a.ek();return a.H[0][0]}function DHc(a){return sb(Re(a.C,22),function(b){if(M(b,2)){var c=a.Ba.C;return PE(M(b,2),c)}},a)}function EHc(a){return{QL:BHc(a),error:FHc(a)}}function GHc(a,b,c){var d=c.length;if(0==d)return a;1<d&&Gb(a,10);c=M(c[0],1);2<d&&9==c&&Gb(a,4);2<d&&Gb(a,5);2!=c&&3!=c&&12!=c&&Gb(a,3);zb(b,10)&&zb(a,10)&&dba(a,function(a){return 10!=a});return a}
function yHc(a){var b=null;a.J=!1;a.F=null;if(a.C&&Me(a.C,17)){var c=M(a.C,17);a.$=M(c,4)||!1;var d=Re(c,3),e=GHc(Re(c,1),d,Re(a.C,18));0<d.length&&(0==e.length||1>=a.H.length||1>a.H[0].length)?a.L.push("Charts for this question are not supported."):(0<d.length?(b=rb(e,function(a){return zb(d,a)}),c=rb(d,function(a){return!zb(e,a)}),Gb(c,6),0<b.length?(a.J=!0,a.F=b[0],b=a.F):zb(d,10)&&zb(e,2)?(a.J=!0,a.F=2,Gb(c,10),b=a.F):(b=0<c.length?c[0]:6,a.J=!0,a.F=HHc(a,e)),0<c.length&&a.L.push("Requested chart type is not supported for this question.")):
0<e.length&&1<a.H.length&&1<a.H[0].length&&(a.F=HHc(a,e),a.J=M(c,2)||!1,20<=a.H.length||3<=a.H[0].length)&&(a.J=!0),a.R=xHc(a.F,b,e,a.J))}}function HHc(a,b){if(!Re(a.C,18).length)return b[0];a=IHc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(zb(b,a[c]))return a[c];return b[0]}function JHc(a,b,c){var d={};null!=b?(d.v=KHc(a,b,c),d.f=b):d.v=null;return d}
function IHc(a){for(var b=new bI,c=a.H[0],d=Lb(a.H,1),e=Re(a.C,18),f=[],h=0;h<c.length;h++)e[h]&&Me(e[h],1)?f.push(LHc(M(e[h],1))):f.push(0==h?"string":"number"),b.Bs({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){h=[];for(var k=0;k<c.length;k++)h.push(JHc(a,d[e][k],f[k]));b.Su(h)}return b}
function KHc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return a=K5a(a.Ba.L.C).DECIMAL_SEP,b=(b||"0").replace(new RegExp("[^-0-9"+a+"]","g"),""),b=b.replace(a,"."),lb(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Sa(a[0])&&Sa(a[1])&&(Sa(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Sa(a[d])&&
(c[d]=lb(a[d]));"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function LHc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function MHc(a){if(!Me(a.C,9))return"";if(Me(a.C.getError(),3))switch(M(a.C.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.C.getError().Sj()||""}
function FHc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return MHc(a)||"Sorry, couldn't understand your question.";case 7:return a=sHc(a.D),-1!=a?rHc[a].Bq:""}return""}
function BHc(a){var b=[];if(zHc(a)){var c=[];A(Ib(a.Wa,a.Pa),function(a){c.push(NHc(a,"waffle-assistant-answercard-question-unused-phrase"))});A(a.$a,function(a){c.push(NHc(a,"waffle-assistant-answercard-question-used-entity"))});Pb(c,function(a,b){return a.mT>b.mT?1:-1});var d=0;A(c,function(c){var e=c.length,h=c.mT;h>d?b.push({text:a.D.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.D.substring(h,d),className:c.Fk}))});d<a.D.length&&b.push({text:a.D.substring(d),className:null})}else b.push({text:a.D,
className:null});return b}function NHc(a,b){return{mT:M(a,2),length:M(a,3),Fk:b}};function OHc(a,b,c,d){J.call(this);this.$=a;this.R=b;this.va=c;this.Wa=d;this.Va=new Ti(this);this.Fa(this.Va);this.C=new oW;this.Fa(this.C);this.O="";this.L=[];this.F=this.D=this.J=null;this.H=!1;Zwc(this.C,this.$);this.C.Ba=10;this.C.gb=!0;this.C.R=!1;this.C.SRa("waffle-assistant-visible");this.C.L=Ta("waffle-assistant-dragged-formula").split(" ");this.C.Ne();this.Va.V(this.C,Swc,this.Ia).V(this.C,Vwc,this.Pa).V(this.C,Wwc,this.Ba)}y(OHc,J);
OHc.prototype.Ia=function(a){a=ob(this.$.childNodes,a.C);this.O=this.L[a]};
OHc.prototype.Pa=function(a){var b=a.event instanceof Hs?a.event.Am:a.event;this.H?(a.J.pz(b,!0),a.preventDefault()):(wr(a.F,a.event.clientX,a.event.clientY),a=xr(a.F),b=lG(this.R).C,Ik(QL(b,"page",!1,!1)).contains(a)?(a=PL(b,a.x,a.y,"page"),(b=rF(RI(this.va),a.y,a.x))?a=new Ak(b.gc(),b.kc()):b=Tk(a),this.J=a,this.D&&this.D.getRect().equals(b)||(a=lG(this.R),H(this.D),this.D=rrc(a,b,"waffle-assistant-formula-insertion-rect"),this.Fa(this.D),tM(a.O,"default",this.D),H(this.F),this.F=OM(a,b,"waffle-assistant-formula-insertion-border",
2,0),this.Fa(this.F),ppb(this.F,"#000"),this.F.setVisible(!0))):PHc(this))};OHc.prototype.Ba=function(a){if(this.J){ZM(lG(this.R),!1);var b=this.J,c=RI(this.va);b=new hL(c,b,this.O);this.Wa.C(b);this.dispatchEvent(new I("formula_inserted"))}a.J.pz(null,!0);a.preventDefault();this.O="";PHc(this)};function PHc(a){a.J=null;H(a.D);a.D=null;H(a.F);a.F=null};function QHc(){return U('<div class="waffle-assistant-answers-card-remove">'+T(xw({icon:"docs-icon-img docs-icon-trash"}))+"</div>")}
function RHc(a){var b=a.error,c=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+T(xw({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';c?(b=T(b)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+b+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+T(b)+"</div>";
return U(a+"</div></div>")};function SHc(a){var b=U,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+THc({QL:a.cB.QL}),d={bB:a.cB.bB,$m:a.cB.$m,interpretation:a.cB.interpretation,mL:a.cB.mL,ek:a.cB.ek,px:a.cB.px,Ypa:a.cB.Ypa,h8:a.cB.h8};!d.bB||za(d.bB);var e=d.bB;a=d.$m;var f=d.mL,h=d.ek,k=d.px,l=d.Ypa;za(d.h8);var m=d.h8;d=d||{};d=d.interpretation;d=""+('<div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+cu("Answer")+'"><span aria-hidden="true">Answer</span></div>'+
(d?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+T(d)+"</div></div>":"")+"");var q='<div class="waffle-assistant-answercard-answer-container">'+U(d)+'<div class="waffle-assistant-answercard-answer-content">';if(e){if(!l)if(h&&(q+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-pivot-tab">PIVOT TABLE</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>'),
k)q+='<div class="waffle-assistant-answercard-pivot-content"></div>';else{q+='<div class="waffle-assistant-answercard-answer">';if(f){q+='<div class="waffle-assistant-answercard-answer-rowheader">';l=e[0];d=l.length;for(var t=0;t<d;t++)q+='<span class="waffle-assistant-answercard-answer-col">'+T(l[t])+"</span>";q+="</div>"}q+='<div class="waffle-assistant-answercard-answer-rows">';l=Zt("waffle-assistant-answercard-answer-row"+(f?" waffle-assistant-answercard-answer-list-row":""));d=e.length;for(t=
0;t<d;t++){var w=e[t];if(f&&0==t)w="";else{var x=l;za(w);x='<div class="'+V(x)+'">';for(var z=w.length,C=0;C<z;C++){var L=w[C];x=L?x+('<span class="waffle-assistant-answercard-answer-col">'+T(L)+"</span>"):x+('<span class="'+V("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">N/A</span>')}w=U(x+"</div>")}q+=w}q+="</div></div>"}q+=h?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':
""}if(0<m.length){q+='<div class="waffle-assistant-answercard-info-msgs">';e=m.length;for(f=0;f<e;f++)q+='<div class="waffle-assistant-answercard-info-msg">* '+T(m[f])+"</div>";q+="</div>"}q+='<div class="waffle-assistant-answercard-footer">';k&&(q+='<div class="waffle-assistant-answercard-insert-pivot">INSERT PIVOT</div>');h&&(q+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');k||(q+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-help">Click to copy or drag to insert</div><div class="waffle-assistant-answercard-formula-display"><div class="waffle-assistant-answercard-formula-icon">'+
T(xw({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+T(a)+"</div></div></div></div></div>");a=U(q+"</div></div></div>");return b(c+a+"</div></div>")}
function THc(a){za(a.QL);a=a.QL;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+cu("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+V(e.className)+'">'+T(e.text)+"</span>":T(e.text)}return U(b+"</div></div></div>")}
function UHc(a){a=a.px;return U(""+T(QHc())+(a?'<div class="waffle-assistant-button-separator"></div>'+T(ev({xd:"waffle-assistant-zoom-button",content:$t(""+T(xw({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})):"")+"")};function VHc(a){this.C=a}function WHc(a,b){var c=new SX;D(c,3,b);D(c,8,Dwa);b=new yU;bd(b,4,c);c=new oq;bd(c,46,b);c=ar(Uq(new Tq,10),c).build();a.C.Xb(2753,c)};function BY(a,b,c,d,e,f,h,k,l,m,q,t,w){jY.call(this,new IG,w);this.D=a;this.Ph=DHc(a);this.jb=a.ek();this.$a=a.px();this.sf=q;this.$=this.C=this.Kb=null;this.Ab=a.ek()&&a.J;this.Yd=a.$;this.Nb=!1;this.xg=b;this.rf=c;this.Me=d;this.Fi=l;this.Ei=h;this.R=e;this.ah=f;this.Dg=k;this.Qe=m;this.gb=Uq(new Tq,10).build();this.Hd=new Yu("",new gX,this.Aa());this.Qa(this.Hd);this.kh=t;this.wb=new Yu("",new gX,this.Aa());this.Qa(this.wb);this.Yb=new Yu("",new gX,this.Aa());this.Qa(this.Yb);this.va=null;this.O=
new Yu("",new AW,this.Aa());this.Qa(this.O);this.H=a.va;this.cb=new Yu("",new AW,this.Aa());this.Qa(this.cb);this.Cb=new Yu("",new gX,this.Aa());this.Qa(this.Cb);this.L=new mV;this.Qa(this.L);this.Wa=new yM("");this.Qa(this.Wa);this.J=null;this.xc=IHc(this.D);this.kd=new xW(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");this.Fa(this.kd);this.yd=!1}y(BY,jY);p=BY.prototype;p.Tha=g("Dg");p.Ha=function(){BY.qa.Ha.call(this);GFc(this).appendChild(S(UHc,{px:this.$a}))};
p.Ra=function(){BY.qa.Ra.call(this);var a=this.Za("waffle-assistant-answers-card-remove");this.Hd.kb(a);fY(a,"Remove card",0);this.getHandler().Oc(this.Hd,"action",this.H_b);if(this.D.px()){a=RI(this.rf).fc();var b=this.D;b.px();b=b.C?M(b.C,24):null;var c=wAc(this.kh,b);this.Kb=new xAc(c,b,this.Fi.L.C,this.sf,a,this.Me)}else this.getHandler().V(this.O,"action",this.mAb).V(this.cb,"action",this.Jrb).Oc(this.O,"action",this.VMa).Oc(this.cb,"action",this.RHb)};
function XHc(a){function b(b,d,e,f){var c=new kV("");c.kb(a.Za(b));a.L.Qa(c);a.getHandler().Oc(c,"action",v(a.OHb,a,d));f||c.setVisible(!1);e&&a.L.oH(c)}a.L.kb(a.Za("waffle-assistant-answercard-tabs"));a.getHandler().V(a.L,"select",a.GCb);b("waffle-assistant-answercard-formula-tab",0,!a.Ab,!a.$a);b("waffle-assistant-answercard-pivot-tab",1,!a.Ab,a.$a);b("waffle-assistant-answercard-chart-tab",2,a.Ab,!0)}
function YHc(a){var b=M(a.D.C,17);b=Re(b,1);for(var c=0;c<b.length;c++)a.Wa.Fd(ZHc(b[c]));a.Wa.kb(a.Za("waffle-assistant-answercard-chart-type-select"));Uv(a.Wa,ZHc(a.D.F));b=a.Za("waffle-assistant-answercard-insert-chart");a.Cb.kb(b);$Hc(a);a.getHandler().V(a.Cb,"action",a.E_b).V(a.Wa.wc(),"action",a.Clb)}
p.uA=function(a){kY(this).appendChild(S(SHc,{cB:AHc(this.D)}));if(this.D.px()){this.jb&&(XHc(this),YHc(this));var b=this.Za("waffle-assistant-answercard-insert-pivot");this.wb.kb(b);b=this.Za("waffle-assistant-zoom-button");this.Yb.kb(b);fY(b,"Preview Pivot Table");this.getHandler().V(this.wb,"action",this.F_b).V(this.Yb,"action",this.G_b);aIc(this);this.C=this.Aa().Ha("CANVAS","waffle-pivottable-pivot-canvas-border");b=this.Za("waffle-assistant-answercard-pivot-content");this.Aa().appendChild(b,
this.C);zAc(this.Kb,this.C)}else this.O.kb(this.Za("waffle-assistant-answercard-see-formula-link")),this.cb.kb(this.Za("waffle-assistant-answercard-hide-formula-link")),this.va=new OHc(this.Za("waffle-assistant-answercard-formula-text-container"),this.xg,this.rf,this.Me),b=this.vd(),this.va.H=b,this.va.L=[this.D.$m],this.Fa(this.va),b=this.Za("waffle-assistant-answercard-formula-text"),ps(b,"Formula: "+(this.D.$m+". Click/Press ENTER to copy or drag to insert on to sheet.")),this.getHandler().Oc(this.va,
"formula_inserted",this.QHb).Yg(this.Za("waffle-assistant-answercard-formula-text"),He,this.Rqb),bIc(this,this.Qe),cIc(this),this.Qe&&(dIc(this,!0),this.getHandler().Gc(this.O,"action",this.VMa)),this.jb&&(this.Yd?(eIc(this,this.D.getChartType()),this.Nb=!0):XHc(this),YHc(this));a()};p.sM=function(){return this.jb&&!this.Yd&&!this.Ab};function ZHc(a){if(a in zY)return new yt(zY[a].C,a);throw Error("Unknown chart type.");}
p.Clb=function(a){a=a.target.hb();if(a in zY)eIc(this,zY[a].getChartType());else throw Error("Unknown chart type model.");};function fIc(a,b){a.H.F&&b.setOption("subtitle",a.H.F);b.setOption("hAxis.logScale",a.H.L);b.setOption("vAxis.logScale",a.H.O);a.H.C&&b.setOption("legend.position",a.H.C);a.H.H&&b.setOption("hAxis.formatOptions.scaleFactor",a.H.H);a.H.J&&b.setOption("vAxis.formatOptions.scaleFactor",a.H.J)}
function eIc(a,b){a.J=new yG;N(a.J,1,b);N(a.J,2,a.D.interpretation||"");if("Histogram"===b)b=CHc(a.D),N(a.J,3,b),N(a.J,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.xc.Xc(0)&&(b=a.xc.Qf(0),N(a.J,3,b),b=1),1==a.xc.getNumberOfColumns()-b?(b=a.xc.Qf(b),N(a.J,6,b)):N(a.J,6,"Values");else{b=a.J;var c=CHc(a.D);N(b,3,c);c=a.D;c.ek();N(b,6,c.H[0][1]||"")}b=XFc(a.J);b.ge(a.xc);c=a.Za("waffle-assistant-answercard-chart");b=YFc(b,c);iW(b,b.Gd());fIc(a,b);b.setOption("title",a.H.D);JW(b,
c,a.sf.C,a.R,Zo);a.Nb=!0}p.F_b=function(){yAc(this.Kb);this.dispatchEvent("close-sidebar");this.R.C(35559,this.gb)};p.G_b=function(){this.R.C(35587,this.gb);H(this.$);this.$=new fX(this.Kb,this.D.interpretation||"",this.R,this.gb,35588,this.Aa());this.$.render();this.Fa(this.$);uEc(this.$,this.vd())};
p.E_b=function(){if(this.J){var a=XFc(this.J);a.ge(this.xc);fIc(this,a);this.H.D&&a.setOption("title",this.H.D);iW(a,a.Gd());var b=this.Ba,c=this.xc,d=this.D.F,e=new mEc;D(e,1,d);d=new SX;bd(d,11,e);e=new yU;bd(e,4,d);d=new oq;bd(d,46,e);this.dispatchEvent(new xFc(a,b,c,2874,void 0,void 0,d))}};p.mA=function(){ps(this.La,"Answer Card for question: "+this.D.D)};p.tA=Qh;p.cz=n("assistantAnswersFeedback");p.NB=n(2628);p.MB=n(2627);p.a6=n("Was this answer correct?");p.Kia=n("Correct");p.Jia=n("Incorrect");
p.eN=g("D");p.vA=function(a){BY.qa.vA.call(this,a);this.va&&(this.va.H=a);this.$&&uEc(this.$,a);cIc(this);$Hc(this);aIc(this)};p.f1=function(){BY.qa.f1.call(this);if(!this.yd){var a=this.kd,b=this.Ph;zW(a);for(var c=0;c<b.length;c++)oxc(a,b[c]);this.yd=!0}};p.JT=function(){BY.qa.JT.call(this);zW(this.kd);this.yd=!1};p.GCb=function(){switch(oV(this.L)){case 0:gIc(this,!1);break;case 1:gIc(this,!1);aIc(this);break;case 2:gIc(this,!0);aIc(this);break;default:oV(this.L)}};
function gIc(a,b){Q(a.Za("waffle-assistant-answercard-chart-container"),b);a.$a?Q(a.Za("waffle-assistant-answercard-pivot-content"),!b):(Q(a.Za("waffle-assistant-answercard-answer"),!b),Q(a.Za("waffle-assistant-answercard-formula-holder"),!b));$Hc(a);!a.Nb&&b&&eIc(a,a.D.getChartType())}function cIc(a){var b=a.Db("waffle-assistant-answercard-formula-help");b&&Q(b,!a.vd())}function $Hc(a){var b=(a.Yd||2==oV(a.L))&&!a.vd();a.Cb.setVisible(b)}
function aIc(a){var b=a.$a&&!a.vd()&&(!a.jb||1==oV(a.L));a.wb.setVisible(b)}function bIc(a,b){a.O.setVisible(!b);a.cb.setVisible(b);Q(a.Za("waffle-assistant-answercard-formula"),b);b?a.Za("waffle-assistant-answercard-formula-text").focus():(a.O.La.focus(),a.O.Qp(!0))}p.H_b=function(){WHc(this.ah,!0);this.dispatchEvent(new I("rc"))};p.mAb=function(){bIc(this,!0)};p.Jrb=function(){bIc(this,!1)};p.VMa=function(){dIc(this,!0)};p.RHb=function(){dIc(this,!1)};
function dIc(a,b){var c=new SX;D(c,9,b);b=new yU;bd(b,4,c);c=new oq;bd(c,46,b);c=ar(Uq(new Tq,10),c).build();a.R.Xb(2849,c)}p.OHb=function(a){var b=this.D.R,c=new lEc;bd(c,1,b);switch(a){case 0:D(c,2,2);break;case 1:D(c,2,3);break;case 2:D(c,2,1);break;default:D(c,2,0)}a=new SX;bd(a,10,c);c=new yU;bd(c,4,a);a=new oq;bd(a,46,c);c=ar(Uq(new Tq,10),a).build();this.R.Xb(2850,c)};p.QHb=function(){this.R.Xb(2709,this.gb)};
p.Rqb=function(){var a=this.Aa().Ob(),b=a.createElement("textarea");b.textContent=this.D.$m;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&(hIc(this.Ei,"Formula copied to clipboard",this.Aa()),this.R.C(35534,this.gb))};function iIc(a){return U('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+T(THc({QL:a.xDa.QL}))+T(RHc({error:a.xDa.error,showHelp:a.showHelp}))+"</div></div>")}function jIc(){return U('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function CY(a,b,c,d,e){jY.call(this,new IG,e);this.H=a;this.O=b;this.L=d;this.R=c;this.J=new Yu("",new gX,this.Aa());this.Qa(this.J);this.C=new Yu("",new AW,this.Aa());this.Qa(this.C);this.D=new Yu("",new AW,this.Aa());this.Qa(this.D)}y(CY,jY);p=CY.prototype;p.mA=function(){ps(this.La,"Error Card for question: "+this.H.D)};p.cz=n("assistantAnswersFeedback");p.tA=Qh;p.T7=Ph;p.Ha=function(){CY.qa.Ha.call(this);GFc(this).appendChild(S(QHc))};
p.Ra=function(){CY.qa.Ra.call(this);var a=this.Za("waffle-assistant-answers-card-remove");this.J.kb(a);this.D.setVisible(this.L);fY(a,"Remove card",0);this.getHandler().Oc(this.J,"action",this.N_b).Oc(this.C,"action",this.yAb).V(this.D,"action",this.M_b)};
p.uA=function(a){kY(this).appendChild(S(iIc,{xDa:EHc(this.H),showHelp:this.L}));if(Uo){var b=S(jIc);this.Aa().appendChild(this.La,b);this.C.kb(this.Za("waffle-assistant-answercard-feedback-link"))}this.L&&this.D.kb(this.Za("waffle-assistant-answers-helpcenter-link"));a()};p.Tha=g("O");p.eN=g("H");p.yAb=function(){this.C.setVisible(!1);Q(this.Za("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new I("trigger_feedback"))};p.N_b=function(){WHc(this.R,!1);this.dispatchEvent(new I("rc"))};
p.M_b=function(){O.xo.mc()};function kIc(a){jY.call(this,new IG,a);this.C=this.Aa().createElement("div");Ao(this.C,"Previous")}y(kIc,jY);p=kIc.prototype;p.mA=function(){ps(this.La,"Previous questions below")};p.Ha=function(){kIc.qa.Ha.call(this);us(this.La,"waffle-assistant-card");ss(this.La,"waffle-assistant-answers-previousheadercard")};p.uA=function(a){0<this.Aa().Sh(kY(this)).length||kY(this).appendChild(this.C);a()};p.T7=Ph;p.cz=n("assistantAnswersFeedback");function lIc(a){var b=""+(""+(a.U4?T(RHc({error:a.U4,showHelp:a.showHelp})):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+T(a.title)+"</div>":""));var c=Zt("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.ew;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+V(c)+'">'+T(xw({icon:"docs-icon-img docs-icon-help"}))+
'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+T(f)+"</div></div></div>"}return U(b+"</div>")};function DY(a,b,c,d,e,f){jY.call(this,a,f);this.C=e||null;this.O=b;this.D=d;this.R=c;this.L=this.C?5==this.C.error:!1;this.H=new Yu("",new AW,this.Aa());this.Qa(this.H);this.J=new Yu("",new gX,this.Aa());this.Qa(this.J)}y(DY,jY);p=DY.prototype;p.Ha=function(){DY.qa.Ha.call(this);this.tA()&&GFc(this).appendChild(S(QHc))};
p.Ra=function(){DY.qa.Ra.call(this);ss(this.La,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().V(this.H,"action",this.O_b);if(this.tA()){var a=this.Za("waffle-assistant-answers-card-remove");this.J.kb(a);fY(a,"Remove card",0);this.getHandler().Oc(this.J,"action",this.P_b)}};p.NB=function(){return zb([mIc,nIc],this.D)?2799:zb([oIc,pIc],this.D)?2801:null};p.MB=function(){return zb([mIc,nIc],this.D)?2798:zb([oIc,pIc],this.D)?2800:null};p.a6=n("Were these interesting?");
p.Kia=n("Interesting");p.Jia=n("Not interesting");p.cz=n("assistantAnswersFeedback");p.tA=function(){return this.C?!zHc(this.C):!1};p.mA=function(){var a=this.D.title;a&&this.C?ps(this.La,a+(" for question : "+this.C.D)):ps(this.La,"Suggested questions")};
p.uA=function(a){var b=this;this.R.then(function(c){if(b.Wb()){if(0==c.length)Q(b.La,!1);else{var d=b.Aa(),e=kY(b);if(0==d.Sh(e).length){var f=S(lIc,{title:b.D.title,ew:sb(c,function(a){return a.query}),U4:b.C?FHc(b.C):"",showHelp:b.L});e.appendChild(f);var h=sb(c,function(a){return a.type});e=b.Oi("waffle-assistant-answercard-question-container");A(e,function(a,e){var f=new Yu("",new gX,d);b.Qa(f);f.kb(a);b.getHandler().V(f,"action",v(b.qCb,b,c[e],h,e))});b.L&&b.H.kb(b.Za("waffle-assistant-answers-helpcenter-link"))}}a()}})};
p.P_b=function(){WHc(this.O,!1);this.dispatchEvent(new I("rc"))};p.qCb=function(a,b,c){this.dispatchEvent(new fFc(this.D.x0,a.$m||null,b,c,this.D.DV,a.query))};p.O_b=function(){O.xo.mc()};var qIc={title:"",DV:0,x0:null},mIc={title:"",DV:5,x0:1},nIc={title:"Suggested questions",DV:5,x0:1},pIc={title:"Did you mean?",DV:2,x0:4},oIc={title:"Related questions",DV:4,x0:4};function EY(a,b,c,d,e,f,h,k,l,m,q,t,w,x){lY.call(this,x);this.Me=c;this.Yd=d;this.rf=e;this.Jc=a;this.jb=new kHc(this.Yd);this.gb=h;this.Ba=m;this.sf=q;this.Qe=t;this.J=this.O=this.R=this.Kb=this.D=null;this.Nb="";this.Pa=new hFc;this.L=f;this.Wa=this.Vb=this.cb=this.F=null;this.$a=k;this.Hd=!1;this.Cb=Uq(new Tq,10).build();this.Nc=new kl;this.Ab=l;this.va={};this.yd=Zd();this.wb="";this.Ia=null;this.Lf=w}y(EY,lY);p=EY.prototype;p.Ra=function(){EY.qa.Ra.call(this);this.rH(!this.F)};
p.Hoa=function(a,b){EY.qa.Hoa.call(this,a,b);b=this.Aa();var c=this.$;this.R=new eY(b);c.Qa(this.R,!0);b.appendChild(a,this.R.La);this.R.Ra();this.O=new pFc(this.R,this.L,this.Pa,10);c.Fa(this.O);c.getHandler().V(this.R,"answers-submit-query",v(this.J_b,this))};p.R3=function(){EY.qa.R3.call(this);this.O=this.R=null};
p.rH=function(a){var b=this;this.R&&this.R.setVisible(!a);a?(this.Ia&&this.Ia.dispose(),this.Ia=new En(function(){EY.qa.rH.call(b,a)},300,this),this.Fa(this.Ia),this.Ia.start()):(this.Ia&&this.Ia.stop(),EY.qa.rH.call(this,a))};p.Mf=da("Kb");
function rIc(a,b,c,d,e,f,h){h=h?h:[];var k=k?k:[];a.jb.Ne(c,b,d,e,h,k);h=sb(Re(c,1),function(a){return a.getName()});var l=[],m=[];A(Re(c,2),function(a){l.push(a.getName());m=m.concat(Re(a,2))});iFc(a.Pa,h,l,m);a.Jc.u9().then(function(a){this.Pa.F=a;this.O&&(a=this.O,Po(a.O.Aa())==a.D&&a.XQa())},null,a);a.F=b;a.cb=d;a.Vb=e;a.Wa=c;a.Cb=ar(Uq(new Tq,10),sIc(a)).build();if(f&&dp)for(c=sb(a.C,function(a){if(a instanceof BY||a instanceof CY)return a.eN().D}),a.HV(),d=0;d<c.length;d++)if(e=c[d])f=new TX,
D(f,1,5),tIc(a,e,f);a.rH(!b)}p.reset=function(){NU(this.va);NU(this.Pa.D);var a=this.Pa;a.F=[];a.C.clear();this.J=null;this.QAa()};
function tIc(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?!1:e;var f=a.Ba.L.yv();D(c,13,f);f=new SX;bd(f,5,c);vFc(a.O);if(!a.Kb||a.Kb.getStatus().getState().Th())if(a.va[b])uIc(a,b,!1);else{d=new AY(b,null,null,null,2,a.Ba);vIc(a,d,!0,f);return}else{var h=a.va[b];h&&h instanceof CY&&2==h.eN().error&&delete a.va[b]}if(b&&a.F)if(a.va[b])a.L.Xb(2681,a.Cb),uIc(a,b,!0);else{h=sIc(a);var k=$c($c(h,yU,46),SX,4);D(k,2,e);e=ar(Uq(new Tq,10),h).build();a.L.Xb(2635,e);e=RE(a.F.rect);b=An(Em(Bn(Gm(Hm(a.Kb.Ke("/answers/parse").Ef("q",
b,"qt",B(c,1),"gid",a.F.fd,"range",e,"context",a.Nb),v(a.Lk,a,b,f)),v(a.I_b,a,b,f)),"POST"),2));dp&&a.cb&&null!=a.Vb&&(c=0==a.cb.rect.width||0==a.cb.rect.height?"":RE(a.cb.rect),b.Ef("headerRange",c,"tableRecordDimension",""+a.Vb));d&&b.Ef("sgfml",d);b.ye();a.wb=$d(a.yd,nm.Asa);wIc(a,!0)}else tFc(a.O,"")}function uIc(a,b,c){var d=a.va[b];d!=nb(a.C)&&(1<a.C.length&&xIc(a),c&&yIc(a,d.eN()).then(function(a){zIc(this,d,a)},null,a),QFc(a,d))}
p.J_b=function(a){var b=a.C;var c=a.Pa;var d=a.J,e=a.$;c?c=tHc(b,d,e,c):(c=new TX,D(c,1,b));tIc(this,a.R,c,a.F,a.L)};p.I_b=function(a,b){if(this.F){var c=B($c(b,TX,5),1);c=1==c||4==c?wEc.kxa:wEc.Kxa;var d=sIc(this),e=$c($c(d,yU,46),SX,4);D(e,1,c);D(b,1,c);c=ar(Uq(new Tq,10),d).build();this.L.Xb(2640,c);AIc(this,a,b)}};function AIc(a,b,c){wIc(a,!1);b=new AY(b,null,null,null,3,a.Ba);vIc(a,b,!1,c);BIc(a)}
p.Lk=function(a,b,c){this.F&&this.$a.C.D.C.then(function(){var d=null,e=null,f=!1,h=$c(b,TX,5),k=B(h,1),l=sIc(this);k=1==k||4==k?wEc.kxa:wEc.Kxa;var m=$c($c(l,yU,46),SX,4);D(m,1,k);D(b,1,k);k=ar(Uq(new Tq,10),l).build();if(c.Mk()){e=this.Nc.jd(bY.Na(),c.Ye());if(f=e.getStatus()){switch(f){case 1:var q=2639;break;case 2:q=2643;break;case 3:q=2644;break;case 4:q=2638;break;case 5:q=2707;break;case 6:q=2706}q&&this.L.Xb(q,k)}q=M(e,10);D(h,4,q);q=M(e,11);D(h,5,q);Me(e,16)&&(q=M(e,16),D(h,16,q));if(1==
f){AIc(this,a,b);return}if(2==f){e=-1!=CIc(a);h=-1!=sHc(a);f=4;d=$c(b,TX,5);e?(f=5,D(d,8,2)):h&&(f=7,D(d,8,1));h=new AY(a,null,null,null,f,this.Ba);e?(e=new CY(h,!0,this.Ab,!0,this.Aa()),DIc(this,h,e,b)):vIc(this,h,!0,b);wIc(this,!1);BIc(this);return}l=Me(e,2)?M(e,2):null;f=!0;if(l){q="";d=sEc(this.$a,l,this.F,!!this.Wa&&!!M(this.Wa,4));D(h,14,!!d);if(!d){if(m=l.match(/([A-Z]*)\(/)){var t=$c($c(pCa(k),yU,46),SX,4);D(t,7,m[1]);D(b,7,m[1])}this.L.Xb(2645,k)}d&&tEc(d)||(q=this.$a,t=this.F,k="="!=l[0]?
"="+l:l,m=qEc(q),t=rEc(m,t),q=ENb(q.C,k,m,t.row,t.yj));k=Me(e,19)?sEc(this.$a,M(e,19)||"",this.F,!!this.Wa&&!!M(this.Wa,4)):d;d=new AY(a,d,"="!=l[0]?"="+l:l,e,null,this.Ba,k);if(Me(e,23)&&d.ek()){if(Me(e,17)&&Me(M(e,17),5)){k=M(M(e,17),5);l=d.va;if(Me(k,5))switch(M(k,5).getPosition()){case 1:l.C="right";break;case 2:l.C="left";break;case 3:l.C="top";break;case 4:l.C="bottom"}Me(k,1)&&Me(M(k,1),1)&&Me(M(M(k,1),1),1)&&1==M(M(M(k,1),1),1)&&(l.L=!0);Me(k,2)&&Me(M(k,2),1)&&Me(M(M(k,2),1),1)&&1==M(M(M(k,
2),1),1)&&(l.O=!0);Me(k,1)&&Me(M(k,1),1)&&Me(M(M(k,1),1),2)&&(m=M(M(M(k,1),1),2),l.H=m);Me(k,2)&&Me(M(k,2),1)&&Me(M(M(k,2),1),2)&&(m=M(M(M(k,2),1),2),l.J=m);Me(k,3)&&(m=M(M(k,3),1),l.D=m);Me(k,4)&&(k=M(M(k,4),1),l.F=k)}this.Nb=Se(e,23)}else this.Nb="";q&&d.L.push(q);d.ek()&&bd(h,15,d.R)}else Me(e,9)&&(q=e.getError(),d=new AY(a,null,null,e||null,6,this.Ba),l=M(q,2),D(h,6,l),Me(q,3)&&(q=M(q,3),D(h,12,q)))}else this.L.Xb(2640,k);d||(d=new AY(a,null,null,e||null,4,this.Ba));wIc(this,!1);zHc(d)?EIc(this,
d,f,b):vIc(this,d,f,b);BIc(this)},function(){AIc(this,a,b)},this)};function BIc(a){""!=a.wb&&(ae(a.yd,a.wb),a.wb="")}function FIc(a){if(null!=a.$m)return oIc;switch(a.error){case 4:case 6:return 0<a.O.length?pIc:nIc;case 5:return nIc}return qIc}function sIc(a){var b=new SX;D(b,8,Dwa);var c=new yU;bd(c,4,b);a=aGc(a.F);bd(a,46,c);return a}function CIc(a){return yb(qHc,function(b){return Ma(a,b)})}
function GIc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=M(b[d],2),f=!!a.Wa&&!!M(a.Wa,4);e=sEc(a.$a,e,a.F,f);tEc(e)&&(e={query:M(b[d],1),$m:M(b[d],2),type:b[d].getType()},Me(b[d],5)&&(e.nEa=M(b[d],5)),c.push(e))}return ai(c)}function EIc(a,b,c,d){c=new BY(b,a.Me,a.Yd,a.rf,a.L,a.Ab,a.gb,c,a.Ba,a.Hd,a.Lf,a.$a,a.Aa());DIc(a,b,c,d)}
function HIc(a,b,c){if(a.D&&a.D.isVisible())HN(a.D);else{var d=a.sf.D.C["ritz-ap"]||null;c.sM()&&(a.D=Wwb(a.Qe,a.Aa(),d,void 0,"answersChartsPromo"),a.D&&(a.D.show(),a.Fa(a.D),a.getHandler().Oc(a,"Md",a.QAa)));b.ek()&&H9a(d,"answersChartsPromo")}}p.pba=function(){EY.qa.pba.call(this);this.D&&this.D.isVisible()&&this.D.C.ld()};p.QAa=function(){this.D&&this.D.isVisible()&&HN(this.D)};function vIc(a,b,c,d){c=new CY(b,c,a.Ab,!1,a.Aa());DIc(a,b,c,d)}
function DIc(a,b,c,d){xIc(a);var e=yIc(a,b,d);IIc(a,c);c instanceof BY&&HIc(a,b,c);JIc(a);zHc(b)&&jFc(a.Pa,b.D);e.then(function(a){if(d){var b=sIc(this),e=$c(b,yU,46);bd(e,4,d);b=ar(Uq(new Tq,10),b).build();this.L.Xb(2781,b)}zIc(this,c,a)},null,a);c.Tha()&&(a.va[b.D]=c);a.getHandler().V(c,"rc",a.XJa)}function zIc(a,b,c){b instanceof CY&&c&&Lr(c.getElement())&&(b=b.getElement(),Q(b,!1),a.getHandler().V(c,"rc",a.XJa))}
function xIc(a){KIc(a);A(a.C,function(a){a instanceof CY&&(a=a.getElement(),Q(a,!0))});LIc(a)}function LIc(a){0!=a.C.length&&(a.J?QFc(a,a.J):(a.J=new kIc(a.Aa()),IIc(a,a.J)))}function KIc(a){A(a.C,function(b){b instanceof BY||b instanceof CY||b==a.J||a.cH(b)})}function MIc(a,b){var c=ai([]);b=b.Ia;0<b.length&&(c=nHc(a.jb,b));return c=c.then(function(b){var c=3-b.length;return 0<c?ZGc(a.Jc,c).then(function(a){return Ib(b,a)}):ai(b)})}
function yIc(a,b,c){var d=FIc(b),e=null;d==oIc||d==pIc?0<b.O.length&&(e=GIc(a,b)):d==nIc&&(e=MIc(a,b));var f=null;return e?(f=new DY(new IG,a.Ab,e,d,b,a.Aa()),IIc(a,f),a.L.Xb(2769,a.Cb),a.getHandler().V(f,"sqc",v(a.pCb,a)),e.then(function(a){if(c){var b=$c(c,TX,5);zb([oIc,pIc],f.D)?(a=vHc(a),bd(b,7,a)):zb([mIc,nIc],f.D)&&(a=wHc(a),bd(b,9,a))}return f},null,a)):ai(f)}p.pCb=function(a){tFc(this.O,a.F,!0);var b=a.R;b=1==b?tHc(b,a.C,a.J,3):uHc(b,a.C,a.J,a.$);tIc(this,a.F,b,a.L);this.L.Xb(2762,this.Cb)};
function wIc(a,b){a=a.R;Q(a.H,b);Q(a.Aa().Za("waffle-assistant-answers-button-container",a.C),!b);rW(a.F,b)}function IIc(a,b){b.vA(a.vd());a.C.push(b);if(a.Yb){PFc(a,!1);var c=a.H.Wc();b.Ba=c;a.H.vh(b,0,!0);b.bJ()}IFc(b,!0)}function JIc(a){for(var b=a.C;5<b.length;)a.cH(b[0])}p.HV=function(){EY.qa.HV.call(this);this.reset()};
p.XJa=function(a){var b=this,c=this.Aa();a=a.target;if(a instanceof BY)this.cH(a),hIc(this.gb,"Answer removed",c,v(this.hzb,this,a));else if(a instanceof CY)this.cH(a),hIc(this.gb,"Card removed",c);else if(a instanceof DY&&a.C&&!zHc(a.C)){var d=a.C.D;A(this.C,function(a){a instanceof CY&&a.eN().D==d&&(b.cH(a),hIc(b.gb,"Card removed",c))})}a=this.C;!this.J||a[0]!=this.J&&a[a.length-1]!=this.J||(this.cH(this.J),this.J=null)};
p.hzb=function(a){EIc(this,a.eN(),a.Tha());hIc(this.gb,"Remove answer undone",this.Aa())};p.cH=function(a){if(a.Wb()){if(a instanceof BY||a instanceof CY)delete this.va[a.eN().D],a==nb(this.C)&&KIc(this);EY.qa.cH.call(this,a)}H(a)};function NIc(){var a=""+(""+U('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input waffle-assistant-answers-input-with-icon"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
T(xw({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+cu("Ask a question about your data")+'"/></div></form></div>');return U(a)};function FY(a,b,c,d,e,f,h,k,l,m,q){mY.call(this,1,f,e,q);this.Ab=c;this.Pa=null;this.Ba=new Yu("",new AW,this.Aa());this.Qa(this.Ba);this.Wa=new Yu("",new AW,this.Aa());this.Qa(this.Wa);a=new CNb(a,!0,!0);a=new vAc(a,c);this.jb=new VHc(e);this.O=new eHc(this.Ab,a,e);this.L=new EY(this.O,0,b,c,d,e,this.ib,a,this.jb,h,k,l,m,q);c=OIc;this.D=new xW(b,c.ica,c.jca);this.Fa(this.D);this.F=this.H=null;this.wb=Uq(new Tq,10).build();this.Ia=!1}y(FY,mY);
var OIc={ica:"waffle-assistant-answers-styled-border",jca:"waffle-assistant-answers-styled-rect",aZa:"waffle-assistant-answers-input-box",J_a:"waffle-assistant-answers-query-box",euc:"waffle-assistant-answers-query-box-focused",qZa:"waffle-assistant-answers-learn-more",uoc:"waffle-assistant-answers-logging-message-container",h_a:"waffle-assistant-answers-logging-opt-out"};p=FY.prototype;p.Ha=function(){FY.qa.Ha.call(this);var a=S(NIc);this.Aa().appendChild(SFc(this),a)};
p.Ra=function(){FY.qa.Ra.call(this);var a=OIc,b=this.Za(a.J_a),c=this.Za(a.aZa);this.Wa.kb(this.Za(a.h_a));this.Ba.kb(this.Za(a.qZa));this.getHandler().V(b,"focus",this.yyb,!0).V(b,"blur",this.wyb,!0).V(b,"mouseover",this.Ayb).V(b,"mouseout",this.zyb).V(b,"click",this.xyb).V(c,"input",this.K_b).V(this.Wa,"action",this.Jwb).V(this.Ba,"action",this.qtb).V(nD(this.Ab),"Ca",Grc(this.L_b,25,this));this.setVisible(!!this.H);PIc(this,lwa&&owa&&ep("showAnswersLoggingOptOut"))};p.Npa=Ph;p.OKa=Qh;p.Jpa=Ph;
p.gN=n("Answers");p.g1=n(1);p.wV=function(a){return 3==a||0==a||1==a};p.fN=function(a,b){Pb(a,function(a,b){return M(b,2)-M(a,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=Se(a[f],1);3==h?e=a[f]:0==h?c.push(M(a[f],8)):1==h&&d.push(a[f])}if(e&&M(e,2)){f=b||null;h=Me(e,11)?M(e,11):null;var k=null==h?null:wU(M(e,10));0<Ne(e,4)?QIc(this,wU(BU(e)),M(e,9),k,h,c,d):QIc(this,f,M(e,9),k,h,c,d);this.F||(FY.qa.fN.call(this,a,b),this.getHandler().V(this.F,"sqc",this.nCb))}else this.KT(!0)};
p.EO=function(a){if(!this.F){var b=ZGc(this.O,3);this.F=new DY(a,this.jb,b,mIc,void 0,this.Aa())}return this.F};p.nAa=g("L");p.ela=function(){return this.isVisible()};
p.KT=function(a,b,c){this.O.reset();(a||b)&&this.F&&(FY.qa.KT.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||u(b)&&!b)this.F&&(FY.qa.KT.call(this,a,b,c),this.F.dispose(),this.F=null),this.Wb()&&(this.O.reset(),this.H=null,a=this.L,a.Wb()&&(b=a.Pa,b.F=[],b.C.clear(),a.O&&(b=a.O,b.O.Wb()&&(eFc(b.D),b.F.isDisposed()||b.F.setVisible(!1),b.J=!1)),a.HV(),a.jb.reset(),a.F=null,a.rH(!0)),this.setVisible(!1),this.Ub()&&zW(this.D));c&&this.L.reset()};p.Mf=function(a){this.Pa=a;this.L.Mf(a);this.O.Mf(a)};
p.h1=function(a){FY.qa.h1.call(this,a);a?yW(this.D,this.H):zW(this.D)};function RIc(a,b){a.Ub()&&(b?zW(a.D):yW(a.D,a.H))}function PIc(a,b){Q(a.Za("waffle-assistant-answers-logging-message-container"),b)}function SIc(a,b){a=a.Za("waffle-assistant-answers-query-box");ws(a,"waffle-assistant-answers-query-box-focused",b)}p.L_b=function(){this.Ub()&&yW(this.D,this.H)};p.yyb=function(){SIc(this,!0);yW(this.D,this.H)};p.wyb=function(){SIc(this,!1);this.Ub()||zW(this.D)};p.Ayb=function(){yW(this.D,this.H)};
p.zyb=function(){this.Ub()||zW(this.D)};p.xyb=function(){TIc(this,"")};p.K_b=function(){var a=this.Za("waffle-assistant-answers-input-box");TIc(this,a.value);a.value=""};p.nCb=function(a){var b=this,c=a.F;TIc(this,c);var d=tHc(1,a.C,a.J,1),e=new En(function(){tIc(b.L,c,d,a.L)},300);this.Fa(e);e.start();this.R.Xb(2652,this.wb)};function TIc(a,b,c){a.h1(!0);a.dispatchEvent("Rd");UIc(a,b,c)}
function UIc(a,b,c){c=void 0===c?!1:c;var d=new En(function(){tFc(a.L.O,b,!0);var d=a.L,f=c||!1;d.Hd=f;d.Jc.$=f;d.jb.$=f},300);a.Fa(d);d.start()}function QIc(a,b,c,d,e,f,h){c=c||new CG;a.H=b;a.O.Ne(c,b,d,e,f,h);a.O.t9();a.setVisible(!!b);rIc(a.L,b,c,d,e,a.Ia,f);a.Ia=!1;a.Ub()&&yW(a.D,a.H)}p.Jwb=function(a){a.stopPropagation();a.preventDefault();this.Pa&&(Bn(Gm(Hm(this.Pa.Ke("/answers/logoptout"),v(this.Ztb,this)),v(this.Ytb,this)),"POST").ye(),this.R.Xb(2663,this.wb))};
p.qtb=function(a){a.stopPropagation();a.preventDefault();Yr("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.Ztb=function(a){a.Mk()&&PIc(this,!1)};p.Ytb=ba();function GY(a,b,c,d){Cw.call(this,a,b,c,d,void 0,void 0,!0)}y(GY,Cw);GY.prototype.Ha=function(){GY.qa.Ha.call(this);ss(this.La,"waffle-assistant-toast");ss(this.Za("docs-ui-toast-content"),"waffle-assistant-toast-content")};GY.prototype.$A=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=Ur(this,b);GY.qa.$A.call(this,a,b,c)};GY.prototype.Ih=function(a,b,c,d){this.$A(a,b,d);a=Wr(this,b);this.getHandler().Yg(a,He,v(function(){this.setVisible(!1);c()},this))};function VIc(){this.C=null}y(VIc,G);VIc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function hIc(a,b,c,d){a.clear();a.C=new GY(b,c,!1,5E3);a.C.render();d&&a.C.Ih("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}VIc.prototype.Oa=function(){VIc.qa.Oa.call(this);this.clear()};function WIc(){var a=U;var b=""+T(ev({xd:"waffle-assistant-datavalidation-apply-button",content:Zt("Apply"),style:4}));b=U(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function XIc(a){return U('<div class="waffle-assistant-datavalidation-detail-chip">'+T(a.K5a)+"</div>")};function YIc(a,b,c,d){jY.call(this,a,d);this.D=new xW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.Fa(this.D);this.C=new gv("",this.Aa());this.Qa(this.C);this.H=BU(a);this.J=c}r(YIc,jY);p=YIc.prototype;p.Ha=function(){jY.prototype.Ha.call(this);kY(this).appendChild(S(WIc))};
p.Ra=function(){jY.prototype.Ra.call(this);var a=this.Za("waffle-assistant-datavalidation-apply-button");this.C.kb(a);fY(a,"Apply data validation");this.getHandler().V(this.C,"action",this.Mjb).V(this.La,"mouseenter",this.LIb).V(this.La,"mouseleave",this.MIb);a=new qq;Pqc(a,pxc(Kf(M(M(this.F,13),3))));var b=new oq;bd(b,58,a);a=ar(Uq(new Tq,10),b).build();this.J.C(35577,a)};
p.uA=function(a){var b=RE(vl(this.H)),c=M(M(this.F,13),3);switch(Kf(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=Re(c,2).map(function(a){return M(M(a,5).bb(),2)});break;case 1:d="Numeric validation";c=["Greater than "+M(M(Re(c,2)[0],5).bb(),3)];break;case 7:d="Numeric validation";c=Re(c,2);c=["Between "+(M(M(c[0],5).bb(),3)+(" and "+M(M(c[1],5).bb(),
3)))];break;default:d="unrecognized",c=[]}var e=new yx,f=e.text(d)+(" for "+(e.Ee("SPAN".toString(),{rE:"waffle-assistant-datavalidation-range"})+e.text(b)+e.Ie("SPAN".toString())));Oi(this.Za("waffle-assistant-datavalidation-description"),e.format(f));var h=this.Za("waffle-assistant-datavalidation-details");A(c,function(a){a=S(XIc,{K5a:a});h.appendChild(a)});b="Suggested data validation: "+(d+(" "+(c.join()+(" for "+b))));ps(this.La,b);a()};p.mA=ba();p.cz=n("assistantDataValidationFeedback");
p.NB=n(35551);p.MB=n(35550);p.Mjb=function(){this.dispatchEvent(new hY("Ld",this,35549))};p.LIb=function(){yW(this.D,wU(this.H))};p.MIb=function(){zW(this.D)};function ZIc(a,b,c,d){mY.call(this,3,b,a,d);this.D=c}r(ZIc,mY);p=ZIc.prototype;p.gN=n("Data Validation");p.wV=function(a){return 6==a};p.EO=function(a){var b=M(a,1);switch(b){case 6:return new YIc(a,this.D,this.R,this.Aa());default:throw Error("Unsupported recommendation type: "+b);}};p.hN=function(a){mY.prototype.hN.call(this,a);this.setVisible(!a)};p.iN=function(a){return this.vd()?(this.setVisible(!1),a):mY.prototype.iN.call(this,a)};p.g1=n(4);p.Npa=n(!1);function $Ic(){var a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+aJc()+"</div>");return U(a)}
function bJc(){return U('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+aJc()+"</div>")}function aJc(){var a=""+T(ev({xd:"waffle-assistant-formatting-edit-button",content:Zt("Edit"),style:4}));return U(a)};function cJc(a,b,c){jY.call(this,a,c);a=sb(Re(this.F,7),ltc);this.C=new qtc(!1,a,7);this.Qa(this.C);this.J=new gv("",this.Aa());this.Qa(this.J);this.L=b;this.H=!1;this.D=-1}y(cJc,jY);var dJc={MWa:"waffle-assistant-banding-color-picker-container",$ba:"waffle-assistant-formatting-edit-button",hI:"waffle-assistant-banding-range"};p=cJc.prototype;p.Ha=function(){cJc.qa.Ha.call(this);kY(this).appendChild(S($Ic))};
p.Ra=function(){cJc.qa.Ra.call(this);this.getHandler().V(this.J,"action",this.kpb).V(this.C,"kd",this.skb);this.L.C(2768)};p.uA=function(a){var b=this.Za(dJc.MWa);this.C.render(b);rtc(this.C);b=this.Za(dJc.hI);var c=BU(this.F),d=vl(c);Ao(b,RE(d));eJc(this,c);b=this.Za(dJc.$ba);this.J.kb(b);a()};p.mA=function(){ps(this.La,"Suggested alternating background colors");mt(this.C,"Choose a color scheme")};p.cz=n("assistantBandingFeedback");p.NB=n(2672);p.MB=n(2671);
p.kpb=function(a){WA.dispatchEvent({type:"show-banding-pane-recommendation",CQa:this.F,q5a:ttc(this.C)});a.stopPropagation()};p.skb=function(a){if(!this.H&&stc(this.C)){var b=this.D;this.D=this.C.eh();this.D==b?this.dispatchEvent(new hY("Qd",this,2797)):this.dispatchEvent(new hY("Jd",this,2673));a.stopPropagation()}};
function eJc(a,b){a.H=!0;var c=b.Jb();b=vl(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.kc(),b.gc(),b.Mc(),b.Pc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new kl).jd(jf.Na(),c),c=ltc(c)):c=null;c?(c=utc(a.C,c),TN(a.C,c?c.getElement():null)):TN(a.C,null);a.D=a.C.eh();a.H=!1};function fJc(a,b){jY.call(this,a,b);this.C=new gv("",this.Aa());this.Qa(this.C);this.tc=Re(a,6)}y(fJc,jY);var HY={$ba:"waffle-assistant-formatting-edit-button",CYa:"waffle-assistant-conditionalformat-format-preview",f0a:"waffle-assistant-conditionalformat-rule-holder",sN:"waffle-assistant-conditionalformat-description",e_a:"one-rule",v1a:"two-rules",i1a:"three-rules",F_a:"waffle-assistant-conditionalformat-format-preview-label"};p=fJc.prototype;p.Ha=function(){fJc.qa.Ha.call(this);kY(this).appendChild(S(bJc))};
p.Ra=function(){fJc.qa.Ra.call(this);var a=this.Za(HY.$ba);this.C.kb(a);fY(a,"Apply and edit conditional format rules");this.getHandler().V(this.C,"action",this.Kjb)};p.uA=function(a){Ao(this.Za(HY.sN),Se(this.F,3));var b=this.Za(HY.f0a),c=new gJc(this,this.Aa());this.Qa(c);c.kb(b);fY(b,"Apply conditional format rules");a()};p.mA=ta;p.cz=n("assistantConditionalFormatFeedback");p.NB=n(2630);p.MB=n(2629);
p.Kjb=function(){this.dispatchEvent(new hY("Kd",this,2563));this.dispatchEvent(new hY("Nd",this,2670,void 0,void 0,vl(M(this.tc[0],1,0))));SRa()};function gJc(a,b){kt.call(this,void 0,void 0,b);this.C=a}y(gJc,kt);
gJc.prototype.hd=function(a){gJc.qa.hd.call(this,a);var b=this.C.tc;switch(b.length){case 0:break;case 1:var c=HY.e_a;break;case 2:case 4:c=HY.v1a;break;default:c=HY.i1a}for(var d=0;d<b.length;d++){var e=b[d],f=ao("DIV");ts(f,[HY.CYa,c]);var h=ao("DIV");ss(h,HY.F_a);f.appendChild(h);Ao(h,"123");if(Me(e,2)){var k=M(M(e,2),1);switch(Kf(M(k,1))){case 9:case 13:k=Re(M(k,1),2)[0];var l=Re(e,1)[0];Ao(h,pE(k,Se(l,1),Se(l,2),Se(l,4)))}}Bsc(e,f);a.appendChild(f)}};
gJc.prototype.Hh=function(){var a=this.C;a.dispatchEvent(new hY("Kd",a,2563));return!0};function hJc(a,b,c){mY.call(this,2,b,a,c)}y(hJc,mY);p=hJc.prototype;p.gN=n("Formatting");p.wV=function(a){return 2==a||4==a};p.EO=function(a){var b=M(a,1);switch(b){case 2:return new fJc(a,this.Aa());case 4:return a=new cJc(a,this.R,this.Aa()),this.getHandler().V(a,"Jd",this.LSb).V(a,"Qd",this.kFb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.LSb=function(a){hIc(this.ib,"Alternating colors applied",this.Aa(),v(this.tkb,this,a.C))};p.kFb=function(){this.ib.clear()};
p.tkb=function(a){this.dispatchEvent(new hY("Vd",a,2796))};p.hN=function(a){hJc.qa.hN.call(this,a);this.setVisible(!a)};p.iN=function(a){return this.vd()?(this.setVisible(!1),a):hJc.qa.iN.call(this,a)};p.g1=n(3);function iJc(a,b,c,d,e,f,h,k,l,m){jY.call(this,k,m);this.$a=b;this.cb=c;this.va=d;this.gb=l;this.O=e;this.$=f;this.H=new Yu("",new gX,this.Aa());this.Qa(this.H);this.R=new Yu("",new gX,this.Aa());this.Qa(this.R);this.J=this.D=null;this.C=ao("CANVAS","waffle-pivottable-pivot-canvas-border");this.Wa=this.cb.L.C;this.L=Uq(new Tq,10).build()}r(iJc,jY);p=iJc.prototype;p.tA=n(!0);p.Ha=function(){jY.prototype.Ha.call(this);kY(this).appendChild(S(zEc));GFc(this).appendChild(S(AEc))};
p.Ra=function(){jY.prototype.Ra.call(this);var a=M(this.F,5),b=wAc(this.$,a),c=RI(this.$a).fc();this.J=new xAc(b,a,this.Wa,this.gb,c,this.va);a=this.Za("waffle-assistant-insert-pivottable-button");this.H.kb(a);fY(a,"Insert Pivot Table");a=this.Za("waffle-assistant-zoom-button");this.R.kb(a);fY(a,"Preview Pivot Table");this.getHandler().V(this.H,"action",this.NIb).V(this.R,"action",this.OIb)};
p.uA=function(a){Ao(this.Za("waffle-assistant-answercard-interpret"),Se(this.F,3));this.C=ao("CANVAS","waffle-pivottable-pivot-canvas-border");this.Za("waffle-assistant-answercard-pivot-content").appendChild(this.C);zAc(this.J,this.C);a()};p.vA=function(a){jY.prototype.vA.call(this,a);this.H&&this.H.setVisible(!a);this.D&&uEc(this.D,this.vd())};p.mA=function(){ps(this.La,"Suggested Pivot Table")};p.cz=n("assistantPivotTableFeedback");p.NB=n(2632);p.MB=n(2631);
p.NIb=function(){yAc(this.J);this.dispatchEvent("close-sidebar");this.O.C(35589,this.L)};p.OIb=function(){this.O.C(35590,this.L);H(this.D);this.D=new fX(this.J,Se(this.F,3),this.O,this.L,35591,this.Aa());this.D.render();this.Fa(this.D);uEc(this.D,this.vd())};function jJc(a,b,c,d,e,f,h,k){mY.call(this,1,f,e,k);this.H=d;this.D=b;this.L=c;this.O=h;Uq(new Tq,10).build();a=new CNb(a,!0,!0);this.F=new vAc(a,this.D)}r(jJc,mY);p=jJc.prototype;p.gN=n("Pivot Table");p.wV=function(a){return 1==a};p.EO=function(a){var b=M(a,1);switch(b){case 1:return new iJc(0,this.D,this.L,this.H,this.R,this.F,0,a,this.O,this.Aa());default:throw Error("Unsupported recommendation type: "+b);}};p.fN=function(a,b){M(a[0],5)&&mY.prototype.fN.call(this,a,b)};
p.iN=function(a){return this.vd()?(this.setVisible(!1),a):mY.prototype.iN.call(this,a)};p.g1=n(5);function IY(a,b,c,d,e){R.call(this);this.O=a;this.cb=b;this.va=c;this.H=d;this.D=e}r(IY,R);IY.prototype.getTableRange=g("va");IY.prototype.v9=function(a,b,c){this.va=a;this.H=b;this.D=c};IY.prototype.Ra=function(){R.prototype.Ra.call(this);this.getHandler().V(this.O.C,"K",this.gb)};IY.prototype.gb=function(){this.cb.mc()};function kJc(a,b){G.call(this);this.F=a;this.H=b;this.C=new xW(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.Fa(this.C);this.D=new xW(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.Fa(this.D)}r(kJc,G);kJc.prototype.Oa=function(){zW(this.C);zW(this.D);G.prototype.Oa.call(this)};
function lJc(a,b,c,d,e,f){kK(b);var h=vl(d);h=new Lk(h.kc(),h.gc(),Math.min(h.Mc(),h.kc()+6),Math.min(h.Pc(),h.gc()+6));var k=jK(b),l=lG(a.F).C,m=l.wg(new de(h.kc(),h.Mc()),"r",!0,!1,!0,!0)-1,q=l.wg(new de(h.gc(),h.Pc()),"c",!0,!1,!0,!0)-1;l.Zb()&&--q;m=Math.min(200,m);q=Math.min(c.offsetWidth-2,q);lK(b,k,q,m);c=ZFc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.kc();k=d.gc();switch(e){case 0:h=Math.min(d.Mc(),d.kc()+f);break;case 1:k=Math.min(d.Pc(),d.gc()+f)}d=ml(d.Jb(),h,k,d.Mc(),d.Pc());yW(b,wU(d));yW(a.D,
wU(c))};function mJc(a){var b=a.SPa,c=a.RPa,d=a.qOa;a=a.gza;return U('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+V(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+T(b)+'</div></div><div class="waffle-tables-popup-content">'+T(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+
T(d)+'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+T(a)+"</div></div></div></div>")}
function nJc(){var a=""+(""+mJc({SPa:Zt("Edit data range"),RPa:$t(""+U('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>')),qOa:Zt("Update"),
gza:Zt("Cancel")})+"");return U(a)}function oJc(){var a=""+(""+mJc({SPa:Zt("Improve suggestions"),RPa:$t('<div class="waffle-tables-popup-header-message"></div>'),qOa:Zt("No"),gza:Zt("Yes")})+"");return U(a)}function pJc(a){a='For <span class="waffle-assistant-table-bar-range">'+(T(a.wH)+"</span>");return U(""+(""+a+""))}
function qJc(a){a='Is <span class="waffle-assistant-table-first-header">'+(T(a.WK)+"</span> a header row, containing titles that describe the columns below?");return U(""+(""+a+""))};function rJc(a,b,c,d,e,f,h){IY.call(this,a,nRa,d,e,f);this.C=(new HQ).build();this.Fa(this.C);this.J=new Yu("",new gX,this.Aa());this.Qa(this.J);Kw(this.C,this.J,oRa);this.F=new Yu("",new gX,this.Aa());this.Qa(this.F);Kw(this.C,this.F,nRa);this.R=new kJc(b,c);this.Fa(this.R);this.L=new rq(this);this.Fa(this.L);this.Ba=h}r(rJc,IY);rJc.prototype.Ha=function(){this.La=S(oJc)};
rJc.prototype.Ra=function(){IY.prototype.Ra.call(this);this.J.kb(this.Za("waffle-tables-popup-done"));this.F.kb(this.Za("waffle-tables-popup-cancel"));var a=ZFc(this.getTableRange(),this.D,1);a=RE(vl(a));a=S(qJc,{WK:a});this.Za("waffle-tables-popup-header-message").appendChild(a);this.L.subscribe(oRa,"action",this.Ia).subscribe(nRa,"action",this.$);a=this.Za("waffle-assistant-table-canvas");var b=this.Za("waffle-assistant-canvas-container");lJc(this.R,a,b,this.getTableRange(),this.D,this.H);a=this.Za("waffle-tables-popup");
ws(a,"waffle-tables-popup-answers-enabled",this.Ba);b=new eM(a,this.Aa());this.Fa(b);fM(b);a.focus()};rJc.prototype.$=function(){this.dispatchEvent("Td")};rJc.prototype.Ia=function(){var a=vl(this.getTableRange());switch(this.D){case 0:a=Noa(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=Noa(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=RE(a);this.dispatchEvent(new yFc(a,this.H-1,this.D));this.dispatchEvent("Td")};function sJc(a,b,c,d,e,f,h,k,l){IY.call(this,a,EA,d,e,f);var m=this;this.ib=b;this.$a=d;this.Ab=e;this.Cb=f;a=vl(d);this.F=RE(a);this.Wa=new kJc(b,c);this.Fa(this.Wa);this.C=null;this.Ba=h;this.J=(new HQ).build();this.Fa(this.J);this.$=new Yu("",new gX,this.Aa());this.Qa(this.$);Kw(this.J,this.$,lRa);this.R=new Yu("",new gX,this.Aa());this.Qa(this.R);Kw(this.J,this.R,EA);b=this.O.C.C.we();this.L=new pV(this.ib,function(a,b,c){tJc(m,a,b,c)},!1,"e.g., A2:D5",!0,b,this.Aa());this.Qa(this.L);this.Ia=
null;this.Pa=new rq(this);this.Fa(this.Pa);this.jb=k;this.wb=l}r(sJc,IY);p=sJc.prototype;p.Ha=function(){this.La=S(nJc)};
p.Ra=function(){IY.prototype.Ra.call(this);this.$.kb(this.Za("waffle-tables-popup-done"));this.R.kb(this.Za("waffle-tables-popup-cancel"));this.L.render(this.Za("waffle-assistant-tables-data-range-wrapper"));var a=this.Za("waffle-range-selection-input");ks(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().V(a,"keydown",this.QIb).V(a,"keyup",this.RIb).V(a,oga,this.NCb).V(this.L,"change",this.SIb);this.Pa.subscribe(lRa,"action",this.TIb).subscribe(EA,"action",this.Pkb);uJc(this);
a=this.Za("waffle-tables-popup");ws(a,"waffle-tables-popup-answers-enabled",this.wb);var b=new eM(a,this.Aa());this.Fa(b);fM(b);a.focus()};p.Oa=function(){H(this.Ia);IY.prototype.Oa.call(this)};function tJc(a,b,c,d){CU(a.jb,null,b,c,d,!1,void 0,function(b){a.Ia=b})}function vJc(a){var b=a.Za("waffle-assistant-table-canvas"),c=a.Za("waffle-assistant-canvas-container");lJc(a.Wa,b,c,a.getTableRange(),a.D,a.H)}p.Pkb=function(){this.dispatchEvent("Td")};
p.TIb=function(){var a=!MZa.test(this.F);Q(this.Db("waffle-assistant-tables-range-error"),a);ws(this.Za("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.Ab!=this.H||this.Cb!=this.D;var b=!Mrc(this.$a,this.getTableRange());if(a||b)a&&this.Ba.Xb(35506),b&&this.Ba.Xb(35507),this.dispatchEvent(new yFc(this.F,this.H,this.D));this.dispatchEvent("Td")}};
function uJc(a){var b=a.Za("waffle-range-selection-input"),c=vl(a.$a);a.F=RE(c);b.value=a.F;wJc(a);vJc(a)}p.v9=function(a,b,c){IY.prototype.v9.call(this,a,b,c);vJc(this)};function xJc(a){var b=RI(a.O.C),c=b.fc();if(b=QZa(a.F,b))c=tl(b,c),a.v9(c,yJc(a,c),a.D),wJc(a)}function yJc(a,b){b=zJc(b,a.D);return a.H>b?b:a.H}function zJc(a,b){a=0==b?a.Mc()-Se(a,2):a.Pc()-Se(a,4);return Math.min(a-1,3)}
function wJc(a){H(a.C);a.C=new yM;a.Qa(a.C);Kw(a.J,a.C,kRa);zU(a.C,WW.getInstance());a.C.render(a.Za("waffle-assistant-tables-edit-headers-button"));a.getHandler().V(a.C,"action",a.Crb);for(var b=zJc(a.getTableRange(),0),c=0;c<=b;c++){var d=(new Ip("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.C.Fd(new yt(d))}c=zJc(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new Ip("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.C.Fd(new yt(e))}c=a.H;a.C.Bf(0==a.D?c:c+b+1);ks(a.C.La,"label","Headers")}p.NCb=function(){var a=this.Za("waffle-range-selection-input");this.F!=a.value&&(this.F=a.value,xJc(this))};p.SIb=function(){var a=this.L.bb();this.F=a;var b=this.Za("waffle-range-selection-input");b.value=a;b.select();xJc(this)};
p.QIb=function(a){var b=this.Za("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;xJc(this);lRa.mc();break;case 27:a.stopPropagation(),a.preventDefault(),uJc(this),EA.mc()}};p.RIb=function(){this.F=this.Za("waffle-range-selection-input").value;xJc(this)};p.Crb=function(){var a=this.C.eh(),b=zJc(this.getTableRange(),0);this.v9(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};function AJc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+V(a.title)+'">'+T(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+cu("Press enter to insert formula")+'"></span></div>');return U(a)};function JY(a,b){R.call(this);this.C=a;this.D=b}y(JY,R);p=JY.prototype;p.Ha=function(){this.La=S(AJc,{name:this.C,title:this.D})};p.Ra=function(){JY.qa.Ra.call(this);var a=this.Za("waffle-assistant-quicksum-entry-name");fY(a);this.getHandler().V(this.La,"keypress",this.o_b);Q(this.La,!1)};p.getFunctionName=g("C");p.fb=function(a){Ao(this.Za("waffle-assistant-quicksum-entry-value"),a||"");Q(this.La,!!a)};p.isVisible=function(){return Lr(this.La)};
p.o_b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new I("insert",this)))};function BJc(a,b,c,d,e){R.call(this,e);this.Wa=a;this.Ia=b;this.O=c;this.J=d;this.D=a.C;this.Pa=new kl;this.$=Uq(new Tq,17).build();this.R=Uq(new Tq,2).build();this.L=!1;this.F=[];this.C=null;this.H=[]}y(BJc,R);
BJc.prototype.Ra=function(){BJc.qa.Ra.call(this);this.vh(new JY(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.vh(new JY(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.vh(new JY(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.vh(new JY(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.vh(new JY(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new OHc(this.La,
this.Ia,this.D,this.O);this.C.H=this.L;this.Fa(this.C);this.getHandler().V(this,"insert",this.va).V(this.C,"formula_inserted",this.Ba)};
function CJc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(mG(a.D)){var c=RI(a.D),d=c.Fj(),e=QI(a.D);if(vb(d,c.ct,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=ml(e+"",h.kc(),h.gc(),h.Mc(),h.Pc());c.push(a.Pa.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){Q(a.La,!0);e=d.count;c=d.countNumberFormat;var l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.ad(0).fb(b(d.sum));a.ad(1).fb(b(d.average));a.ad(2).fb(b(d.min));a.ad(3).fb(b(d.max));
1<e?a.ad(4).fb(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):Q(a.La,!1);if(a.C){a.C.L=[];a.H=[];for(d=0;d<a.Wc();++d)e=a.ad(d),a.H.push(DJc(a,e.getFunctionName()));a.C.L=a.H}}else Q(a.La,!1)}else Q(a.La,!1)}else Q(a.La,!1)}BJc.prototype.va=function(a){var b=a.target;a=this.F[0];a=new Ak(a.left,a.Mc());b=b.getFunctionName();b=DJc(this,b);a=new hL(RI(this.D),a,b);this.O.C(a);this.J.Xb(2624,this.R)};BJc.prototype.Ba=function(){this.J.Xb(2624,this.$)};
function DJc(a,b){var c=L5a(a.Wa.L);a=sb(a.F,function(a){return RE(a)});return"="+b+"("+a.join(c)+")"};function EJc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+T(ev({content:Zt("INSERT CHART"),style:4,xd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+T(ev({xd:"waffle-autovis-lightbox-close",content:$t(""+T(xw({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:Zt("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
T(ev({content:$t("&#10094;"),style:4,xd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:au('aria-label="'+cu("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+T(ev({content:$t("&#10095;"),style:4,xd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:au('aria-label="'+cu("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
T(a.mKb)+"</div></div></div>");return U(a)}function FJc(){return U('<div class="waffle-autovis-lightbox-chart"></div>')};function GJc(a,b,c,d,e){R.call(this,e);this.F=a;this.D=b;this.$=c;this.R=d;this.H=[];this.C=new gv("",this.Aa());this.Qa(this.C);this.O=new gv("",this.Aa());this.Qa(this.O);this.L=new gv("",this.Aa());this.Qa(this.L);this.J=new gv("",this.Aa());this.Qa(this.J)}y(GJc,R);p=GJc.prototype;p.Ha=function(){GJc.qa.Ha.call(this);this.La=S(EJc,{mKb:this.F.length})};
p.Ra=function(){GJc.qa.Ra.call(this);var a=Xx.isEnabled();HJc(this,!a);a=this.Za("waffle-autovis-lightbox-close");this.C.kb(a);a=this.Za("waffle-autovis-lightbox-insert");this.O.kb(a);var b=this.Za("waffle-autovis-lightbox-previous");this.L.kb(b);b=this.Za("waffle-autovis-lightbox-next");this.J.kb(b);IJc(this);JJc(this,this.D,!1);this.getHandler().V(document.body,nga,this.XVb).V(this.La,"keydown",this.ZVb).V($n(),"resize",this.bWb).V(this.C,"action",this.close).V(this.O,"action",this.YVb).V(this.L,
"action",this.aWb).V(this.J,"action",this.$Vb);b=new eM(this.La,this.Aa());fM(b);this.Fa(b);a.focus()};function IJc(a){var b=a.Za("waffle-autovis-lightbox-content"),c=a.Za("waffle-autovis-lightbox-content-inner");a=a.Za("waffle-autovis-lightbox-page-count");var d=Yn();a=Ir(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;Fr(c,d,e);Fr(b,d,e+a.height+35)}function HJc(a,b){ws(a.La,"waffle-autovis-lightbox-readonly",b)}
function JJc(a,b,c){c&&YA("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?KJc(a,b):a.F[b]&&nGc(a.F[b],v(a.Flb,a,b),!0)}p.Flb=function(a,b){if(!this.isDisposed()&&b){var c=this.Za("waffle-autovis-lightbox-container"),d=S(FJc);c.appendChild(d);this.H[a]=d;JW(b,d,this.$,this.R,Zo);KJc(this,a)}};function KJc(a,b){Q(a.H[a.D],!1);Q(a.H[b],!0);a.L.eb(0!=b);a.J.eb(b!=a.F.length-1);var c=a.Za("waffle-autovis-lightbox-page-number");Ao(c,b+1);a.D=b}p.XVb=function(a){!yo(this.La,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
p.ZVb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&JJc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||LJc(this);a.stopPropagation()};p.bWb=function(){var a=this.Za("waffle-autovis-lightbox-container");oo(a);this.H=[];IJc(this);JJc(this,this.D,!0)};p.YVb=function(){this.close();qGc(this.F[this.D],2256)};p.aWb=function(){0!=this.D&&JJc(this,this.D-1,!0);0==this.D&&this.J.La.focus()};p.$Vb=function(){LJc(this);this.D==this.F.length-1&&this.L.La.focus()};
function LJc(a){a.D!=a.F.length-1&&JJc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.$c=function(){GJc.qa.$c.call(this);var a=this.F[this.D];a&&a.La&&a.La.focus()};function MJc(a,b,c){J.call(this);this.C=Q2a(NG.getInstance(),a,b,c);this.D=cn()}y(MJc,J);MJc.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!xb(c,function(a){return $oa(a,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].wh()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&Xqc(this.C),this.D=NJc(),this.D.addCallback(function(){return grc(d.C,b,!0)}))};MJc.prototype.Mf=function(a){this.C.Mf(a)};
function NJc(){var a=null,b=new Wm(function(){null===a||ji(a)});a=ii(function(){b.Tb()});return b};function KY(a,b,c,d,e,f,h){rV.call(this,h);this.Qe=a;this.kd=b.C;this.$a=c;this.rf=d;this.H=f;this.sf=e;this.jb=new BJc(b,c,d,f,this.Aa());this.Qa(this.jb);this.R=new qW(!1,"#4285f4");this.Qa(this.R);this.O=null;this.Vc=this.Jc=!1;this.Nb=!0;this.Lb=Zd();this.Cb=this.Ab="";this.Yb=null;this.cb=Uq(new Tq,10).build()}y(KY,rV);p=KY.prototype;p.Ha=function(){KY.qa.Ha.call(this);this.La=S(OJc,{tM:Vo})};
p.Ra=function(){KY.qa.Ra.call(this);var a=this.Za("waffle-assistant-quicksum-panel");this.jb.kb(a);a=this.Za("waffle-assistant-spinner-container");this.R.render(a);a=this.Qe.C;this.getHandler().V(this,"close-sidebar",this.Ska).V(a,"recommender-load-started",this.Hka).V(a,"recommender-load-ended",this.Gka).V(a,"recommender-calc-started",this.hka).V(a,"recommender-calc-ended",this.gka).V(this.Za("waffle-assistant-scroll-pane"),"scroll",Grc(this.rba,10,this));a=Xx.isEnabled();this.qba(!a)};
p.resize=function(){var a=this.Za("waffle-assistant-sidepane-content");a=Ir(a).height;var b=this.Za("waffle-assistant-spinner-container");qr(b,"margin-top",a/2-16+"px");this.rba()};p.Mf=ta;function PJc(a,b){var c=QJc(a);0!=c.length&&(H(a.O),c=c.filter(function(a){return a instanceof nY}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new GJc(c,b,a.sf,a.H,a.Aa()),a.O.render(),a.Fa(a.O),HJc(a.O,a.Vc)))}
p.qba=function(a){this.Vc=a;ws(this.La,"waffle-assistant-readonly",a);var b=this.jb;b.L=a;b.C&&(b.C.H=a);ws(b.La,"waffle-assistant-quicksum-panel-readonly",a);this.O&&!this.O.isDisposed()&&HJc(this.O,a)};
p.setVisible=function(a){var b=this.isVisible();KY.qa.setVisible.call(this,a);if(a&&!b){var c=brc(this.Qe.C,a);c?(b=new nEc,D(b,1,el(c,"r")),D(b,2,el(c,"c")),D(b,3,c.wh()),c=new Rq,bd(c,4,b),b=cr(dr(this.cb),c).build()):b=this.cb;this.Cb=$d(this.Lb,nm.Vta,!1,b);rW(this.R,!0);RJc(this)}a||SJc(this,!0)};p.Hka=function(){this.isVisible()&&(SJc(this,!0),rW(this.R,!0),RJc(this))};p.Gka=function(){this.isVisible()&&(rW(this.R,!1),RJc(this))};
p.hka=function(a){this.isVisible()&&(this.H.C(2775,this.cb),SJc(this,void 0,a.C,a.F),TJc(this)||rW(this.R,!0),RJc(this),this.Nb=!1)};
p.gka=function(a){if(this.isVisible()){this.H.C(2776,this.cb);var b=a.C;0<b.length&&(this.Ab=$d(this.Lb,nm.Tta));SJc(this,!1);rW(this.R,!1);a=a.F;for(var c=ja(this.D),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=[],f=ja(b),h=f.next();!h.done;h=f.next()){h=h.value;var k=Se(h,1);d.wV(k)&&e.push(h)}0<e.length?d.fN(e,a):d.KT(!0)}if(dp)for(b=ja(b),a=b.next();!a.done;a=b.next())if(a=a.value,5==Se(a,1)){this.k3();this.Ia=M(a,12);this.va=BU(a);this.Pa=M(a,11);UJc(this);a=this.va;c=!1;for(d=this.gb.length-
1;0<=d;d--)e=this.gb[d],f=a,e.Jg()&&e.Jb()==f.Jb()&&vEc(rl(e),rl(f))&&vEc(sl(e),sl(f))&&(c=!0,this.gb.splice(d,1));this.gb.push(a);a=c;2!=this.Ia||a||VJc(this,!0)}b=QJc(this);0<b.length&&this.Jc&&(b[b.length-1].Jc=!0);this.Jc=!1;RJc(this);WJc(this);this.rba()}};function RJc(a){var b=TJc(a),c=Lr(a.Za("waffle-assistant-quicksum-panel")),d=a.R.Ub();b=b||c||d;a=a.Za("waffle-assistant-empty-list");Q(a,!b)}p.Cc=ta;p.Noa=ta;p.vd=g("Vc");p.Ska=ta;
p.jIb=function(){""!=this.Ab&&(ae(this.Lb,this.Ab),this.Ab="");""!=this.Cb&&(ae(this.Lb,this.Cb),this.Cb="");this.Yb=Ha();this.Nb||(this.H.Xb(2777,this.cb),this.Nb=!0)};function OJc(a){a=a||{};var b=U,c=$t('<div class="waffle-assistant-replaceable-title">'+XJc()+"</div>");var d=d=a||{};var e=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+T(LFc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');e=d.tM?e+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
e+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";d=U(e+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=U(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
d+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return b(""+T(tV(Xt({title:c,bl:$t(""+d),id:Zt("autovis"),sH:Zt("waffle-assistant-sidepanel"),Eaa:Zt("waffle-assistant-title"),UV:Zt("waffle-assistant-sidepane-content")},a)))+"")}
function XJc(){return U('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+T(LFc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+T("Explore")+"</div></div>")};function LY(a,b,c,d,e,f,h,k,l,m,q,t){KY.call(this,a,b,c,e,d,f,t);this.Me=q;this.Yd=h;this.Wa=b;this.ib=new R(this.Aa());this.Qa(this.ib);this.Ba=new VIc;this.Fa(this.Ba);this.D=[];this.F=null;this.Kb=new gv("",t,4);st(this.Kb,2,!1);this.Qa(this.Kb);this.ze=k;this.Dg=l;this.Hd=m;this.va=null;this.Ia=0;this.Pa=null;this.Vb=new Yu("",new gX,this.Aa());this.Qa(this.Vb);this.tc=new R(this.Aa());this.Qa(this.tc);this.yd=(new HQ).build();this.Fa(this.yd);Kw(this.yd,this.Vb,mRa);this.$=this.J=null;this.gb=
[]}y(LY,KY);var MY={VD:"waffle-assistant-scroll-pane-feature-content",oac:"waffle-assistant-empty-list",pYa:"waffle-assistant-features",pZa:"waffle-assistant-empty-list-learn-more",Kca:"waffle-assistant-expanded-panel",Sva:"waffle-assistant-replaceable-title",j0a:"waffle-assistant-scroll-pane",b1a:"waffle-assistant-sidepane-tables-range",c1a:"waffle-sidebar-tables-bar",oxa:"waffle-assistant-tables-scroll-pane",d1a:"waffle-assistant-tables-edit-range-button",qw:"waffle-assistant-title"},YJc={defaultHelpArticleId:"6280499"};
p=LY.prototype;
p.Ra=function(){var a=this;LY.qa.Ra.call(this);this.ib.kb(this.Za(MY.Kca));fY(this.C.La,"Close");dp&&(this.tc.kb(this.Za(MY.b1a)),UJc(this),this.Vb.kb(this.Za(MY.d1a)));var b=this.Wa.L.yv();Vo&&(Ewa||"en"==MG(b))&&(b=new FY(this.Yd,this.$a,this.kd,this.rf,this.H,this.Ba,this.Wa,this.Dg,this.Hd,this.Me,this.Aa()),this.Qa(b),this.D.push(b));b=new hJc(this.H,this.Ba,this.Aa());this.Qa(b);this.D.push(b);F(E(),"fedvs")&&(b=new ZIc(this.H,this.Ba,this.$a,this.Aa()),this.Qa(b),this.D.push(b));Kwa&&(b=new jJc(this.Yd,
this.kd,this.Wa,this.rf,this.H,this.Ba,this.Me,this.Aa()),this.Qa(b),this.D.push(b));b=new pY(this.kd,this.$a,this.sf,this.H,this.Ba,this.Aa());this.Qa(b);this.D.push(b);var c=this.Za(MY.pYa);A(this.D,function(b){b.render(c);a.ib.Qa(b.C,!0)});this.Kb.kb(this.Za(MY.pZa));this.getHandler().V(this.Kb,"action",this.W_b).V(this,"Td",this.k3).V(this,"Sd",this.X_b);ZJc(this)};p.X_b=function(){var a=$Jc(this);a&&(a.Ia=!0)};p.W_b=function(){O.xo.mc(YJc)};function WJc(a){A(a.D,function(a){UFc(a)})}
function SJc(a,b,c,d){A(a.D,function(a){a.KT(b,c,d)})}function TJc(a){return!!xb(a.D,function(a){return a.ela()})}p.rba=function(){var a=this,b=this.Za("waffle-assistant-scroll-pane").scrollTop+Ir(this.Za("waffle-assistant-sidepane-content")).height;A(this.D,function(c){a.F&&a.F!=c||(c instanceof pY&&a.getHandler().Oc(c,"Od",a.jIb),b=c.iN(b))})};function QJc(a){if(a.F)return a.F.C.C;var b=[];A(a.D,function(a){Kb(b,TFc(a))});return b}p.qba=function(a){LY.qa.qba.call(this,a);ZJc(this)};
p.Mf=function(a){A(this.D,function(b){b.Mf(a)})};p.Noa=function(){var a=this.Za(MY.Sva),b=this.Za(MY.qw);Hr(b,Ir(a).height)};
p.Cc=function(){var a=this,b=this.Za(MY.VD),c=this.Za(MY.Sva),d=this.ib.La;if(this.F)this.F.C.setVisible(!1),this.F.h1(!1),this.F=null,Q(b,!0),Q(d,!1),Ot(c,XJc),ls(c,"label"),this.resize();else if(this.F=xb(this.D,function(a){return a.Ub()}))Q(b,!1),Q(d,!0),this.F.C.setVisible(!0),VFc(this.F,c),ps(c,this.F.gN());this.Noa();b=new En(function(){var b=xx;b&&b.dispatchEvent("resize");a.rba()},300);this.Fa(b);b.start()};
p.setVisible=function(a){var b=this.isVisible();LY.qa.setVisible.call(this,a);a&&!b&&aKc(this,!0);a||this.Ba.clear()};p.Ska=function(){LY.qa.Ska.call(this);this.F&&this.Cc();this.k3()};p.Hka=function(){LY.qa.Hka.call(this);aKc(this,!0)};p.Gka=function(){LY.qa.Gka.call(this);aKc(this,!1)};p.hka=function(a){LY.qa.hka.call(this,a);aKc(this,!0,a.C)};p.gka=function(a){LY.qa.gka.call(this,a);aKc(this,!1)};
function bKc(a,b){if(dp){var c=$Jc(a);b?(Pbc(a.J),a.J=new sJc(a.Wa,a.$a,a.ze,a.va,a.Ia,a.Pa,a.H,a.Hd,!!c&&c.Ub()),a.Qa(a.J),a.J.render(a.getElement())):a.J&&(a.removeChild(a.J,!0),H(a.J),a.J=null);c&&RIc(c,b)}}function VJc(a,b){if(dp&&1!=a.Pa){var c=$Jc(a);b?(a.$=new rJc(a.Wa,a.$a,a.ze,a.va,a.Ia,a.Pa,!!c&&c.Ub()),a.Qa(a.$),a.$.render(a.getElement())):a.$&&(a.removeChild(a.$,!0),H(a.$),a.$=null);c&&RIc(c,b)}}function ZJc(a){A(a.D,function(b){b.hN(a.vd())})}
function $Jc(a){return(a=xb(a.D,function(a){return a instanceof FY}))?a:null}function aKc(a,b,c){A(a.D,function(a){c||PFc(a.C,b)});dp&&b&&(a.va=null,a.Ia=0,a.Pa=null,a.k3(),UJc(a))}function UJc(a){var b=a.Za(MY.c1a),c=a.Za(MY.j0a);if(a.va){var d=vl(a.va);d=RE(d);d=S(pJc,{wH:d});a=a.tc.Pb();oo(a);a.appendChild(d);Q(b,!0);ss(c,MY.oxa)}else Q(b,!1),us(c,MY.oxa)}p.k3=function(){bKc(this,!1);VJc(this,!1)};function cKc(a,b,c,d,e,f,h,k,l,m,q,t){var w=this;wV.call(this,b,h);this.va=a;this.C=b;this.$=c;this.cb=d;this.Cb=e;this.L=f;this.H=c.C;this.gb=this.$a=!1;this.F=null;this.O=l;this.jb=t;this.Nc=new kl;this.J=null;dKc(this);zNa.eb(!0);a=new qq;D(a,6,eKc());b=new oq;bd(b,58,a);this.Ia=Uq(ar(new Tq,b),10).build();this.ib=Zd();this.Wa=$d(this.ib,nm.Sta);this.Pa=-1;a=new En(function(){return fKc(w,!1)},100);this.Fa(a);a.start()}y(cKc,wV);
function dKc(a){var b=nD(a.Cb);a.Va.V(a.cb,"selectionChange",a.$_b).V(a.H,"K",a.Y_b).V(b,"ea",a.Nub).V(a.C,"Ld",a.Ojb).V(a.C,"Kd",a.Njb).V(a.C,"Jd",a.Ljb).V(a.C,"Qd",a.gzb).V(a.C,"Nd",a.glb).V(a.C,"Pd",a.Z_b).V(a.C,"Ud",a.ZBb).V(a.C,"Rd",a.DAb).V(a.C,"Md",a.okb).V(a.C,"Vd",a.b0b).V(a.va.C,"recommender-confidence-update",a.Fmb).V(a.C,"Sd",a.a0b);a.R.Sb(Xx,jq,a.Qsb).subscribe(Yx,"action",a.lkb).subscribe(ANa,"action",a.GBb).subscribe(xNa,"action",a.jPa).subscribe(Iy,"action",a.wwb).subscribe(mRa,"action",
a.UBb)}p=cKc.prototype;p.yh=function(){return BNa};p.gs=function(){return CNa};p.Hq=function(a){cKc.qa.Hq.call(this,a);ANa.eb(a);fKc(this,!1);!this.$a&&a&&(this.$a=!0);Lp(this.jb,{Rb:a});a||this.C.Cc()};p.HY=function(a){var b=this;this.C.Noa();var c=new En(function(){cKc.qa.HY.call(b,a)},300);this.Fa(c);c.start()};p.lka=function(){cKc.qa.lka.call(this);gKc(this,!1)};p.Mf=function(a){this.C.Mf(a);this.va.Mf(a)};
p.Ojb=function(a){var b=a.C.F,c=M(M(b,13),3);b=BU(b);var d=new Mf;N(d,1,c);var e=new Nf;N(e,1,d);N(e,3,!0);Cqc(e,!0);this.L.C(new uT(e,b));NY(this,a.jj(),!1,pxc(Kf(c)))};p.lkb=function(){var a=this.C.isVisible();this.yh().setVisible(!a);a||this.C.focus();gKc(this,!a)};function gKc(a,b){b?(NY(a,2253),a.Pa=Ha()):NY(a,2226,!0)}p.jPa=function(){this.C.isVisible()||this.Hq(!0)};p.wwb=function(){var a=$Jc(this.C);a&&(a.Ub()?UIc(a,"",!0):(this.jPa(),TIc(a,"",!0)))};p.GBb=function(a){PJc(this.C,a)};
p.UBb=function(){bKc(this.C,!0)};p.$_b=function(){tH(this.$)&&!this.C.J&&fKc(this,!0)};function fKc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(CJc(d.jb),RJc(d));a.va.update(!b,a.C.isVisible(),c)}
p.Fmb=function(a){""!=this.Wa&&(ae(this.ib,this.Wa),this.Wa="");var b=a.C||0;a=a.F;var c=!!a&&a.rect,d=(c=!!c&&c.wh()>=ywa&&el(c,"r")>=Awa&&el(c,"c")>=Bwa&&c.wh()<=zwa)&&.6<=b;if(d!==this.gb||a&&!a.equals(this.F))this.gb=d,this.F=a,this.Pa=Ha(),zNa.mc({r8:d,wH:a});c&&a&&a.rect&&(c=.9<=b,d=1E3>=a.rect.wh(),a=ritz_api.RitzModelApi.isFormsRegion(""+a.fd,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=!this.C.isVisible()&&!this.$a&&c&&d&&!this.$.Th(),a=qwa&&a,d=rwa&&this.$.vd(),
c&&(a||d)&&(c=new qq,D(c,1,b),D(c,2,a),D(c,3,d),D(c,5,cp),D(c,6,eKc()),b=new oq,bd(b,58,c),b=ar(Uq(new Tq,10),b).build(),this.Gya(b)))};p.Gya=function(a){var b=this;this.C.Jc=!0;var c=kG(RI(this.H));if(!r$b.C&&!c){var d=a||this.Ia;this.yh().setVisible(!0);this.O.Xb(2225,d);NY(this,2253);a=new En(function(){b.C.isVisible()||b.O.Xb(2752,d)},5E3);this.Fa(a);a.start()}};
function eKc(){switch(Cwa){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.okb=function(){this.C.Cc()};p.b0b=function(a){var b=a.C,c=BU(b.F),d=parseInt(c.Jb(),10);this.J=vl(c);this.L.C(new K$b(d));eJc(b,c);NY(this,a.jj())};p.Y_b=function(){mG(this.H)?(this.C.eb(!0),fKc(this,!1)):(this.yh().setVisible(!1),this.C.eb(!1))};p.Qsb=function(){this.C.qba(!Xx.isEnabled())};p.Nub=function(a){fKc(this,!1,GUa(a))};
p.Njb=function(a){var b=RI(this.H),c=""+b.fc(),d=[],e=Asc(b);if(e){b=new Rg;var f=Se(e,2);N(b,3,f);f=Se(e,2);N(b,2,f);e=Se(e,1);N(b,1,e);d.push(b)}b=a.C.tc;for(e=0;e<b.length;e++)f=new Rg,N(f,2,b[e]),d.push(f);this.L.C(new nW(d,c));NY(this,a.jj())};
p.Ljb=function(a){var b=a.C,c=ttc(b.C),d=BU(b.F),e=c.Eu?c.qx:null,f=c.C?c.Qw:null,h=parseInt(d.Jb(),10),k=hKc(d);this.J=vl(d);k?this.L.C(new vV(k,h,this.J,e,c.Wr,c.Us,f)):this.L.C(new uV(h,this.J,e,c.Wr,c.Us,f));d=new Oqc;D(d,1,1);c=new yU;b=M(b.F,2);D(c,2,b);bd(c,5,d);b=aGc(this.F);bd(b,46,c);b=ar(Uq(new Tq,10),b).build();this.O.C(a.jj(),b)};p.gzb=function(a){a=a.C;var b=BU(a.F),c=parseInt(b.Jb(),10),d=hKc(b);this.J=vl(b);this.L.C(new wtc(d,c));eJc(a,b)};
p.a0b=function(a){var b=RI(this.$.C),c=b.fc();b=tl(QZa(a.L,b),c);c=ZFc(b,a.F,a.R);var d=this.va,e=a.F;Xqc(d.C);d.C.$a=b;d.C.Pa=c;d.C.Wa=e;frc(d.C,!0,!0,!1);NY(this,a.jj())};function hKc(a){var b=a.Jb();a=vl(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.kc(),a.gc(),a.Mc(),a.Pc(),7,!1);return 0<b.length?b[0]:null}p.glb=function(a){ZF(RI(this.H),a.J);NY(this,a.jj())};
p.ZBb=function(a){var b=a.C;a=a.jj();if(b instanceof BY||b instanceof DY||b instanceof iJc)NY(this,a);else{var c=QJc(this.C),d=new yU,e=M(b.F,2);c=c.indexOf(b);D(d,1,c);D(d,2,e);e=new oq;bd(e,46,d);if(b instanceof nY){(d=b.H)?(b=iKc(this,b,d),b=Kwc(b,d,d.hg())):b=null;if(!b)return;bd(e,39,b)}else if(b instanceof yGc){var f=b.F;c=new aEc;if(b instanceof yGc)b=1;else throw Error("Unknown text analysis card type.");f=Re(M(f,8),20).slice(0,10);D(c,2,f||[]);D(c,1,b);bd(d,3,c)}e=ar(Uq(new Tq,10),e).build();
this.O.C(a,e)}};p.DAb=function(){this.C.Cc()};
p.Z_b=function(a){var b=a.L;if(b){var c=RI(this.H),d=a.Re();d||(d=lG(this.cb).D.C.Re());var e=16,f=16,h=a.Wa;h&&(e=h.x,f=h.y);h=lrc(this.$.J);d={oid:null,ar:fG(c,d.y),ac:gG(c,d.x),x:e,y:f,h:OG.height,w:OG.width,p:{context:tc("chartName","Chart "+(h+1))}};(c=b.hg())?(e=new Uj(c),d=new AI(qG(this.H)||0,d,!1,!1),f=ck(e,"headers"),f=null!=f&&na(f)&&Sa(f)?parseInt(f,10):-1,d.cb=f,d.$=0,f="1"==ck(e,"transpose"),d.Wa=f,d.O=f?"ROWS":"COLS",f=ck(e,"range"),f=esc(fsc(f,","),this.H),d.kH(f),(e=ck(e,"dt"))&&
V8a(d,this.Nc.jd(eh.Na(),JSON.parse(decodeURIComponent(e))))):(e=new lh,N(e,2,"0.6"),f=a.Gd().toJSON(),N(e,1,f),d=new AI(qG(this.H)||0,d,!1,!1,e));jrc(d,b);this.cb.dispatchEvent(new aK("objectRequest"));this.L.C(new eL(this.$,d));e=jKc(this,b,a.R,a.Gd());d=d.getId()||0;e.H=d;mW(this.O,a.jj(),e,10,b,c,void 0,a.F)}};function iKc(a,b,c){var d=QJc(a.C).filter(function(a){return a instanceof nY});return jKc(a,c,d.indexOf(b),b.H&&b.H.Gd())}
function jKc(a,b,c,d){var e=new lW;a=QJc(a.C).filter(function(a){return a instanceof nY}).map(function(a){return a.getChartType()});e.R=a;e.J=c;Jwc(e,b.getChartType());e.F=d?d.clone():null;return e}
function NY(a,b,c,d){if(a.F){var e=$c(pCa(a.Ia),qq,58).getTableRange();if(c||!e||e.Jb()!=a.F.fd||e.gc()!=a.F.rect.gc()||e.kc()!=a.F.rect.kc()||e.Pc()!=a.F.rect.Pc()||e.Mc()!=a.F.rect.Mc()){e=new qq;D(e,6,eKc());var f=$Fc(a.F);bd(e,7,f);c&&(c=Ha()-a.Pa,D(e,8,1E3*c),null!=a.C.Yb&&(c=Ha()-a.C.Yb,D(e,10,1E3*c)));d&&Pqc(e,d);d=F(E(),"feacos");D(e,9,d);d=new oq;bd(d,58,e);a.Ia=Uq(ar(new Tq,d),10).build()}}a.O.Xb(b,a.Ia)};function kKc(){G.call(this)}y(kKc,kp);kKc.prototype.D=function(){return MJc};kKc.prototype.H=function(){return LY};kKc.prototype.F=function(){return cKc};kKc.prototype.C=function(){return wFc};up("assistant",kKc);
